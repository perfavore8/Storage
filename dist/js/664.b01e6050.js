"use strict";(self["webpackChunkstorage"]=self["webpackChunkstorage"]||[]).push([[664],{2357:function(e,s,t){t.d(s,{Z:function(){return r}});var o=t(3396);function l(e,s,t,l,a,i){const c=(0,o.up)("NavBar"),n=(0,o.up)("HomeMenu"),d=(0,o.up)("HomeModals");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("header",null,[(0,o.Wm)(c),(0,o.Wm)(n)]),(0,o.Wm)(d,{selectedWH:t.selectedWH},null,8,["selectedWH"])],64)}var a=t(6833),i=t(1624),c=t(2145),n={components:{NavBar:a.Z,HomeMenu:i.Z,HomeModals:c.Z},props:{selectedWH:{type:Object,required:!1}},setup(){}},d=t(89);const u=(0,d.Z)(n,[["render",l],["__scopeId","data-v-3b484666"]]);var r=u},5664:function(e,s,t){t.r(s),t.d(s,{default:function(){return is}});var o=t(3396),l=t(7139);const a=e=>((0,o.dD)("data-v-078a13c1"),e=e(),(0,o.Cn)(),e),i={class:"app"},c={class:"header"},n={class:"top"},d={class:"flex flex-col items-center"},u={class:"flex flex-col items-start w-fit"},r=a((()=>(0,o._)("h1",{class:"text-3xl font-bold text-slate-700"}," Настройки интеграции с amoCRM ",-1))),p={key:0,class:"flex gap-4"},_=a((()=>(0,o._)("span",null,"Кабинет amoCRM:",-1))),h=["href"],f=a((()=>(0,o._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24"},[(0,o._)("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.5 10.5L21 3m-5 0h5v5m0 6v5a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5"})],-1))),m={class:"bottom"},v={class:"content"};function y(e,s,t,a,y,g){const b=(0,o.up)("AppHeader"),L=(0,o.up)("AppRadioBtnsGroupUnderlined");return(0,o.wg)(),(0,o.iD)("div",i,[(0,o._)("div",c,[(0,o._)("div",n,[(0,o.Wm)(b)]),(0,o._)("div",d,[(0,o._)("div",u,[r,a.inFrame?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",p,[_,(0,o._)("a",{href:`https://${a.subdomain}.amocrm.ru/`,target:"blank",class:"flex items-center gap-1 font-medium text-indigo-600 underline dark:text-indigo-500 hover:no-underline focus:outline-offset-4"},[f,(0,o.Uk)(" "+(0,l.zw)(a.subdomain),1)],8,h)]))])]),(0,o._)("div",m,[(0,o.Wm)(L,{list:a.tabs.list,selected:a.tabs.selected,onSelect:s[0]||(s[0]=e=>a.tabs.select(e))},null,8,["list","selected"])])]),(0,o._)("div",v,[((0,o.wg)(),(0,o.j4)((0,o.LL)(a.tabs.selected.component)))])])}var g=t(2357),b=t(906),L=t(9242);const S=e=>((0,o.dD)("data-v-3995436a"),e=e(),(0,o.Cn)(),e),w={class:"bgc"},C={class:"container"},k=S((()=>(0,o._)("div",{class:"header"},[(0,o._)("div",{class:"top"})],-1))),F={class:"content space-y-12"},D={class:"border-b border-gray-900/10 pb-12"},P=S((()=>(0,o._)("h6",{style:{"margin-top":"0"}},"Этапы резервирования товаров со склада",-1))),V=S((()=>(0,o._)("div",{class:"small"}," Внимание! В рамках одной воронки этап резерирования должен быть раньше этапа списания. Если этап презервирования не выбран, то резерирование будет происходить в момент добавления товара в сделку. ",-1))),A={class:"mt-4"},H=S((()=>(0,o._)("label",{for:"lock_reserved_products_edit"}," Блокировать изменения товаров в этапах резервирования ",-1))),G={class:"steps"},Z={class:"border-b border-gray-900/10 pb-12"},E=S((()=>(0,o._)("h6",null,"Этапы списания товаров со склада",-1))),$=S((()=>(0,o._)("div",{class:"small"}," Внимание! В рамках одной воронки этап списания должен быть позже этапа резерирования. ",-1))),x={class:"steps"},W={class:"border-b border-gray-900/10 pb-12"},j=S((()=>(0,o._)("h6",null,"Привязка полей сделок",-1))),O={class:"steps"},M={class:"label_input"},U=S((()=>(0,o._)("label",null," Не заполнять бюджет сделки ",-1))),R=S((()=>(0,o._)("label",{for:"not_fill_budget"},null,-1))),q={key:0},B={class:"footer"},Y=(0,o.Uk)("Назад");function I(e,s,t,a,i,c){const n=(0,o.up)("AppMultiSelect"),d=(0,o.up)("SelectorVue"),u=(0,o.up)("btns-save-close");return(0,o.wg)(),(0,o.iD)("div",w,[(0,o._)("div",C,[k,(0,o._)("div",F,[(0,o._)("div",D,[P,V,(0,o._)("div",A,[(0,o.wy)((0,o._)("input",{type:"checkbox",class:"checkbox",id:"lock_reserved_products_edit","onUpdate:modelValue":s[0]||(s[0]=e=>i.lock_reserved_products_edit=e)},null,512),[[L.e8,i.lock_reserved_products_edit]]),H]),(0,o._)("div",G,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.copyPipelinesListV2,(e=>((0,o.wg)(),(0,o.iD)("div",{class:"label_input",key:e},[(0,o._)("label",null,' Воронка "'+(0,l.zw)(e?.name)+'" ',1),(0,o.Wm)(n,{list:[{name:"Все",value:"all"},...e?.statuses],placeholder:e?.statuses.filter((e=>e.selected)).length?"Выбрано: "+e?.statuses.filter((e=>e.selected&&"all"!==e.value)).length:"Не выбрано",onSelect:s=>c.optionSelectSteps(s,e?.value,"reserve_off")},null,8,["list","placeholder","onSelect"])])))),128))])]),(0,o._)("div",Z,[E,$,(0,o._)("div",x,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.copyPipelinesListV2,(e=>((0,o.wg)(),(0,o.iD)("div",{class:"label_input",key:e},[(0,o._)("label",null,' Воронка "'+(0,l.zw)(e?.name)+'" ',1),(0,o.Wm)(d,{options_props:[{name:"Не выбрано",value:-1},...e?.statuses],onSelect:s=>c.optionSelectSteps(s,e?.value,"write_off"),selected_option:e.selectedWriteOff},null,8,["options_props","onSelect","selected_option"])])))),128))])]),(0,o._)("div",W,[j,(0,o._)("div",O,[(0,o._)("div",M,[U,(0,o.wy)((0,o._)("input",{type:"checkbox",class:"checkbox",id:"not_fill_budget","onUpdate:modelValue":s[1]||(s[1]=e=>i.not_fill_budget=e)},null,512),[[L.e8,i.not_fill_budget]]),R]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.leadsDeals,((e,s)=>((0,o.wg)(),(0,o.iD)("div",{class:"label_input",key:e},[(0,o._)("label",null,[(0,o.Uk)(' Поле "'+(0,l.zw)(e?.name)+'" ',1),s>=2?((0,o.wg)(),(0,o.iD)("span",q,"(число)")):(0,o.kq)("",!0)]),(0,o.Wm)(d,{options_props:i.leadsDealsList,onSelect:s=>c.optionSelectLeadsDeals(s,e?.code),selected_option:e?.selected},null,8,["options_props","onSelect","selected_option"])])))),128))])])]),(0,o._)("div",B,[(0,o.Wm)(u,{onClose:c.close,onSave:c.save,show_close:!1},{close:(0,o.w5)((()=>[Y])),_:1},8,["onClose","onSave"])])])])}var N=t(7720),T=t(8731),z=t(4038),K={components:{SelectorVue:N.Z,BtnsSaveClose:z.Z,AppMultiSelect:T.Z},data(){return{copyConfing:{reserve_off:[],write_off:[]},copyPipelinesListV2:[],copyLeadFieldsList:[],leadsDeals:[{name:"Товары",code:"field_products",selected:{name:"Не выбрано",value:-1}},{name:"Поле для поиска товаров",code:"field_search_products",selected:{name:"Не выбрано",value:-1}},{name:"Себестоимость",code:"field_cost_price",selected:{name:"Не выбрано",value:-1}},{name:"Прибыль",code:"field_profit",selected:{name:"Не выбрано",value:-1}},{name:"Общий бюджет",code:"field_budget",selected:{name:"Не выбрано",value:-1}},{name:"НДС сумма",code:"field_nds_sum",selected:{name:"Не выбрано",value:-1}}],leadsDealsList:[],not_fill_budget:!1,lock_reserved_products_edit:!1}},async mounted(){await Promise.all([this.$store.dispatch("get_account"),this.$store.dispatch("getPipelinesListV2"),this.$store.dispatch("getLeadFieldsList")]),this.copyConfing=JSON.parse(JSON.stringify(this.$store.state.account.account.config)),this.copyConfing.reserve_off_v2||(this.copyConfing.reserve_off_v2=[]),this.not_fill_budget=Boolean(this.copyConfing?.not_fill_budget),this.lock_reserved_products_edit=Boolean(this.copyConfing?.lock_reserved_products_edit),this.copyPipelinesListV2=this.pipelinesListV2,this.copyLeadFieldsList=this.leadFieldsList,this.fillLeadsDealsList(),this.searchSelectedPipelines(),this.searchSelectedLeadsDeals()},computed:{pipelinesListV2(){const e=[];return Object.entries(this.$store.state.account.pipelinesListV2).map((s=>{const t=[];s[1].statuses.forEach((e=>t.push({name:e.name,value:e.id,color:e.color,selected:!1}))),s[1].statuses=[...t],s[1].selectedWriteOff={name:"Не выбрано",value:-1},e.push({value:s[0],...s[1]})})),e},leadFieldsList(){const e=[];return Object.entries(this.$store.state.account.leadFieldsList).map((s=>{const t=[];Object.entries(s[1].fields).forEach((e=>t.push({name:e[1],value:e[0]}))),s[1].fields=t,s[1].fields.unshift({name:"Не выбрано",value:-1}),s[1].selected={name:"Не выбрано",value:-1},e.push({value:s[0],...s[1]})})),e}},methods:{save(){const e={not_fill_budget:this.not_fill_budget,lock_reserved_products_edit:this.lock_reserved_products_edit},s=this.$store.state.account.account.config;Object.entries(this.copyConfing).forEach((t=>{s[t[0]]!==t[1]&&(e[t[0]]=t[1])})),this.$store.dispatch("update_account",e),this.close()},close(){this.$store.commit("open_close_edit_stuff",!1)},optionSelectLeadsDeals(e,s){-1==e.value?this.copyConfing[s]="0":this.copyConfing[s]=e.value,this.leadsDeals.map((t=>{t.code==s&&(t.selected=e)}))},include(e,s,t){let o=!1;return e.forEach((e=>{e[t]==s&&(o=!0)})),o},optionSelectSteps(e,s,t){let o=!0;if("reserve_off"!==t){this.include(this.copyConfing[t],s,"field")&&(this.copyConfing[t].map((t=>{t.field==s&&(t.value=e.value)})),o=!1);const l={field:s,value:e.value};o&&this.copyConfing[t].push(l),-1==e.value&&this.copyConfing[t].forEach(((e,o)=>{e.field==s&&this.copyConfing[t].splice(o,1)}))}if(this.copyPipelinesListV2.map((o=>{o.value==s&&"write_off"==t&&(o.selectedWriteOff=e),o.value==s&&"reserve_off"==t&&("all"===e.value&&o.statuses?.forEach((s=>{"all"!==s.value&&(s.selected=!e.selected)})),e.selected=!e.selected)})),"reserve_off"===t){const e=this.copyPipelinesListV2.find((e=>e.value===s)),t=[];if(e?.statuses?.forEach((e=>e.selected&&"all"!=e.value?t.push(e.value):null)),this.copyConfing.reserve_off_v2.find((e=>e.field===s))&&(o=!1),o)this.copyConfing.reserve_off_v2.push({field:s,values:t});else{const e=this.copyConfing.reserve_off_v2.find((e=>e.field===s));e&&(e.values=t)}}},searchSelectedInArr(e,s,t){let o={name:"Не выбрано",value:-1};return s.forEach((s=>{s[t]==e&&(o=s)})),o},searchSelectedPipelines(){this.copyPipelinesListV2.map((e=>{const s=this.copyConfing.write_off.find((s=>s.field==e.value));s&&(e.selectedWriteOff=this.searchSelectedInArr(s.value,e.statuses,"value"));const t=this.copyConfing?.reserve_off_v2?.find((s=>s.field==e.value));e.statuses.map((e=>{t?.values?.includes(e.value)&&(e.selected=!0)}));const o=e.statuses.filter((e=>!e.selected));1===o.length&&"all"===o[0].value&&(e.statuses.find((e=>"all"===e.value)).selected=!0)}))},fillLeadsDealsList(){this.leadsDealsList.push({name:"Не выбрано",value:-1}),this.copyLeadFieldsList.forEach((e=>{const s=e.name;this.leadsDealsList.push({name:s,value:"optgroup"});const t=e.fields.splice(1,999);t.forEach((e=>this.leadsDealsList.push({...e,optgroup:!0})))}))},searchSelectedLeadsDeals(){this.leadsDeals.map((e=>{e.selected=this.searchSelectedInArr(this.copyConfing[e.code],this.leadsDealsList,"value")}))}}},J=t(89);const Q=(0,J.Z)(K,[["render",I],["__scopeId","data-v-3995436a"]]);var X=Q;const ee=e=>((0,o.dD)("data-v-4702e980"),e=e(),(0,o.Cn)(),e),se={class:"bgc"},te={class:"container"},oe=ee((()=>(0,o._)("div",{class:"header"},null,-1))),le={class:"content space-y-12"},ae={class:"sync border-b border-gray-900/10 pb-12"},ie={class:"list"},ce={class:"label_input"},ne=ee((()=>(0,o._)("label",null," Выберите список товаров из amoCRM для синхронизации ",-1))),de={class:"label_input"},ue=ee((()=>(0,o._)("label",null," Скрытие штатной вкладки amoCRM с товарами. В штатной вкладке с товарами так же можно прикреплять товары к сделкам, но количество товара на GoСклад учитываться не будет. ",-1))),re={class:"autosync border-b border-gray-900/10 pb-12"},pe=["id","onUpdate:modelValue"],_e=["for"],he={class:"fields"},fe=ee((()=>(0,o._)("h6",null," Настройка соответствий полей amoCRM-товаров и свойств товаров на GoСклад ",-1))),me=ee((()=>(0,o._)("p",{class:"small"}," Указание полей сравнения нужно для того, чтобы по этим полям искать дубли товаров в процессе синхронизации списков товаров amoCRM и GoСклад, которые были добавлены вручную. Если не будет указано ни одного поля, товары будут добавляться без поиска дублей ",-1))),ve=ee((()=>(0,o._)("div",{class:"row"},[(0,o._)("span",null,"Имя поля amoCRM-товара"),(0,o._)("span",null,"Имя поля товара на GoСклад"),(0,o._)("span",{class:"center"},"Сравнение")],-1))),ye=["onUpdate:modelValue"],ge={class:"checkbox_input"},be=["id","onUpdate:modelValue","disabled"],Le=["for"],Se={class:"footer"},we=(0,o.Uk)("Назад");function Ce(e,s,t,a,i,c){const n=(0,o.up)("SelectorVue"),d=(0,o.up)("btns-save-close");return(0,o.wg)(),(0,o.iD)("div",se,[(0,o._)("div",te,[oe,(0,o._)("div",le,[(0,o._)("div",ae,[(0,o._)("div",ie,[(0,o._)("div",ce,[ne,(0,o.Wm)(n,{options_props:i.copyProductLists,onSelect:s[0]||(s[0]=e=>c.optionSelectSync(e,"amo_product_list")),selected_option:i.selectedAmoProductList},null,8,["options_props","selected_option"])]),(0,o._)("div",de,[ue,(0,o.Wm)(n,{options_props:[{name:"Не выбрано",value:""},...i.copyLeadFieldGroupsList],onSelect:s[1]||(s[1]=e=>c.optionSelectSync(e,"amo_leads_group_hide")),selected_option:i.selectedAmoLeadsGroupHide},null,8,["options_props","selected_option"])])])]),-1!=i.selectedAmoProductList.value?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o._)("div",re,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.autosyncValues,(e=>((0,o.wg)(),(0,o.iD)("div",{class:"list",key:e},[!e.test?.value||c.isTest?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o._)("h6",null,(0,l.zw)(e.label),1),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.autosyncProducts,(s=>((0,o.wg)(),(0,o.iD)("div",{class:"row",key:s.id},[e.test?.id!==s.id||c.isTest?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.wy)((0,o._)("input",{type:"checkbox",class:"checkbox",id:s.id+e.value,"onUpdate:modelValue":t=>s[e.value]=t},null,8,pe),[[L.e8,s[e.value]]]),(0,o._)("label",{for:s.id+e.value},(0,l.zw)(s.label),9,_e)],64)):(0,o.kq)("",!0)])))),128))],64)):(0,o.kq)("",!0)])))),128))]),(0,o._)("div",he,[fe,me,ve,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.copySyncFields.amoFields,((e,s)=>((0,o.wg)(),(0,o.iD)("div",{class:"row",key:e.field},[(0,o.wy)((0,o._)("input",{type:"text",class:"input","onUpdate:modelValue":s=>e.name=s,disabled:""},null,8,ye),[[L.nr,e.name]]),(0,o.Wm)(n,{class:"selector",options_props:e.fields,onSelect:e=>c.select(e,s),selected_option:e.selected,disabled:e.disabled},null,8,["options_props","onSelect","selected_option","disabled"]),(0,o._)("div",ge,[(0,o.wy)((0,o._)("input",{type:"checkbox",class:"checkbox",id:e.field,"onUpdate:modelValue":s=>e.product_comparison=s,disabled:e?.product_comparison_disabled},null,8,be),[[L.e8,e.product_comparison]]),(0,o._)("label",{for:e.field},null,8,Le)])])))),128))])],64)):(0,o.kq)("",!0)]),(0,o._)("div",Se,[(0,o.Wm)(d,{onClose:c.close,onSave:c.save,show_close:!1},(0,o.Nv)({close:(0,o.w5)((()=>[we])),_:2},[void 0]),1032,["onClose","onSave"])])])])}var ke={components:{BtnsSaveClose:z.Z,SelectorVue:N.Z},data(){return{copySyncFields:{fields:[],amoFields:[]},copyConfing:{reserve_off:[],write_off:[]},copyLeadFieldGroupsList:[],copyProductLists:[],selectedAmoProductList:{name:"Не выбрано",value:-1},amoLeadsGroupHide:[],selectedAmoLeadsGroupHide:{name:"Не выбрано",value:""},fieldsProductComparison:[{name:"по названию",value:1},{name:"по названию и артикулу",value:2},{name:"по названию, артикулу и партии",value:3}],productComparisonSelectedField:{name:"по названию",value:1},autosyncProducts:[{id:1,productValue:!1,listProductValue:!1,label:"GoСклад -> amoCRM"},{id:2,productValue:!1,listProductValue:!1,label:"amoCRM -> GoСклад"}],autosyncValues:[{value:"productValue",label:"Автосинхронизация товаров"},{value:"listProductValue",label:"Автосинхронизация списка товаров в сделке",test:{value:!1,id:2}}]}},async mounted(){await Promise.all([this.$store.dispatch("get_account"),this.$store.dispatch("getProductLists"),this.$store.dispatch("getLeadFieldsList"),this.$store.dispatch("getLeadFieldGroupsList")]),this.copyLeadFieldsList=this.leadFieldsList,this.copyLeadFieldGroupsList=this.leadFieldGroupsList,this.copyConfing=this.$store.state.account.account.config,this.updateFields(),this.fillCopyProductLists(),this.fillAmoLeadsGroupHide(),this.searchSelectedAmoProductList(),this.searchSelectedAmoLeadsGroupHide(),this.searchAutosyncProducts()},computed:{account(){return this.$store.state.account.account},productLists(){return this.$store.state.account.productLists},isTest(){return 1==this.$store.state.account?.account?.id},leadFieldsList(){const e=[];return Object.entries(this.$store.state.account.leadFieldsList).map((s=>{const t=[];Object.entries(s[1].fields).forEach((e=>t.push({name:e[1],value:e[0]}))),s[1].fields=t,s[1].fields.unshift({name:"Не выбрано",value:-1}),s[1].selected={name:"Не выбрано",value:-1},e.push({value:s[0],...s[1]})})),e},leadFieldGroupsList(){const e=[];return Object.entries(this.$store.state.account.leadFieldGroupsList).forEach((s=>e.push({name:s[1],value:s[0]}))),e}},methods:{save(){const e={auto_sync_products_gs_amo:this.autosyncProducts[0].productValue?1:0,auto_sync_products_amo_gs:this.autosyncProducts[1].productValue?1:0,auto_sync_orders_gs_amo:this.autosyncProducts[0].listProductValue?1:0,auto_sync_orders_amo_gs:this.autosyncProducts[1].listProductValue?1:0};if(-1!=this.selectedAmoProductList.value){const s=[];this.copySyncFields.amoFields.forEach((e=>-1!=e.selected.value?s.push({field:e.field,value:e.selected.value,compare:e.product_comparison?1:0}):null)),s.length&&(e.sync_products_fields=s)}this.$store.dispatch("update_account",Object.assign(this.copyConfing,e)),this.close()},close(){this.$store.commit("openCloseSyncSettings",!1)},async updateFields(){await Promise.all([this.$store.dispatch("getSyncFields"),this.$store.dispatch("get_account")]),this.fillCopySyncFields(),this.searchSelectedSyncFields()},select(e,s){this.copySyncFields.amoFields[s].selected=e},searchSelectedSyncFields(){this.copySyncFields.amoFields.map((e=>{this.$store.state.account.account?.config?.sync_products_fields.forEach((s=>{if(s.field==e.field){const t=this.copySyncFields.fields[e.type].filter((e=>e.value==s.value));t.length&&(e.selected=t[0],e.product_comparison=!!s?.compare)}}))}))},fillCopySyncFields(){const e=this.$store.state.account.syncFields,s=e.fields,t=[];Object.entries(s).forEach((e=>{const s=[{name:"Не выбрано",value:-1}];Object.entries(e[1]).forEach((e=>s.push({name:e[1],value:e[0]}))),t[e[0]]=s})),this.copySyncFields.fields=t;const o=e.amo_fields,l=[];Object.entries(o).forEach((e=>l.push({name:e[1].name,type:e[1].type,fields:t[e[1].type],field:e[0],selected:{name:"Не выбрано",value:-1},disabled:0,product_comparison:!1}))),this.copySyncFields.amoFields=l},fillCopyProductLists(){const e=[{name:"Не выбрано",value:-1}];Object.entries(this.productLists).forEach((s=>e.push({name:s[1],value:s[0]}))),this.copyProductLists=e},searchSelectedAmoProductList(){this.copyProductLists.forEach((e=>{e.value==this.copyConfing.amo_product_list&&(this.selectedAmoProductList=e)}))},optionSelectSync(e,s){-1==e.value?this.copyConfing[s]="0":this.copyConfing[s]=e.value,"amo_leads_group_hide"==s&&(this.selectedAmoLeadsGroupHide=e),"amo_product_list"==s&&(this.selectedAmoProductList=e)},fillAmoLeadsGroupHide(){this.amoLeadsGroupHide.push({name:"Не выбрано",value:""}),this.copyLeadFieldsList.forEach((e=>{this.amoLeadsGroupHide.push({name:e.name,value:e.value})}))},searchSelectedAmoLeadsGroupHide(){this.leadFieldGroupsList.forEach((e=>{e.value==this.copyConfing?.amo_leads_group_hide&&(this.selectedAmoLeadsGroupHide=e)}))},searchAutosyncProducts(){this.autosyncProducts[0].productValue=!!this.account?.config?.auto_sync_products_gs_amo,this.autosyncProducts[1].productValue=!!this.account?.config?.auto_sync_products_amo_gs,this.autosyncProducts[0].listProductValue=!!this.account?.config?.auto_sync_orders_gs_amo,this.autosyncProducts[1].listProductValue=!!this.account?.config?.auto_sync_orders_amo_gs},selectProductComparisonField(e){this.productComparisonSelectedField=e}}};const Fe=(0,J.Z)(ke,[["render",Ce],["__scopeId","data-v-4702e980"]]);var De=Fe;const Pe=e=>((0,o.dD)("data-v-81d7ad68"),e=e(),(0,o.Cn)(),e),Ve={class:"bgc"},Ae={class:"container"},He=Pe((()=>(0,o._)("div",{class:"header"},null,-1))),Ge={class:"content"},Ze={class:"binding space-y-12"},Ee=Pe((()=>(0,o._)("div",{class:"header"},"Привязка полей документов",-1))),$e={class:"patterns border-b border-gray-900/10 pb-12"},xe={class:"main"},We={class:"column"},je={class:"label_select"},Oe=Pe((()=>(0,o._)("label",null,'Поле "Документы"',-1))),Me={class:"label_select"},Ue=Pe((()=>(0,o._)("label",null,"Поряд имен контактов",-1))),Re=Pe((()=>(0,o._)("div",{class:"header mb-2"},"Хуки",-1))),qe={class:"main mb-4 border-b border-gray-900/10 pb-12"},Be={class:"column"},Ye={class:"grid grid-cols-[3fr_4fr] items-center"},Ie=Pe((()=>(0,o._)("label",null,"Хук при загрузке документа в сделку",-1))),Ne={class:"grid grid-cols-[3fr_4fr] items-center"},Te=Pe((()=>(0,o._)("label",null,"Хук при генерации документа в сделке",-1))),ze={class:"footer"},Ke={class:"save"};function Je(e,s,t,l,a,i){const c=(0,o.up)("SelectorVue"),n=(0,o.up)("btns-save-close");return(0,o.wg)(),(0,o.iD)("div",Ve,[(0,o._)("div",Ae,[He,(0,o._)("div",Ge,[(0,o._)("div",Ze,[(0,o._)("div",null,[Ee,(0,o._)("div",$e,[(0,o._)("div",xe,[(0,o._)("div",We,[(0,o._)("div",je,[Oe,(0,o.Wm)(c,{options_props:l.leadFields.list,onSelect:l.leadFields.select,selected_option:l.leadFields.selected},null,8,["options_props","onSelect","selected_option"])]),(0,o._)("div",Me,[Ue,(0,o.Wm)(c,{options_props:l.contactNameType.list,onSelect:l.contactNameType.select,selected_option:l.contactNameType.selected},null,8,["options_props","onSelect","selected_option"])])])])])]),(0,o._)("div",null,[Re,(0,o._)("div",qe,[(0,o._)("div",Be,[(0,o._)("div",Ye,[Ie,(0,o.wy)((0,o._)("input",{type:"text",class:"input inputhuk my-2","onUpdate:modelValue":s[0]||(s[0]=e=>l.hooks.download=e)},null,512),[[L.nr,l.hooks.download]])]),(0,o._)("div",Ne,[Te,(0,o.wy)((0,o._)("input",{type:"text",class:"input inputhuk my-2","onUpdate:modelValue":s[1]||(s[1]=e=>l.hooks.generateDoc=e)},null,512),[[L.nr,l.hooks.generateDoc]])])])])])])]),(0,o._)("div",ze,[(0,o._)("div",Ke,[(0,o.Wm)(n,{onSave:l.save,show_close:!1},null,8,["onSave"])])])])])}var Qe=t(4870),Xe=t(9299),es={components:{SelectorVue:N.Z,BtnsSaveClose:z.Z},setup(){const e=(0,Qe.qj)({selected:{name:"Не выбрано",value:1},list:[],itialList:(0,o.Fl)((()=>{const e=[];return Object.entries(Xe.Z.state.account.leadFieldsList).map((s=>{const t=[];Object.entries(s[1].fields).forEach((e=>t.push({name:e[1],value:e[0]}))),s[1].fields=t,s[1].fields.unshift({name:"Не выбрано",value:-1}),s[1].selected={name:"Не выбрано",value:-1},e.push({value:s[0],...s[1]})})),e})),select:function(e){this.selected=e},setList:function(){this.list.push({name:"Не выбрано",value:-1}),this.itialList.forEach((e=>{const s=e.name;this.list.push({name:s,value:"optgroup"});const t=e.fields.splice(1,999);t.forEach((e=>this.list.push({...e,optgroup:!0})))})),this.list.forEach((e=>e.value==Xe.Z.state.documents.config.field_docs?this.selected=e:null))}}),s=(0,Qe.qj)({selected:{name:"Не выбрано",value:-1},list:[],select:function(e){this.selected=e},setList:function(){Xe.Z.state.documents.config.contact_name_types?.forEach(((e,s)=>this.list.push({name:e,value:s}))),this.list?.forEach((e=>e.value==Xe.Z.state.account.account?.config?.contact_name_type?this.selected=e:null))}}),t=(0,Qe.qj)({download:"",generateDoc:""}),l=(0,o.Fl)((()=>Xe.Z.state.account.account));(0,o.bv)((async()=>{await Promise.all([Xe.Z.dispatch("get_account"),Xe.Z.dispatch("get_documents_v2"),Xe.Z.dispatch("getLeadFieldsList")]),t.download=l.value.config?.hook_download,t.generateDoc=l.value.config?.hook_generate_doc,e.setList(),s.setList()}));const a=()=>{Xe.Z.dispatch("update_account",{hook_download:t.download,hook_generate_doc:t.generateDoc,field_docs:e.setList.value,contact_name_type:s.selected.value})};return{leadFields:e,contactNameType:s,save:a,hooks:t}}};const ss=(0,J.Z)(es,[["render",Je],["__scopeId","data-v-81d7ad68"]]);var ts=ss,os=t(1952),ls={name:"InstructionsView",components:{AppHeader:g.Z,AppRadioBtnsGroupUnderlined:b.Z,AmoCrmGeneralSettings:X,AmoCrmSyncSettings:De,AmoCrmDocumentsSettings:ts},setup(){const e=(0,Qe.qj)({selected:{},list:[{name:"Общие настройки",value:"general",component:"AmoCrmGeneralSettings",default:!0},{name:"Настройки синхронизации товаров",value:"sync",component:"AmoCrmSyncSettings"},{name:"Настройки документов",value:"docs",component:"AmoCrmDocumentsSettings"}],select:function(e){this.selected=e},dropToDefault:function(){const e=this.list.find((e=>e.default));e&&this.select(e)}});e.dropToDefault();const s=(0,o.Fl)((()=>Xe.Z.state.account.account?.subdomain));return{tabs:e,subdomain:s,inFrame:os.V}}};const as=(0,J.Z)(ls,[["render",y],["__scopeId","data-v-078a13c1"]]);var is=as}}]);
//# sourceMappingURL=664.b01e6050.js.map