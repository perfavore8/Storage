"use strict";(self["webpackChunkstorage"]=self["webpackChunkstorage"]||[]).push([[872],{8513:function(e,t,s){s.d(t,{Z:function(){return p}});var o=s(3396);const l={class:"btns"},i=(0,o.Uk)("Отмена"),n=(0,o.Uk)("Сохранить");function a(e,t,s,a,c,_){return(0,o.wg)(),(0,o.iD)("div",l,[s.show_close?((0,o.wg)(),(0,o.iD)("button",{key:0,class:"btn btn1",onClick:t[0]||(t[0]=e=>_.close())},[(0,o.WI)(e.$slots,"close",{},(()=>[i]),!0)])):(0,o.kq)("",!0),(0,o.WI)(e.$slots,"other_btns",{},void 0,!0),s.show_save?((0,o.wg)(),(0,o.iD)("button",{key:1,class:"btn btn2",onClick:t[1]||(t[1]=e=>_.save())},[(0,o.WI)(e.$slots,"save",{},(()=>[n]),!0)])):(0,o.kq)("",!0)])}var c={props:{show_close:{type:Boolean,required:!1,default(){return!0}},show_save:{type:Boolean,required:!1,default(){return!0}}},emits:{close:null,save:null},methods:{close(){this.$emit("close")},save(){this.$emit("save")}}},_=s(89);const d=(0,_.Z)(c,[["render",a],["__scopeId","data-v-fcfb56ae"]]);var p=d},5872:function(e,t,s){s.d(t,{Z:function(){return et}});var o=s(3396),l=s(7139),i=s(9242);const n=e=>((0,o.dD)("data-v-c82197c8"),e=e(),(0,o.Cn)(),e),a={key:0},c={key:1},_={class:"container"},d={class:"header"},p={class:"left"},u=n((()=>(0,o._)("div",{class:"title"},"Настройки документов",-1))),r={class:"autorization"},h=n((()=>(0,o._)("button",null,"Выйти",-1))),m={class:"right"},v={class:"modal_settings"},f={class:"content"},w={class:"binding"},b=n((()=>(0,o._)("div",{class:"header"},"Привязка полей документов",-1))),g={class:"main"},y={class:"column"},k={class:"label_select"},D=n((()=>(0,o._)("label",null,'Поле "Документы"',-1))),C={class:"label_select"},S=n((()=>(0,o._)("label",null,"Поряд имен контактов",-1))),$={class:"save"},j={class:"patterns"},O=n((()=>(0,o._)("div",{class:"header"},[(0,o._)("div",null,"Шаблоны документов"),(0,o._)("p",{class:"small"}," Файлы шаблонов должны быть доступны для чтения по ссылке. Google ID файла это часть ссылки на файл Пример ссылки: https://docs.google.com/spreadsheets/d/1XdXdEMtUFa8V__UK234432Dpx5-CeI/edit#gid=0, где Google ID файла: 1XdXdEMtUFa8V__UK234432Dpx5-CeI Вместо Google ID файла допускается ввод полного адреса ")],-1))),x={class:"main"},E={class:"table"},q={class:"row title"},I=n((()=>(0,o._)("td",{class:"item"},null,-1))),W={class:"add_button_container"},F=n((()=>(0,o._)("div",{class:"icon"},null,-1))),U=[F],Z={class:"footer"},z=(0,o.Uk)("Назад");function Y(e,t,s,n,F,Y){const H=(0,o.up)("document-setting-add-new"),V=(0,o.up)("document-setting-fields"),K=(0,o.up)("SelectorVue"),A=(0,o.up)("btns-save-close"),N=(0,o.up)("document-setting-doc-row");return(0,o.wg)(),(0,o.iD)(o.HY,null,[F.showAddNew?((0,o.wg)(),(0,o.j4)(H,{key:0,cur_doc:F.cur_doc,id:F.selected_doc_id,onClose:Y.close_add_new,onSave_new_doc:e.save_new_doc,onSave_cur_doc:e.save_cur_doc},{title:(0,o.w5)((()=>[null===F.selected_doc_id?((0,o.wg)(),(0,o.iD)("span",a," Добавление шаблона документов ")):(0,o.kq)("",!0),null!==F.selected_doc_id?((0,o.wg)(),(0,o.iD)("span",c," Редактирование шаблона документов ")):(0,o.kq)("",!0)])),_:1},8,["cur_doc","id","onClose","onSave_new_doc","onSave_cur_doc"])):(0,o.kq)("",!0),F.showFields?((0,o.wg)(),(0,o.j4)(V,{key:1,onClose:Y.close_fields},null,8,["onClose"])):(0,o.kq)("",!0),(0,o._)("div",{class:"app",ref:"app",onClick:t[4]||(t[4]=e=>F.show_settings?Y.close_settings():null)},[(0,o._)("div",_,[(0,o._)("div",d,[(0,o._)("div",p,[u,(0,o._)("div",r,[(0,o.Uk)(' Вы авторизированы в сервисе Google Drive как "'+(0,l.zw)(F.name)+'". ',1),h])]),(0,o._)("div",m,[(0,o._)("button",{class:"settings_btn",onClick:t[0]||(t[0]=(0,i.iM)((e=>Y.open_close_settings()),["stop"]))}),(0,o.Wm)(i.uT,{name:"modal"},{default:(0,o.w5)((()=>[(0,o.wy)((0,o._)("div",v,[(0,o._)("a",null,[(0,o._)("div",{class:(0,l.C_)(["modal_container",{disable:F.disable_fields_templates}]),onClick:t[1]||(t[1]=e=>Y.open_fields())}," Поля шаблонов ",2)]),(0,o._)("a",null,[(0,o._)("div",{class:"modal_container",onClick:t[2]||(t[2]=e=>Y.refresh_fields())}," Обновить поля шаблонов ")])],512),[[i.F8,F.show_settings]])])),_:1})])]),(0,o._)("div",f,[(0,o._)("div",w,[b,(0,o._)("div",g,[(0,o._)("div",y,[(0,o._)("div",k,[D,(0,o.Wm)(K,{options_props:F.lead_fields_options,onSelect:Y.lead_fields_select,selected_option:F.lead_fields},null,8,["options_props","onSelect","selected_option"])]),(0,o._)("div",C,[S,(0,o.Wm)(K,{options_props:F.contact_name_type_options,onSelect:Y.contact_name_type_select,selected_option:F.contact_name_type},null,8,["options_props","onSelect","selected_option"])])]),(0,o._)("div",$,[(0,o.Wm)(A,{onSave:Y.save,show_close:!1},null,8,["onSave"])])])]),(0,o._)("div",j,[O,(0,o._)("div",x,[(0,o._)("table",E,[(0,o._)("thead",null,[(0,o._)("tr",q,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(F.title,(e=>((0,o.wg)(),(0,o.iD)("td",{class:"item",key:e},(0,l.zw)(e),1)))),128)),I])]),(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(Y.documents_templates,(t=>((0,o.wg)(),(0,o.j4)(N,{key:t.id,doc:t,onOpen_edit:Y.open_edit,onDelete_cur_doc:e.delete_cur_doc},null,8,["doc","onOpen_edit","onDelete_cur_doc"])))),128))])]),(0,o._)("div",W,[(0,o._)("button",{class:"add_new_button",onClick:t[3]||(t[3]=e=>Y.open_add_new())},U)])])])]),(0,o._)("div",Z,[(0,o.Wm)(A,{onClose:Y.close,show_save:!1},{close:(0,o.w5)((()=>[z])),_:1},8,["onClose"])])])],512)],64)}var H=s(4469);const V=e=>((0,o.dD)("data-v-450788e8"),e=e(),(0,o.Cn)(),e),K={class:"app_new"},A={class:"container"},N={class:"header"},B={class:"content"},G={class:"label_input"},X=V((()=>(0,o._)("label",{class:"label"},"Название:",-1))),T={class:"label_input"},L=V((()=>(0,o._)("label",{class:"label"},"Google ID файла:",-1))),M={class:"label_input"},P=V((()=>(0,o._)("label",{class:"label"},"Этап авто-генерации:",-1))),R={class:"label_input"},J=V((()=>(0,o._)("label",{class:"label"},"Url последнего документа:",-1))),Q={class:"label_input"},ee=V((()=>(0,o._)("label",{class:"label"},"Тип шаблона:",-1))),te={class:"label_input"},se=V((()=>(0,o._)("label",{class:"label"},"Тип для скачивания:",-1))),oe={class:"footer"};function le(e,t,s,n,a,c){const _=(0,o.up)("selector-vue"),d=(0,o.up)("btns-save-close");return(0,o.wg)(),(0,o.iD)("div",K,[(0,o._)("div",A,[(0,o._)("div",N,[(0,o.WI)(e.$slots,"title",{},void 0,!0)]),(0,o._)("div",B,[(0,o._)("div",G,[X,(0,o.wy)((0,o._)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.name=e),class:(0,l.C_)(["input",{not_valid:a.try_accept&&""==a.name}])},null,2),[[i.nr,a.name]])]),(0,o._)("div",T,[L,(0,o.wy)((0,o._)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>a.file=e),class:(0,l.C_)(["input",{not_valid:a.try_accept&&""==a.file}])},null,2),[[i.nr,a.file]])]),(0,o._)("div",M,[P,(0,o.Wm)(_,{options_props:a.pipelines_options,onSelect:c.select_pipelines_option,selected_option:a.status_id},null,8,["options_props","onSelect","selected_option"])]),(0,o._)("div",R,[J,(0,o.Wm)(_,{options_props:a.lead_fields_options,onSelect:c.select_url_field,selected_option:a.url_field},null,8,["options_props","onSelect","selected_option"])]),(0,o._)("div",Q,[ee,(0,o.Wm)(_,{options_props:a.type_options,onSelect:c.option_select1,selected_option:a.type},null,8,["options_props","onSelect","selected_option"])]),(0,o._)("div",te,[se,(0,o.Wm)(_,{options_props:a.export_type_options,onSelect:c.option_select2,selected_option:a.export_type},null,8,["options_props","onSelect","selected_option"])])]),(0,o._)("div",oe,[(0,o.Wm)(d,{onClose:c.close_modal,onSave:c.save},null,8,["onClose","onSave"])])])])}var ie=s(8513),ne={components:{SelectorVue:H.Z,BtnsSaveClose:ie.Z},props:{cur_doc:{type:Object,required:!1,default(){return{}}},id:{type:Number,required:!1,default(){return null}}},emits:{close:null},data(){return{type_options:[],type:{name:"docx",value:1},export_type_options:[],export_type:{name:"Исходный",value:1},pipelines_options:[],lead_fields_options:[],try_accept:!1,name:"",file:"",status_id:{name:"Не выбрано",value:1},url_field:{name:"Не выбрано",value:1}}},mounted(){this.$store.state.documents.config.types.forEach(((e,t)=>this.type_options.push({name:e,value:t}))),this.$store.state.documents.config.export_type.forEach(((e,t)=>this.export_type_options.push({name:e,value:t}))),this.set_pipelines_options(),this.set_lead_fields_options(),(0,o.Y3)((()=>this.add_cur_doc()))},methods:{save(){if(this.try_accept=!0,""!=this.name&&""!=this.file){const e={name:this.name,file:this.file,type:this.type.name,export_type:this.export_type.name,status_id:this.status_id.value,url_field:this.url_field.value};Object.keys(this.cur_doc).length>0?this.$store.dispatch("update_template",{...e,id:this.id}):this.$store.dispatch("add_template",e),this.close_modal()}},close_modal(){this.$emit("close")},option_select1(e){Object.assign(this.type,e)},option_select2(e){Object.assign(this.export_type,e)},select_pipelines_option(e){Object.assign(this.status_id,e)},select_url_field(e){Object.assign(this.url_field,e)},add_cur_doc(){if(Object.keys(this.cur_doc).length>0){this.name=this.cur_doc.name,this.file=this.cur_doc.file;const e=(e,t,s)=>{let o={};return e.forEach((e=>{e[s]==t&&Object.assign(o,e)})),o};this.type=e(this.type_options,this.cur_doc.type,"name"),this.status_id=e(this.pipelines_options,this.cur_doc.status_id,"value"),this.url_field=e(this.lead_fields_options,this.cur_doc.url_field,"value"),this.export_type=e(this.export_type_options,this.cur_doc.export_type,"name")}},set_pipelines_options(){const e=Object.entries(this.$store.state.documents.config.pipelines);e.forEach((e=>{const t=e[0],s=e[1].name;this.pipelines_options.push({name:s,value:"optgroup"});const o=Object.entries(e[1].statuses);o.forEach((e=>this.pipelines_options.push({name:e[1],value:t+"_"+e[0],optgroup:!0})))}))},set_lead_fields_options(){const e=Object.entries(this.$store.state.documents.config.lead_fields);e.forEach((e=>{const t=e[0];this.lead_fields_options.push({name:t,value:"optgroup"});const s=Object.entries(e[1]);s.forEach((e=>this.lead_fields_options.push({name:e[1],value:e[0],optgroup:!0})))}))}}},ae=s(89);const ce=(0,ae.Z)(ne,[["render",le],["__scopeId","data-v-450788e8"]]);var _e=ce;const de=e=>((0,o.dD)("data-v-73b0f559"),e=e(),(0,o.Cn)(),e),pe={class:"app_fileds"},ue={class:"container"},re={class:"header"},he=de((()=>(0,o._)("div",{class:"left"},[(0,o._)("label",null,"Поля для шаблонов документов")],-1))),me={class:"right"},ve=de((()=>(0,o._)("div",{class:"icon"},null,-1))),fe=[ve],we={class:"content"},be={class:"top"},ge=["onClick"],ye={class:"bottom"},ke={class:"footer"};function De(e,t,s,i,n,a){const c=(0,o.up)("document-setting-fileds-list");return(0,o.wg)(),(0,o.iD)("div",pe,[(0,o._)("div",ue,[(0,o._)("div",re,[he,(0,o._)("div",me,[(0,o._)("button",{class:"btn_del",onClick:t[0]||(t[0]=e=>a.close())},fe)])]),(0,o._)("div",we,[(0,o._)("div",be,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.tpl_fields,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e,onClick:t=>a.select_catalog(e),class:(0,l.C_)(["title",{selected:e.name==n.selected_catalog}])},(0,l.zw)(e.name),11,ge)))),128))]),(0,o._)("div",ye,[(0,o.Wm)(c,{list:n.list},null,8,["list"])])]),(0,o._)("div",ke,[(0,o._)("button",{class:"btn btn1",onClick:t[1]||(t[1]=e=>a.close())},"Назад")])])])}const Ce={class:"list"},Se={class:"title"},$e={class:"fields"},je=["onClick"];function Oe(e,t,s,n,a,c){return(0,o.wg)(),(0,o.iD)("div",Ce,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(s.list,(e=>((0,o.wg)(),(0,o.iD)("div",{class:"row",key:e},[(0,o._)("div",Se,(0,l.zw)(e.title),1),(0,o._)("div",$e,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.fields,(e=>((0,o.wg)(),(0,o.iD)("button",{class:"field",key:e,onClick:t=>c.copy(e.value)},(0,l.zw)(e.name),9,je)))),128)),(0,o.wy)((0,o._)("span",null,null,512),[[i.F8,!1]])])])))),128))])}var xe={props:{list:{type:Array,required:!0,default(){return[]}}},methods:{copy(e){navigator.clipboard.writeText(e).then((()=>{alert("Текст скопирован удачно")})).catch((()=>{alert("Текст не скопирован автоматически :с\nПопробуйте вручную")}))}}};const Ee=(0,ae.Z)(xe,[["render",Oe],["__scopeId","data-v-0b4b3b86"]]);var qe=Ee,Ie={emits:{close:null},components:{DocumentSettingFiledsList:qe},data(){return{selected_catalog:"",list:[],tpl_fields:[]}},mounted(){const e=Object.entries(this.$store.state.documents.config.tpl_fields);e.forEach((e=>{const t={name:e[0],fields:[]};Object.entries(e[1]).forEach((e=>{const s={title:e[0],fields:[]};Object.entries(e[1]).forEach((e=>{const t={name:e[1],value:e[0]};s.fields.push(t)})),t.fields.push(s)})),this.tpl_fields.push(t)})),this.tpl_fields[0].name&&this.select_catalog(this.tpl_fields[0])},methods:{select_catalog(e){this.selected_catalog=e.name,this.list=e.fields},close(){this.$emit("close")}}};const We=(0,ae.Z)(Ie,[["render",De],["__scopeId","data-v-73b0f559"]]);var Fe=We;const Ue=e=>((0,o.dD)("data-v-2acdcfa1"),e=e(),(0,o.Cn)(),e),Ze={class:"row"},ze={class:"item"},Ye={class:"item"},He=Ue((()=>(0,o._)("td",{class:"item"},[(0,o._)("a",{href:"https://docs.google.com/spreadsheets/d/13U76ujSjV_iaY0L2WBVHVw7q07TSEqstuL0kSeX-Sh8/edit"},"Шаблон")],-1))),Ve={class:"item"},Ke={class:"item"},Ae={class:"item"},Ne={class:"btns"},Be=Ue((()=>(0,o._)("div",{class:"icon"},null,-1))),Ge=[Be],Xe=Ue((()=>(0,o._)("div",{class:"icon"},null,-1))),Te=[Xe];function Le(e,t,s,i,n,a){return(0,o.wg)(),(0,o.iD)("tr",Ze,[(0,o._)("td",ze,(0,l.zw)(s.doc.name),1),(0,o._)("td",Ye,(0,l.zw)(s.doc.file),1),He,(0,o._)("td",Ve,(0,l.zw)(s.doc.type),1),(0,o._)("td",Ke,(0,l.zw)(s.doc.export_type),1),(0,o._)("td",Ae,[(0,o._)("div",Ne,[(0,o._)("button",{class:"btn_edit",onClick:t[0]||(t[0]=e=>a.open_edit(s.doc))},Ge),(0,o._)("button",{class:"btn_del",onClick:t[1]||(t[1]=e=>a.delete_cur_doc(s.doc.id))},Te)])])])}var Me={props:{doc:{type:Object,required:!0}},emits:{open_edit:null,delete_cur_doc:null},methods:{open_edit(e){this.$emit("open_edit",e)},delete_cur_doc(e){this.$store.dispatch("delete_template",{id:e})}}};const Pe=(0,ae.Z)(Me,[["render",Le],["__scopeId","data-v-2acdcfa1"]]);var Re=Pe,Je={components:{SelectorVue:H.Z,DocumentSettingAddNew:_e,DocumentSettingFields:Fe,DocumentSettingDocRow:Re,BtnsSaveClose:ie.Z},data(){return{name:"Дмитрий Ивлев",title:["Название","Google ID файла","Шаблон","Тип шаблона","Тип для скачивания"],lead_fields_options:[],lead_fields:{name:"Не выбрано",value:1},contact_name_type_options:[],contact_name_type:{name:"Не выбрано",value:1},showAddNew:!1,showFields:!1,show_settings:!1,cur_doc:{},selected_doc_id:null,copy_documents:[],disable_fields_templates:!1}},computed:{documents_templates(){return this.$store.state.documents.templates}},async mounted(){await this.$store.dispatch("get_documents"),this.set_lead_fields_options(),this.set_contact_name_type_options()},methods:{save(){this.$store.dispatch("update_account",{field_docs:this.lead_fields.value,contact_name_type:this.contact_name_type.value})},set_lead_fields_options(){const e=Object.entries(this.$store.state.documents.config.lead_fields);e.forEach((e=>{const t=e[0];this.lead_fields_options.push({name:t,value:"optgroup"});const s=Object.entries(e[1]);s.forEach((e=>this.lead_fields_options.push({name:e[1],value:e[0],optgroup:!0})))})),this.lead_fields_options.forEach((e=>e.value==this.$store.state.documents.config.field_docs?this.lead_fields=e:null))},set_contact_name_type_options(){this.$store.state.documents.config.contact_name_types.forEach(((e,t)=>this.contact_name_type_options.push({name:e,value:t}))),this.contact_name_type_options.forEach((e=>e.value==this.$store.state.account.account.config.contact_name_type?this.contact_name_type=e:null))},async refresh_fields(){this.disable_fields_templates=!0,await this.$store.dispatch("refresh_fields"),this.disable_fields_templates=!1},close(){this.$emit("close",!1)},lead_fields_select(e){Object.assign(this.lead_fields,e)},contact_name_type_select(e){Object.assign(this.contact_name_type,e)},open_edit(e){this.cur_doc={...e},this.selected_doc_id=e.id,this.open_add_new()},open_modal(){this.$refs.app.style.pointerEvents="none",this.$refs.app.style.filter="blur(5px)"},close_modal(){this.$refs.app.style.pointerEvents="all",this.$refs.app.style.filter="none"},open_add_new(){this.showAddNew=!0,this.open_modal()},close_add_new(){this.showAddNew=!1,this.cur_doc={},this.close_modal()},open_close_settings(){this.show_settings=!this.show_settings},close_settings(){this.show_settings=!1},open_fields(){this.disable_fields_templates||(this.showFields=!0,this.open_modal())},close_fields(){this.showFields=!1,this.close_modal()}}};const Qe=(0,ae.Z)(Je,[["render",Y],["__scopeId","data-v-c82197c8"]]);var et=Qe},4469:function(e,t,s){s.d(t,{Z:function(){return h}});var o=s(3396),l=s(7139),i=s(9242);const n={class:"v-select"},a={class:"options",key:"a1"},c=["onClick"];function _(e,t,s,_,d,p){return(0,o.wg)(),(0,o.iD)("div",n,[(0,o._)("div",{class:(0,l.C_)(["title",{title_checked:_.show_options,disabled:s.disabled}]),onClick:t[0]||(t[0]=e=>_.open_close_options()),onFocusout:t[1]||(t[1]=(...e)=>_.handleFocusOut&&_.handleFocusOut(...e)),tabindex:"0"},[(0,o._)("p",null,(0,l.zw)(s.selected_option.name),1),s.disabled?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",{key:0,class:(0,l.C_)(["arrow",{rotate_arrow:_.show_options}])},null,2))],34),(0,o.Wm)(i.uT,{name:"list"},{default:(0,o.w5)((()=>[_.show_options?((0,o.wg)(),(0,o.iD)("div",a,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(_.options,(e=>((0,o.wg)(),(0,o.iD)("p",{key:e.value,class:(0,l.C_)({optgroup:"optgroup"===e.value}),onClick:t=>_.select_option(e)},[e.optgroup?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[(0,o.Uk)("     "+(0,l.zw)(e.name),1)],64)):((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[(0,o.Uk)((0,l.zw)(e.name),1)],64))],10,c)))),128))])):(0,o.kq)("",!0)])),_:1})])}var d=s(4870),p={props:{options_props:{type:Array,default(){return[]},required:!0},selected_option:{type:Object,required:!0,default(){return{}}},disabled:{type:Boolean,required:!1,default:!1},idx:{type:Number,required:!1}},emits:{select:null},setup(e,{emit:t}){const s=(0,d.iH)([]);(0,o.bv)((()=>{(0,o.Y3)((()=>{l()}))}));const l=()=>{s.value=[],e.options_props?.forEach((e=>s.value.push(e)))};(0,o.YP)((()=>e.options_props),(()=>{l()}),{deep:!0});const i=(0,d.iH)(!1),n=()=>{i.value=!1},a=()=>{e.disabled||(i.value=!i.value)},c=()=>{n()},_=s=>{"optgroup"!=s.value&&(t("select",s,e.idx),n())};return{open_close_options:a,handleFocusOut:c,show_options:i,options:s,select_option:_}}},u=s(89);const r=(0,u.Z)(p,[["render",_],["__scopeId","data-v-a0cfd498"]]);var h=r}}]);
//# sourceMappingURL=872.f360305c.js.map