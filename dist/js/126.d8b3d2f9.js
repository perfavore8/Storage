(self["webpackChunkstorage"]=self["webpackChunkstorage"]||[]).push([[126],{3026:function(e,t,o){"use strict";o.d(t,{Z:function(){return u}});var i=o(3396),n=o(7139);const s={class:"span"};function l(e,t,o,l,a,r){const c=(0,i.up)("selector-vue");return o.show?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,n.C_)(["bottom",{blur:o.blur}])},[o.previous?((0,i.wg)(),(0,i.iD)("button",{key:0,onClick:t[0]||(t[0]=e=>r.changePage(o.page-1)),class:"btn previous"},(0,n.zw)("<"))):(0,i.kq)("",!0),(0,i._)("div",s,(0,n.zw)(o.page),1),o.next?((0,i.wg)(),(0,i.iD)("button",{key:1,onClick:t[1]||(t[1]=e=>r.changePage(o.page+1)),class:"btn next"},(0,n.zw)(">"))):(0,i.kq)("",!0),(0,i.Wm)(c,{class:"count",options_props:a.count_values,selected_option:{name:o.count,value:-1},onSelect:r.change_count},null,8,["options_props","selected_option","onSelect"])],2)):(0,i.kq)("",!0)}var a=o(4469),r={components:{SelectorVue:a.Z},props:{previous:{type:Boolean,required:!0},next:{type:Boolean,required:!0},page:{type:Number,required:!0},count:{type:Number,required:!0},blur:{type:Boolean,required:!1,default:!1},show:{type:Boolean,required:!0}},emits:{changePage:null,changeCount:null},data(){return{count_values:[]}},async mounted(){await this.$store.dispatch("get_account"),this.$store.state.account.user.config.per_pages&&(this.count_values=[...this.$store.state.account.user.config.per_pages].map(((e,t)=>({name:e,value:t}))))},computed:{},methods:{changePage(e){this.$emit("changePage",e)},change_count(e){console.log(e),this.$emit("changeCount",e.name)}}},c=o(89);const d=(0,c.Z)(r,[["render",l],["__scopeId","data-v-f9e85040"]]);var u=d},2126:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return rd}});var i=o(3396),n=o(7139),s=o(9242);const l=e=>((0,i.dD)("data-v-1c1f7308"),e=e(),(0,i.Cn)(),e),a={key:0,class:"table_setings"},r={key:0,class:"edit_staff"},c={key:0,class:"product_category"},d={key:0,class:"thirdPpartyIntegrations"},u={key:0,class:"product_properties"},p={key:0,class:"new_position"},_={key:0,class:"cancel_position"},h={key:0,class:"document_setting"},m={class:"header_left"},f={class:"btns"},g=["onClick"],v={class:"whs"},y=["value","id","checked","onChange"],w=["for"],b={class:"header_right"},C={class:"ref"},k={key:0,class:"modal_settings modal_sync"},D=l((()=>(0,i._)("a",null,[(0,i._)("div",{class:"modal_container"}," Синхронизировать товары amoCRM -> Склад ")],-1))),x=l((()=>(0,i._)("a",null,[(0,i._)("div",{class:"modal_container"}," Синхронизировать товары Склад -> amoCRM ")],-1))),S=[D,x],E={class:"modal_settings"},T=l((()=>(0,i._)("a",null,[(0,i._)("div",{class:"modal_container"}," Синхронизация склада с товарами amoCRM ")],-1))),q=l((()=>(0,i._)("a",null,[(0,i._)("div",{class:"modal_container"},"Настройки аккаунта")],-1))),I={class:"filters_left"},O={class:"date"},P=l((()=>(0,i._)("input",{type:"date",id:"start",name:"trip-start",value:"2018-07-22",min:"2018-01-01",max:"2032-12-31","aria-required":"true","aria-invalid":"false"},null,-1))),$={class:"bot"},V={key:0,class:"buttons"},W=["disabled"],M={class:"filters_right"},F={key:0,class:"btns"},H=l((()=>(0,i._)("button",{class:"btn btn_blue"},"Применить",-1))),A={class:"filter_group"},U=l((()=>(0,i._)("label",{for:"filter"},"Фильтр",-1))),L=["disabled"],j={class:"grid"};function N(e,t,o,l,D,x){const N=(0,i.up)("table-settings"),Y=(0,i.up)("edit-stuff"),B=(0,i.up)("product-category"),R=(0,i.up)("ThirdPpartyIntegrations"),Z=(0,i.up)("product-properties"),z=(0,i.up)("new-position"),X=(0,i.up)("cancel-position"),K=(0,i.up)("document-setting"),G=(0,i.up)("main-grid"),J=(0,i.up)("card-grid");return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["app",{disabled:x.disabled_for_modals}]),onClick:t[15]||(t[15]=t=>{e.show_settings&&x.close_settings(),e.show_sync&&x.close_sync()})},[e.show_table_settings?((0,i.wg)(),(0,i.iD)("div",a,[(0,i.Wm)(N,{selectedWH:D.selectedWH},null,8,["selectedWH"])])):(0,i.kq)("",!0),(0,i.Wm)(s.uT,{name:"modal_window"},{default:(0,i.w5)((()=>[e.show_edit_stuff?((0,i.wg)(),(0,i.iD)("div",r,[(0,i.Wm)(Y)])):(0,i.kq)("",!0)])),_:1}),(0,i.Wm)(s.uT,{name:"modal_window"},{default:(0,i.w5)((()=>[e.show_product_category?((0,i.wg)(),(0,i.iD)("div",c,[(0,i.Wm)(B)])):(0,i.kq)("",!0)])),_:1}),(0,i.Wm)(s.uT,{name:"modal_window"},{default:(0,i.w5)((()=>[e.showThirdPpartyIntegrations?((0,i.wg)(),(0,i.iD)("div",d,[(0,i.Wm)(R)])):(0,i.kq)("",!0)])),_:1}),(0,i.Wm)(s.uT,{name:"modal_window"},{default:(0,i.w5)((()=>[e.show_product_properties?((0,i.wg)(),(0,i.iD)("div",u,[(0,i.Wm)(Z)])):(0,i.kq)("",!0)])),_:1}),(0,i.Wm)(s.uT,{name:"modal_window"},{default:(0,i.w5)((()=>[e.show_new_position?((0,i.wg)(),(0,i.iD)("div",p,[(0,i.Wm)(z,{currentItems:D.currentItems,onClose:x.dropCurrentItems},null,8,["currentItems","onClose"])])):(0,i.kq)("",!0)])),_:1}),(0,i.Wm)(s.uT,{name:"modal_window"},{default:(0,i.w5)((()=>[e.show_cancel_position?((0,i.wg)(),(0,i.iD)("div",_,[(0,i.Wm)(X)])):(0,i.kq)("",!0)])),_:1}),(0,i.Wm)(s.uT,{name:"modal_window"},{default:(0,i.w5)((()=>[e.show_document_setting?((0,i.wg)(),(0,i.iD)("div",h,[(0,i.Wm)(K,{onClose:x.open_close_show_document_setting},null,8,["onClose"])])):(0,i.kq)("",!0)])),_:1}),(0,i._)("div",{class:(0,n.C_)(["header",{blur:x.disabled_for_modals}])},[(0,i._)("div",m,[(0,i._)("div",f,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.catalog,(t=>((0,i.wg)(),(0,i.iD)("button",{class:(0,n.C_)(["btns_btn",{selected_catalog:e.$route.path==="/"+t.value}]),onClick:e=>x.route(t.value),key:t},(0,n.zw)(t.name),11,g)))),128))]),(0,i._)("div",v,[(0,i._)("div",{class:(0,n.C_)(["radio_btns",{whs_full:D.whsFull}])},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(D.whs,(e=>((0,i.wg)(),(0,i.iD)("div",{class:"radio_btn",key:e},[(0,i._)("input",{type:"radio",value:e.value,id:e.name,name:"selected_storage",checked:D.selectedWH.value==e.value,onChange:t=>x.selectWH(e)},null,40,y),(0,i._)("label",{for:e.name},(0,n.zw)(e.name),9,w)])))),128))],2),(0,i._)("div",{class:(0,n.C_)(["arrow",{rotate_arrow:D.whsFull}]),onClick:t[0]||(t[0]=e=>D.whsFull=!D.whsFull)},null,2)])]),(0,i._)("div",b,[(0,i._)("div",C,[(0,i._)("div",{class:(0,n.C_)(["ref_2_logo",{ref_2_logo_fill:e.show_sync}]),onClick:t[1]||(t[1]=(0,s.iM)((e=>x.open_close_sync()),["stop"]))},null,2),(0,i.Wm)(s.uT,{name:"modal"},{default:(0,i.w5)((()=>[e.show_sync?((0,i.wg)(),(0,i.iD)("div",k,S)):(0,i.kq)("",!0)])),_:1})]),(0,i._)("button",{class:"settings_btn",onClick:t[7]||(t[7]=(0,s.iM)((e=>x.open_close_settings()),["stop"]))},[(0,i.Wm)(s.uT,{name:"modal"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("div",E,[(0,i._)("a",null,[(0,i._)("div",{class:"modal_container",onClick:t[2]||(t[2]=e=>x.open_edit_stuff())}," Общие настройки ")]),(0,i._)("a",null,[(0,i._)("div",{class:"modal_container",onClick:t[3]||(t[3]=e=>x.open_product_category())}," Категории товаров ")]),(0,i._)("a",null,[(0,i._)("div",{class:"modal_container",onClick:t[4]||(t[4]=e=>x.open_product_properties())}," Свойства товаров ")]),T,(0,i._)("a",null,[(0,i._)("div",{class:"modal_container",onClick:t[5]||(t[5]=e=>x.open_close_show_document_setting(!0))}," Документы ")]),(0,i._)("a",null,[(0,i._)("div",{class:"modal_container",onClick:t[6]||(t[6]=e=>x.openThirdPpartyIntegrations())}," Интеграции ")]),q],512),[[s.F8,e.show_settings]])])),_:1})])])],2),(0,i._)("div",{class:(0,n.C_)(["wrapper",{blur:e.show_table_settings||e.show_edit_stuff||e.show_new_position||e.show_cancel_position||e.show_product_category||e.show_product_properties||e.show_document_setting||e.showThirdPpartyIntegrations}])},[(0,i._)("div",{class:(0,n.C_)(["filters",{blur:e.show_edit_modal}])},[(0,i._)("div",I,[(0,i._)("div",O,[P,(0,i._)("div",$,[(0,i._)("p",null,"Найдено: "+(0,n.zw)(x.totalCountProducts),1),(0,i.kq)("",!0)])]),(0,i.Wm)(s.uT,{name:"btns"},{default:(0,i.w5)((()=>[e.show_buttons&&!x.oneC?((0,i.wg)(),(0,i.iD)("div",V,[(0,i._)("button",{class:"button button_1 smallBtn",onClick:t[9]||(t[9]=e=>x.archive_data())}," Архивировать "),x.isServicePage?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[(0,i._)("button",{class:"button button_2 smallBtn",onClick:t[10]||(t[10]=e=>x.addCurrentProducts()),disabled:x.oneC}," Добавить ",8,W),(0,i._)("button",{class:"button button_3 smallBtn",onClick:t[11]||(t[11]=e=>x.open_close_cancel_position(!0))}," Списать ")],64))])):(0,i.kq)("",!0)])),_:1})]),(0,i._)("div",M,[D.filter_value?((0,i.wg)(),(0,i.iD)("div",F,[H,(0,i._)("button",{class:"btn btn_grey",onClick:t[12]||(t[12]=e=>x.clearFilters())}," Очистить ")])):(0,i.kq)("",!0),(0,i._)("div",A,[(0,i.wy)((0,i._)("input",{type:"checkbox","onUpdate:modelValue":t[13]||(t[13]=e=>D.filter_value=e),name:"filter",id:"filter",class:"checkbox"},null,512),[[s.e8,D.filter_value]]),U]),x.oneC?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("button",{key:1,class:"button button_4 smallBtn",onClick:t[14]||(t[14]=e=>x.open_close_new_position(!0)),disabled:x.isServicePage}," Новая позиция ",8,L))])],2),(0,i._)("div",j,[D.grid?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(G,{key:0,ref:"main",selectedWH:D.selectedWH},null,8,["selectedWH"])),D.grid?((0,i.wg)(),(0,i.j4)(J,{key:1,ref:"card",selectedWH:D.selectedWH},null,8,["selectedWH"])):(0,i.kq)("",!0)])],2)],2)}const Y={class:"wrapper"},B={key:0,class:"text"},R={key:0,class:"item"},Z=["id","onUpdate:modelValue","onChange"],z=["for"],X={key:0},K={key:1},G={class:"item"},J=["onClick"];function Q(e,t,o,l,a,r){const c=(0,i.up)("edit-item"),d=(0,i.up)("main-grid-bar"),u=(0,i.up)("main-grid-filters"),p=(0,i.up)("grid-bottom");return(0,i.wg)(),(0,i.iD)("div",Y,[((0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[e.show_edit_modal?((0,i.wg)(),(0,i.j4)(c,{key:0,edit_data:a.edit_data},null,8,["edit_data"])):(0,i.kq)("",!0)])),0==r.products.length?((0,i.wg)(),(0,i.iD)("label",B," Ничего не найдено ")):((0,i.wg)(),(0,i.iD)("table",{key:1,class:(0,n.C_)(["table",{blur:e.show_edit_modal}])},[(0,i._)("thead",null,[(0,i.Wm)(d,{fields:r.all_fields,onSort:r.sort,tableConfig:r.tableConfig,sortedFields:r.sortedFields,ref:"mainGridBar",class:"main-grid-bar"},null,8,["fields","onSort","tableConfig","sortedFields"]),(0,i.Wm)(u,{ref:"filters",fields:r.all_fields,tableConfig:r.tableConfig,sortedFields:r.sortedFields},null,8,["fields","tableConfig","sortedFields"])]),(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(r.products,((e,t)=>((0,i.wg)(),(0,i.iD)("tr",{class:"row",key:e.id},[r.oneC?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("td",R,[void 0!=a.selectedProducts[t]?(0,i.wy)(((0,i.wg)(),(0,i.iD)("input",{key:0,type:"checkbox",class:"checkbox",id:e.id,"onUpdate:modelValue":e=>a.selectedProducts[t].value=e,onChange:o=>a.selectedProducts[t].item=e},null,40,Z)),[[s.e8,a.selectedProducts[t].value]]):(0,i.kq)("",!0),(0,i._)("label",{for:e.id},null,8,z)])),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(r.sortedFields,(t=>((0,i.wg)(),(0,i.iD)("td",{key:t,class:"item"},[t[0].split(".").length<2?((0,i.wg)(),(0,i.iD)("span",X,(0,n.zw)("category"==t[0]?r.categories[e.fields[t[0]]]:e.fields[t[0]]),1)):((0,i.wg)(),(0,i.iD)("span",K,[e.fields[t[0].split(".")[0]]?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[(0,i.Uk)((0,n.zw)("cost"==t[0].split(".")[1]?e.fields[t[0].split(".")[0]][t[0].split(".")[1]]+" "+e.fields[t[0].split(".")[0]].currency:e.fields[t[0].split(".")[0]][t[0].split(".")[1]]),1)],64)):(0,i.kq)("",!0)]))])))),128)),(0,i._)("td",G,[(0,i._)("div",{class:"edit_icon",onClick:t=>r.open_edit_modal(e)},null,8,J)])])))),128))])],2)),(0,i.Wm)(p,{previous:null!=r.meta.links.prev,next:null!=r.meta.links.next,page:r.meta.meta.current_page,blur:e.show_edit_modal,show:0!=r.products.length,count:r.count,onChangePage:r.changePage,onChangeCount:r.changeCount},null,8,["previous","next","page","blur","show","count","onChangePage","onChangeCount"])])}const ee={class:"app_edit_modal"},te={class:"header"},oe={class:"header_left"},ie={class:"header_right"},ne=(0,i.Uk)("Отмена"),se=(0,i._)("div",{class:"hr"},null,-1),le={class:"main"},ae={class:"row"},re=(0,i._)("label",null,"Тип:",-1),ce=(0,i._)("div",{class:"hr"},null,-1),de={class:"footer"},ue=(0,i.Uk)("Отмена");function pe(e,t,o,l,a,r){const c=(0,i.up)("BtnsSaveClose"),d=(0,i.up)("SelectorVue"),u=(0,i.up)("edit-item-fields");return(0,i.wg)(),(0,i.iD)("div",{class:"background_edit_modal",onClick:t[2]||(t[2]=(0,s.iM)((e=>r.close()),["self"]))},[(0,i._)("div",ee,[(0,i._)("div",te,[(0,i._)("div",oe," Редактирование "+(0,n.zw)(o.edit_data.fields["name"]),1),(0,i._)("div",ie,[(0,i.Wm)(c,{onClose:r.close,onSave:r.save},{close:(0,i.w5)((()=>[ne])),other_btns:(0,i.w5)((()=>[(0,i._)("button",{class:"btn btn3",onClick:t[0]||(t[0]=e=>r.archive())},"Архивировать")])),_:1},8,["onClose","onSave"])])]),se,(0,i._)("div",le,[(0,i._)("div",ae,[re,(0,i.Wm)(d,{options_props:a.options_1,onSelect:r.option_select_1,selected_option:a.selected_option_1},null,8,["options_props","onSelect","selected_option"])]),(0,i.Wm)(u,{new_edit_data:a.new_edit_data,onChange_value:r.change_value},null,8,["new_edit_data","onChange_value"])]),ce,(0,i._)("div",de,[(0,i.Wm)(c,{onClose:r.close,onSave:r.save},{close:(0,i.w5)((()=>[ue])),other_btns:(0,i.w5)((()=>[(0,i._)("button",{class:"btn btn3",onClick:t[1]||(t[1]=e=>r.archive())},"Архивировать")])),_:1},8,["onClose","onSave"])])])])}var _e=o(4469),he=o(8513);function me(e,t,o,n,s,l){const a=(0,i.up)("edit-integer"),r=(0,i.up)("edit-float"),c=(0,i.up)("edit-string"),d=(0,i.up)("edit-text"),u=(0,i.up)("edit-selector"),p=(0,i.up)("edit-multi-selector"),_=(0,i.up)("edit-date"),h=(0,i.up)("edit-date-time"),m=(0,i.up)("edit-flag");return(0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.copy_fields_with_parents,(e=>((0,i.wg)(),(0,i.iD)("div",{class:"row",key:e.id},[1==e.type?((0,i.wg)(),(0,i.j4)(a,{key:0,item:e.name,selected_option:o.new_edit_data.fields[e.code],idx:e.code,disabled:!!e.is_editable,onChange_value:l.change_value},null,8,["item","selected_option","idx","disabled","onChange_value"])):(0,i.kq)("",!0),2==e.type?((0,i.wg)(),(0,i.j4)(r,{key:1,item:e.name,selected_option:o.new_edit_data.fields[e.code],idx:e.code,disabled:!!e.is_editable,onChange_value:l.change_value},null,8,["item","selected_option","idx","disabled","onChange_value"])):(0,i.kq)("",!0),3==e.type?((0,i.wg)(),(0,i.j4)(c,{key:2,item:e.name,selected_option:o.new_edit_data.fields[e.code],idx:e.code,disabled:!!e.is_editable,onChange_value:l.change_value},null,8,["item","selected_option","idx","disabled","onChange_value"])):(0,i.kq)("",!0),4==e.type?((0,i.wg)(),(0,i.j4)(d,{key:3,item:e.name,selected_option:o.new_edit_data.fields[e.code],idx:e.code,disabled:!!e.is_editable,onChange_value:l.change_value},null,8,["item","selected_option","idx","disabled","onChange_value"])):(0,i.kq)("",!0),5==e.type?((0,i.wg)(),(0,i.j4)(u,{key:4,item:e,selected_option:o.new_edit_data.fields[e.code],idx:e.code,disabled:!!e.is_editable,onChange_value:l.change_value},null,8,["item","selected_option","idx","disabled","onChange_value"])):(0,i.kq)("",!0),6==e.type?((0,i.wg)(),(0,i.j4)(p,{key:5,item:e,selected_options:o.new_edit_data.fields[e.code],idx:e.code,disabled:!!e.is_editable,onChange_value:l.change_value},null,8,["item","selected_options","idx","disabled","onChange_value"])):(0,i.kq)("",!0),7==e.type?((0,i.wg)(),(0,i.j4)(_,{key:6,item:e.name,selected_option:o.new_edit_data.fields[e.code],idx:e.code,onChange_value:l.change_value},null,8,["item","selected_option","idx","onChange_value"])):(0,i.kq)("",!0),8==e.type?((0,i.wg)(),(0,i.j4)(h,{key:7,item:e.name,selected_option:o.new_edit_data.fields[e.code],idx:e.code,onChange_value:l.change_value},null,8,["item","selected_option","idx","onChange_value"])):(0,i.kq)("",!0),9==e.type?((0,i.wg)(),(0,i.j4)(m,{key:8,item:e.name,selected_option:o.new_edit_data.fields[e.code],idx:e.code,onChange_value:l.change_value},null,8,["item","selected_option","idx","onChange_value"])):(0,i.kq)("",!0)])))),128)}const fe={class:"row"},ge=["disabled"];function ve(e,t,o,l,a,r){return(0,i.wg)(),(0,i.iD)("div",fe,[(0,i._)("label",null,(0,n.zw)(o.item)+":",1),(0,i.wy)((0,i._)("input",{type:"number",class:"input",step:"1",onchange:"this.value = parseInt(this.value);","onUpdate:modelValue":t[0]||(t[0]=e=>a.copy_selected_option=e),disabled:o.disabled},null,8,ge),[[s.nr,a.copy_selected_option]])])}var ye={props:{item:{type:String,required:!0,default(){return""}},selected_option:{type:String,required:!0,default(){return""}},idx:{type:Number,required:!0},disabled:{type:Boolean,required:!1,default(){return!1}}},data(){return{copy_selected_option:""}},mounted(){this.change_value()},watch:{selected_option(){this.change_value()},copy_selected_option(){this.copy_selected_option=`${this.copy_selected_option}`,this.option_select(this.copy_selected_option)}},methods:{change_value(){(0,i.Y3)((()=>{this.copy_selected_option=this.selected_option}))},option_select(e){this.$emit("change_value",e,this.idx)}}},we=o(89);const be=(0,we.Z)(ye,[["render",ve],["__scopeId","data-v-a731a2b4"]]);var Ce=be;const ke={class:"row"},De=["disabled"];function xe(e,t,o,l,a,r){return(0,i.wg)(),(0,i.iD)("div",ke,[(0,i._)("label",null,(0,n.zw)(o.item)+":",1),(0,i.wy)((0,i._)("input",{type:"number",class:"input","onUpdate:modelValue":t[0]||(t[0]=e=>a.copy_selected_option=e),disabled:o.disabled},null,8,De),[[s.nr,a.copy_selected_option]])])}var Se={props:{item:{type:String,required:!0,default(){return""}},selected_option:{type:String,required:!0,default(){return""}},idx:{type:Number,required:!0},disabled:{type:Boolean,required:!1,default(){return!1}}},data(){return{copy_selected_option:""}},mounted(){this.change_value()},watch:{selected_option(){this.change_value()},copy_selected_option(){this.copy_selected_option=`${this.copy_selected_option}`,this.option_select(this.copy_selected_option)}},methods:{change_value(){(0,i.Y3)((()=>{this.copy_selected_option=this.selected_option}))},option_select(e){this.$emit("change_value",e,this.idx)}}};const Ee=(0,we.Z)(Se,[["render",xe],["__scopeId","data-v-1077f776"]]);var Te=Ee;const qe={class:"row"},Ie=["disabled"];function Oe(e,t,o,l,a,r){return(0,i.wg)(),(0,i.iD)("div",qe,[(0,i._)("label",null,(0,n.zw)(o.item)+":",1),(0,i.wy)((0,i._)("input",{type:"text",class:"input","onUpdate:modelValue":t[0]||(t[0]=e=>a.copy_selected_option=e),disabled:o.disabled},null,8,Ie),[[s.nr,a.copy_selected_option]])])}var Pe={props:{item:{type:String,required:!0,default(){return""}},selected_option:{type:String,required:!0,default(){return""}},idx:{type:Number,required:!0},disabled:{type:Boolean,required:!1,default(){return!1}}},data(){return{copy_selected_option:""}},mounted(){this.change_value()},watch:{selected_option(){this.change_value()},copy_selected_option(){this.option_select(this.copy_selected_option)}},methods:{change_value(){(0,i.Y3)((()=>{this.copy_selected_option=this.selected_option}))},option_select(e){this.$emit("change_value",e,this.idx)}}};const $e=(0,we.Z)(Pe,[["render",Oe],["__scopeId","data-v-09d70360"]]);var Ve=$e;const We={class:"row"},Me=["disabled"];function Fe(e,t,o,l,a,r){return(0,i.wg)(),(0,i.iD)("div",We,[(0,i._)("label",null,(0,n.zw)(o.item)+":",1),(0,i.wy)((0,i._)("textarea",{class:"text_area",cols:"30",rows:"10","onUpdate:modelValue":t[0]||(t[0]=e=>a.copy_selected_option=e),disabled:o.disabled},null,8,Me),[[s.nr,a.copy_selected_option]])])}var He={props:{item:{type:String,required:!0,default(){return""}},selected_option:{type:String,required:!0,default(){return""}},idx:{type:Number,required:!0},disabled:{type:Boolean,required:!1,default(){return!1}}},data(){return{copy_selected_option:""}},mounted(){this.change_value()},watch:{selected_option(){this.change_value()},copy_selected_option(){this.option_select(this.copy_selected_option)}},methods:{change_value(){(0,i.Y3)((()=>{this.copy_selected_option=this.selected_option}))},option_select(e){this.$emit("change_value",e,this.idx)}}};const Ae=(0,we.Z)(He,[["render",Fe],["__scopeId","data-v-47beb2fc"]]);var Ue=Ae;const Le={class:"row"};function je(e,t,o,s,l,a){const r=(0,i.up)("SelectorVue");return(0,i.wg)(),(0,i.iD)("div",Le,[(0,i._)("label",null,(0,n.zw)(o.item.name)+":",1),(0,i.Wm)(r,{options_props:a.preparing_field_data(o.item.data),onSelect:a.option_select,selected_option:{name:l.copy_selected_option,value:-1},disabled:o.disabled},null,8,["options_props","onSelect","selected_option","disabled"])])}var Ne={components:{SelectorVue:_e.Z},props:{item:{type:Object,required:!0,default(){return{}}},selected_option:{type:String,required:!0,default(){return""}},idx:{type:Number,required:!0},disabled:{type:Boolean,required:!1,default(){return!1}}},data(){return{copy_selected_option:"Не выбрано"}},mounted(){this.change_value()},watch:{selected_option(){this.change_value()}},methods:{change_value(){(0,i.Y3)((()=>{this.item.data?.forEach((e=>{console.log(this.selected_option),e==this.selected_option&&(this.copy_selected_option=e)}))}))},preparing_field_data(e){const t=[];return e&&e.forEach(((e,o)=>t.push({name:e,value:o}))),t},option_select(e){this.$emit("change_value",e.name,this.idx)}}};const Ye=(0,we.Z)(Ne,[["render",je],["__scopeId","data-v-021967da"]]);var Be=Ye;const Re={class:"row"};function Ze(e,t,o,s,l,a){const r=(0,i.up)("multi-selector");return(0,i.wg)(),(0,i.iD)("div",Re,[(0,i._)("label",null,(0,n.zw)(o.item.name)+":",1),(0,i.Wm)(r,{options_props:a.preparing_field_data(o.item.data),onSelect:a.option_select,selected_options:l.copy_selected_options,disabled:o.disabled},null,8,["options_props","onSelect","selected_options","disabled"])])}o(6699);const ze={class:"multi_selector"},Xe=["onClick"];function Ke(e,t,o,s,l,a){return(0,i.wg)(),(0,i.iD)("div",ze,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.options_props,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["item",{selected:o.selected_options[t],disabled:o.disabled}]),key:e.value,onClick:e=>s.select(t)},(0,n.zw)(e.name),11,Xe)))),128))])}var Ge=o(4870),Je={name:"MultiSelector",props:{options_props:{type:Array,required:!0,default(){return[]}},selected_options:{type:Array,required:!0,default(){return[!0]}},disabled:{type:Boolean,required:!1,default(){return!1}}},emits:{select:null},setup(e,{emit:t}){const o=(0,Ge.iH)([]);(0,i.bv)((()=>o.value=[...e.selected_options])),(0,i.YP)((()=>e.selected_options),(()=>{o.value=[...e.selected_options]}),{deep:!0});const n=i=>{e.disabled||(0==i&&(o.value=[]),1==o.value[0]&&(o.value[0]=!1),o.value[i]=!o.value[i],o.value.includes(!0)||(o.value[0]=!0),t("select",o.value))};return{options_value:o,select:n}}};const Qe=(0,we.Z)(Je,[["render",Ke],["__scopeId","data-v-dfbb2804"]]);var et=Qe,tt={components:{MultiSelector:et},props:{item:{type:Object,required:!0,default(){return{}}},selected_options:{type:String,required:!0,default(){return""}},idx:{type:Number,required:!0},disabled:{type:Boolean,required:!1,default(){return!1}}},data(){return{copy_selected_options:[]}},mounted(){this.change_value()},watch:{selected_options(){this.change_value()}},methods:{change_value(){let e=[];(0,i.Y3)((()=>{const t=this.selected_options.split(", ");this.item.data?.forEach((o=>{t.includes(o)?e.push(!0):e.push(!1)})),this.copy_selected_options=[],this.copy_selected_options=[...e]}))},preparing_field_data(e){const t=[];return e&&e.forEach(((e,o)=>t.push({name:e,value:o}))),t},option_select(e){let t=[];e.forEach(((e,o)=>{e&&t.push(this.item.data[o])})),t=t.join(", "),this.$emit("change_value",t,this.idx)}}};const ot=(0,we.Z)(tt,[["render",Ze],["__scopeId","data-v-b08c3624"]]);var it=ot;const nt={class:"row"},st=["disabled"];function lt(e,t,o,l,a,r){return(0,i.wg)(),(0,i.iD)("div",nt,[(0,i._)("label",null,(0,n.zw)(o.item)+":",1),(0,i.wy)((0,i._)("input",{type:"date",class:"date_input","aria-required":"true","aria-invalid":"false","onUpdate:modelValue":t[0]||(t[0]=e=>a.copy_selected_option=e),disabled:o.disabled},null,8,st),[[s.nr,a.copy_selected_option]])])}var at={props:{item:{type:String,required:!0,default(){return""}},selected_option:{type:String,required:!0,default(){return""}},idx:{type:Number,required:!0},disabled:{type:Boolean,required:!1,default(){return!1}}},data(){return{copy_selected_option:""}},mounted(){this.change_value()},watch:{selected_option(){this.change_value()},copy_selected_option(){this.option_select(this.copy_selected_option)}},methods:{change_value(){(0,i.Y3)((()=>{this.copy_selected_option=this.selected_option}))},option_select(e){this.$emit("change_value",e,this.idx)}}};const rt=(0,we.Z)(at,[["render",lt],["__scopeId","data-v-b18aeab2"]]);var ct=rt;const dt={class:"row"},ut=["disabled"];function pt(e,t,o,l,a,r){return(0,i.wg)(),(0,i.iD)("div",dt,[(0,i._)("label",null,(0,n.zw)(o.item)+":",1),(0,i.wy)((0,i._)("input",{type:"datetime-local",class:"date_input","aria-required":"true","aria-invalid":"false","onUpdate:modelValue":t[0]||(t[0]=e=>a.copy_selected_option=e),disabled:o.disabled},null,8,ut),[[s.nr,a.copy_selected_option]])])}var _t={props:{item:{type:String,required:!0,default(){return""}},selected_option:{type:String,required:!0,default(){return""}},idx:{type:Number,required:!0},disabled:{type:Boolean,required:!1,default(){return!1}}},data(){return{copy_selected_option:""}},mounted(){this.change_value()},watch:{selected_option(){this.change_value()},copy_selected_option(){this.option_select(this.copy_selected_option)}},methods:{change_value(){(0,i.Y3)((()=>{this.copy_selected_option=this.selected_option}))},option_select(e){this.$emit("change_value",e,this.idx)}}};const ht=(0,we.Z)(_t,[["render",pt],["__scopeId","data-v-1580d023"]]);var mt=ht;const ft={class:"row"},gt=["id","disabled"],vt=["for"];function yt(e,t,o,l,a,r){return(0,i.wg)(),(0,i.iD)("div",ft,[(0,i.wy)((0,i._)("input",{type:"checkbox",class:"checkbox",id:o.idx+"za","onUpdate:modelValue":t[0]||(t[0]=e=>a.copy_selected_option=e),disabled:o.disabled},null,8,gt),[[s.e8,a.copy_selected_option]]),(0,i._)("label",{for:o.idx+"za"},(0,n.zw)(o.item),9,vt)])}var wt={props:{item:{type:String,required:!0,default(){return""}},selected_option:{type:String,required:!0,default(){return""}},idx:{type:Number,required:!0},disabled:{type:Boolean,required:!1,default(){return!1}}},data(){return{copy_selected_option:Boolean}},mounted(){this.change_value()},watch:{selected_option(){this.change_value()},copy_selected_option(){let e="";e=this.copy_selected_option?"Да":"Нет",this.option_select(e)}},methods:{change_value(){(0,i.Y3)((()=>{"Да"==this.selected_option?this.copy_selected_option=!0:this.copy_selected_option=!1}))},option_select(e){this.$emit("change_value",e,this.idx)}}};const bt=(0,we.Z)(wt,[["render",yt],["__scopeId","data-v-651638ea"]]);var Ct=bt,kt=o(7306),Dt={components:{EditInteger:Ce,EditFloat:Te,EditString:Ve,EditText:Ue,EditSelector:Be,EditMultiSelector:it,EditDate:ct,EditDateTime:mt,EditFlag:Ct},props:{new_edit_data:{type:Object,required:!0}},emits:{change_value:null},data(){return{copy_fields_with_parents:[]}},async mounted(){(0,kt.nextTick)((async()=>{const e=this.new_edit_data.fields.category;await this.$store.dispatch("get_fields_with_parents",e).then((()=>this.copy_fields_with_parents=[...this.$store.state.fields.fields_with_parents]))}))},methods:{change_value(e,t){this.$emit("change_value",e,t)}}};const xt=(0,we.Z)(Dt,[["render",me],["__scopeId","data-v-96704c36"]]);var St=xt,Et={components:{SelectorVue:_e.Z,BtnsSaveClose:he.Z,EditItemFields:St},props:{edit_data:{type:Object,required:!0}},inject:["isServicePage"],computed:{},data(){return{options_1:[{name:"Товар",value:1},{name:"Услуга",value:2}],selected_option_1:{name:"Товар",value:1},new_edit_data:{}}},mounted(){this.new_edit_data=JSON.parse(JSON.stringify(this.edit_data)),this.isServicePage.value?this.selected_option_1={...this.options_1[1]}:this.selected_option_1={...this.options_1[0]}},methods:{change_value(e,t){this.new_edit_data.fields[t]=e},option_select_1(e){this.selected_option_1={...e}},archive(){this.new_edit_data.is_archive=1,this.save()},close(){this.$store.commit("close_edit_modal")},save(){this.$store.dispatch("update_product",{products:[this.new_edit_data]}),this.close()}}};const Tt=(0,we.Z)(Et,[["render",pe]]);var qt=Tt,It=o(3026);const Ot=e=>((0,i.dD)("data-v-8b06bd06"),e=e(),(0,i.Cn)(),e),Pt={class:"filters"},$t={class:"item",key:"b1"},Vt=Ot((()=>(0,i._)("th",{class:"item",key:"2b"},null,-1)));function Wt(e,t,o,n,l,a){const r=(0,i.up)("filter-number"),c=(0,i.up)("filter-text"),d=(0,i.up)("filter-list"),u=(0,i.up)("filter-date"),p=(0,i.up)("filter-flag");return(0,i.wg)(),(0,i.j4)(s.uT,{name:"mdl1"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("tr",Pt,[(0,i.Wm)(s.W3,{name:"mdl"},{default:(0,i.w5)((()=>[a.oneC?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("th",$t)),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(l.filtersValue,((t,o)=>(0,i.wy)(((0,i.wg)(),(0,i.iD)("th",{key:o,class:"item"},[t.table_config.filtered?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[1==t.type||2==t.type?((0,i.wg)(),(0,i.j4)(r,{key:0,item:t,idx:o,onChange_filter_value:a.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,i.kq)("",!0),3==t.type||4==t.type?((0,i.wg)(),(0,i.j4)(c,{key:1,item:t,idx:o,onChange_filter_value:a.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,i.kq)("",!0),5==t.type||6==t.type?((0,i.wg)(),(0,i.j4)(d,{key:2,item:t,idx:o,selector_options:t.data,onChange_filter_value:a.change_filter_value},null,8,["item","idx","selector_options","onChange_filter_value"])):(0,i.kq)("",!0),7==t.type||8==t.type?((0,i.wg)(),(0,i.j4)(u,{key:3,item:t,idx:o,onChange_filter_value:a.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,i.kq)("",!0),9==t.type?((0,i.wg)(),(0,i.j4)(p,{key:4,item:t,idx:o,onChange_filter_value:a.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,i.kq)("",!0)],64)):(0,i.kq)("",!0)],512)),[[s.F8,e.show_filter]]))),128)),Vt])),_:1})],512),[[s.F8,e.show_filter]])])),_:1})}const Mt={class:"filter"};function Ft(e,t,o,l,a,r){return(0,i.wg)(),(0,i.iD)("div",Mt,[(0,i._)("button",{onClick:t[0]||(t[0]=e=>5==a.option?a.option=1:a.option+=1)},[(0,i._)("div",{class:(0,n.C_)(["icon",{equal:1==a.option,more:2==a.option,more_or_equal:3==a.option,less:4==a.option,less_or_equal:5==a.option}])},null,2)]),(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.filterValue=e),type:"number"},null,512),[[s.nr,a.filterValue]])])}var Ht={props:{item:{type:Object,required:!0},idx:{type:Number,required:!0}},data(){return{option:1,filterValue:null}},computed:{option_value(){return{option:this.option,value:this.filterValue}}},watch:{option_value:{handler(){this.emit_value()},deep:!0},item(){this.change_value()}},mounted(){this.change_value()},methods:{change_value(){(0,i.Y3)((()=>{this.option=this.item.option,this.filterValue=this.item.value}))},emit_value(){this.$emit("change_filter_value",this.option_value,this.idx)}}};const At=(0,we.Z)(Ht,[["render",Ft],["__scopeId","data-v-48927a48"]]);var Ut=At;const Lt={class:"filter"};function jt(e,t,o,l,a,r){return(0,i.wg)(),(0,i.iD)("div",Lt,[(0,i._)("button",{onClick:t[0]||(t[0]=e=>2==a.option?a.option=1:a.option+=1)},[(0,i._)("div",{class:(0,n.C_)(["icon",{equal:1==a.option,tilde:2==a.option}])},null,2)]),(0,i.wy)((0,i._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>a.filterValue=e),type:"text"},null,512),[[s.nr,a.filterValue]])])}var Nt={props:{item:{type:Object,required:!0},idx:{type:Number,required:!0}},data(){return{option:1,filterValue:null}},computed:{option_value(){return{option:this.option,value:this.filterValue}}},watch:{option_value:{handler(){this.emit_value()},deep:!0},item(){this.change_value()}},mounted(){this.change_value()},methods:{change_value(){(0,i.Y3)((()=>{this.option=this.item.option,this.filterValue=this.item.value}))},emit_value(){this.$emit("change_filter_value",this.option_value,this.idx)}}};const Yt=(0,we.Z)(Nt,[["render",jt],["__scopeId","data-v-530d9d52"]]);var Bt=Yt;const Rt={class:"filter"};function Zt(e,t,o,s,l,a){const r=(0,i.up)("multi-selector");return(0,i.wg)(),(0,i.iD)("div",Rt,[(0,i._)("button",{onClick:t[0]||(t[0]=e=>a.open_selector())},[(0,i._)("div",{class:(0,n.C_)(["arrow",{rotate_arrow:l.show_selector}])},null,2)]),l.show_selector?((0,i.wg)(),(0,i.j4)(r,{key:0,class:"selector",id:"selector123",options_props:o.selector_options,onSelect:a.option_select_multi,selected_options:l.filterValue,onFocusout:a.handleFocusOut,tabindex:"1"},null,8,["options_props","onSelect","selected_options","onFocusout"])):(0,i.kq)("",!0)])}var zt={components:{MultiSelector:et},props:{item:{type:Object,required:!0},idx:{type:Number,required:!0},selector_options:{type:Array,required:!0}},data(){return{filterValue:[],show_selector:!1}},computed:{option_value(){return{value:this.filterValue}}},watch:{option_value:{handler(){this.emit_value()},deep:!0},item(){this.change_value()}},mounted(){this.change_value()},methods:{change_value(){(0,i.Y3)((()=>{this.filterValue=[],this.item.value.forEach(((e,t)=>{this.filterValue[t]=e}))}))},emit_value(){this.$emit("change_filter_value",this.option_value,this.idx)},option_select_multi(e){this.filterValue=e},open_selector(){this.show_selector=!0,(0,i.Y3)((()=>{this.show_selector&&document.getElementById("selector123").focus()}))},handleFocusOut(){setTimeout((()=>{(0,i.Y3)((()=>{this.show_selector=!1}))}),150)}}};const Xt=(0,we.Z)(zt,[["render",Zt],["__scopeId","data-v-42d70668"]]);var Kt=Xt;const Gt={key:0,class:"filter"},Jt={key:1,class:"filter"};function Qt(e,t,o,n,l,a){return(0,i.wg)(),(0,i.iD)(i.HY,null,[7==o.item.type?((0,i.wg)(),(0,i.iD)("div",Gt,[(0,i.wy)((0,i._)("input",{type:"date","onUpdate:modelValue":t[0]||(t[0]=e=>l.date_start=e)},null,512),[[s.nr,l.date_start]]),(0,i.wy)((0,i._)("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=e=>l.date_end=e)},null,512),[[s.nr,l.date_end]])])):(0,i.kq)("",!0),8==o.item.type?((0,i.wg)(),(0,i.iD)("div",Jt,[(0,i.wy)((0,i._)("input",{type:"datetime-local","onUpdate:modelValue":t[2]||(t[2]=e=>l.date_start=e)},null,512),[[s.nr,l.date_start]]),(0,i.wy)((0,i._)("input",{type:"datetime-local","onUpdate:modelValue":t[3]||(t[3]=e=>l.date_end=e)},null,512),[[s.nr,l.date_end]])])):(0,i.kq)("",!0)],64)}var eo={props:{item:{type:Object,required:!0},idx:{type:Number,required:!0}},data(){return{date_start:"",date_end:""}},computed:{date(){return{value:this.date_start+"~"+this.date_end}}},watch:{date:{handler(){this.emit_value()},deep:!0},item(){this.change_value()}},mounted(){this.change_value()},emits:{change_filter_value:null},methods:{change_value(){(0,i.Y3)((()=>{if(null!=this.item.value){const e=this.item.value.split("~");this.date_start=e[0],this.date_end=e[1]}}))},emit_value(){this.$emit("change_filter_value",this.date,this.idx)}}};const to=(0,we.Z)(eo,[["render",Qt],["__scopeId","data-v-5332f71a"]]);var oo=to;const io={class:"filter"};function no(e,t,o,n,s,l){const a=(0,i.up)("selector-vue");return(0,i.wg)(),(0,i.iD)("div",io,[(0,i.Wm)(a,{options_props:s.options,onSelect:l.option_select,selected_option:s.options[s.filterValue-1]},null,8,["options_props","onSelect","selected_option"])])}var so={components:{SelectorVue:_e.Z},props:{item:{type:Object,required:!0},idx:{type:Number,required:!0}},data(){return{options:[{name:"Все",value:1},{name:"Да",value:2},{name:"Нет",value:3}],filterValue:1}},computed:{option_value(){return{value:this.filterValue}}},watch:{option_value:{handler(){this.emit_value()},deep:!0},item(){this.change_value()}},mounted(){this.change_value()},methods:{change_value(){(0,i.Y3)((()=>{this.filterValue=this.item.value}))},emit_value(){this.$emit("change_filter_value",this.option_value,this.idx)},option_select(e){this.filterValue=e.value}}};const lo=(0,we.Z)(so,[["render",no],["__scopeId","data-v-12148177"]]);var ao=lo,ro=o(65),co={props:{fields:{type:Array,required:!0,default(){return[]}},sortedFields:{type:Array,required:!0,default(){return[]}},tableConfig:{type:Object}},components:{FilterNumber:Ut,FilterText:Bt,FilterList:Kt,FilterDate:oo,FilterFlag:ao},data(){return{filtersValue:[]}},computed:{...(0,ro.Se)(["show_filter"]),oneC(){return this.$store.state.account.account?.config?.g_enabled}},mounted(){this.feelFilters()},methods:{clearFilters(){this.feelFilters()},change_filter_value(e,t){Object.assign(this.filtersValue[t],e)},feelFilters(){this.filtersValue=[];const e=[];this.sortedFields.forEach((t=>{const o=this.fields.filter((e=>e.code==t[0].split(".")[0]))[0];e.push(o)})),e.forEach((e=>{const t=e=>{const t=[];return null!=e&&e.forEach(((e,o)=>t.push({name:e,value:o}))),e};let o=null;5!=e.type&&6!=e.type||(o=[]),9==e.type&&(o=1);const i={type:e.type,option:1,selector_options:t(e.data),value:o,table_config:e.table_config};this.filtersValue.push(i)}))}}};const uo=(0,we.Z)(co,[["render",Wt],["__scopeId","data-v-8b06bd06"]]);var po=uo;const _o={class:"bar_row"},ho={key:0,class:"bar_item item",style:{"min-width":"17px"}},mo={class:"bar_item_group"},fo=["onClick"],go={class:"bar_item item",style:{"min-width":"20px"}};function vo(e,t,o,s,l,a){return(0,i.wg)(),(0,i.iD)("tr",_o,[a.oneC?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("th",ho)),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.sortedFields,((e,t)=>((0,i.wg)(),(0,i.iD)("th",{class:"bar_item item",style:(0,n.j5)({minWidth:0!=a.width[t]?a.width[t]+"px":(a.collsCount>=8?100:a.collsCount>3?90:80)/a.collsCount+"%"}),key:e},[(0,i._)("div",mo,[(0,i._)("label",null,(0,n.zw)(e[1].name),1),o.fields.filter((t=>t.code==e[0].split(".")[0]))[0].table_config.sortable?((0,i.wg)(),(0,i.iD)("button",{key:0,class:(0,n.C_)(["bar_item_icon",{bar_item_icon_up:l.order.code===e[0].split(".")[0]&&"desc"===l.order.prev_order,bar_item_icon_down:l.order.code===e[0].split(".")[0]&&"asc"===l.order.prev_order}]),onClick:t=>a.sort(e[0].split(".")[0])},null,10,fo)):(0,i.kq)("",!0)])],4)))),128)),(0,i._)("th",go,[(0,i._)("div",null,[(0,i._)("button",{class:"settings_btn",onClick:t[0]||(t[0]=e=>a.openTableSettings())})])])])}var yo={props:{fields:{type:Array,required:!0,default(){return[]}},sortedFields:{type:Array,required:!0,default(){return[]}},tableConfig:{type:Object}},data(){return{order:{code:"",prev_order:""}}},computed:{...(0,ro.Se)(["fields"]),collsCount(){return this.tableConfig.length},oneC(){return this.$store.state.account.account?.config?.g_enabled},width(){let e=[];return this.fields.forEach((t=>{let o=0;9==t.type&&(o=70),7!=t.type&&8!=t.type||(o=130),e.push(o)})),e}},methods:{isShow(e){let t=!1;return Object.entries(this.tableConfig).forEach((o=>{o[0].split(".")[0]==e&&o[1]?.visible&&(t=!0)})),t},dropOreder(){this.order={code:"",prev_order:""}},sort(e){const t=["asc","desc"];let o="";o=this.order.code===e&&this.order.prev_order==t[0]?t[1]:t[0],this.order={code:e,prev_order:o},this.$emit("sort",e,o)},openTableSettings(){this.$store.commit("open_table_settings")}}};const wo=(0,we.Z)(yo,[["render",vo],["__scopeId","data-v-da2e131c"]]);var bo=wo,Co={name:"Main_grid",components:{EditItem:qt,GridBottom:It.Z,MainGridFilters:po,MainGridBar:bo},props:{selectedWH:{type:Object}},inject:["isServicePage"],data(){return{updateKey:0,selectedProducts:[],edit_data:{}}},async mounted(){this.$store.dispatch("get_fields_properties"),await this.$store.dispatch("getTableConfig","whs"!=this.selectedWH.value?this.selectedWH.value:""),await this.$store.dispatch("get_all_fields"),await this.get_products(),this.setSelectedProducts()},computed:{sortedFields(){const e=Object.entries(this.tableConfig);return e.sort(((e,t)=>e[1].sort>t[1].sort?1:e[1].sort==t[1].sort?0:e[1].sort<t[1].sort?-1:void 0)).filter((e=>e[1].visible))},tableConfig(){return this.$store.state.account.tableConfig},categories(){const e={};return this.$store.state.categories.fields_properties.forEach((t=>e[t.id]=t.name)),e},oneC(){return this.$store.state.account.account?.config?.g_enabled},count(){return this.$store.state.account.user.config?.per_page},meta(){return this.$store.state.products.meta},all_fields(){return this.$store.state.fields.all_fields},filters(){return this.$refs.filters},show_buttons(){const e=this.selectedProducts.filter((e=>e.value)).length>0;return e},products(){return this.$store.state.products.products},refBar(){return this.$refs.mainGridBar},...(0,ro.Se)(["show_edit_modal"])},watch:{products:{handler:function(){this.updateKey+=1,this.selectedProducts=[],(0,kt.nextTick)((()=>{this.filters?.clearFilters(),this.filters?.feelFilters()}))},deep:!0},show_buttons(){this.$store.commit("open_close_buttons",this.show_buttons)},async selectedWH(){await this.$store.dispatch("getTableConfig","whs"!=this.selectedWH.value?this.selectedWH.value:""),this.refBar.dropOreder(),this.get_products()}},methods:{clearFilters(){this.filters?.clearFilters()},isShow(e){const t={value:!1,second:""};return Object.entries(this.tableConfig).forEach((o=>{o[0].split(".")[0]==e&&o[1]?.visible&&(t.value=!0,t.second=o[0].split(".")[1])})),t},async changeCount(e){await this.$store.dispatch("update_user",{per_page:e}),this.changePage(this.meta.current_page)},changePage(e){const t={page:e};this.get_products(t)},setSelectedProducts(){this.selectedProducts=[];for(let e=0;e<this.count;e++)this.selectedProducts.push({value:!1,item:{}})},async get_products(e){this.isServicePage.value&&(e={...e,is_service:1}),"whs"==this.selectedWH.value||this.isServicePage.value||(e={...e,warehouse:this.selectedWH.value}),await this.$store.dispatch("get_products",e),this.setSelectedProducts()},drop_page(){this.changePage(1)},open_edit_modal(e){this.edit_data={...e},this.$store.commit("open_edit_modal",e.fields.category)},sort(e,t){const o={page:this.meta.current_page,sort:{by:e,order:t}};this.get_products(o)}}};const ko=(0,we.Z)(Co,[["render",Q],["__scopeId","data-v-2af6a28c"]]);var Do=ko;const xo={class:"header"},So={key:0,class:"grid"},Eo={key:0,class:"text"},To={class:"name"},qo={class:"value"},Io={class:"card_footer"},Oo=["id","onUpdate:modelValue"],Po=["for"],$o=["onClick"];function Vo(e,t,o,l,a,r){const c=(0,i.up)("edit-item"),d=(0,i.up)("card-grid-filters"),u=(0,i.up)("card-grid-links"),p=(0,i.up)("grid-bottom");return(0,i.wg)(),(0,i.iD)(i.HY,null,[e.show_edit_modal?((0,i.wg)(),(0,i.j4)(c,{key:0,edit_data:a.edit_data},null,8,["edit_data"])):(0,i.kq)("",!0),(0,i._)("div",{class:(0,n.C_)(["wrapper",{blur:e.show_edit_modal}])},[(0,i._)("div",xo,[(0,i.Wm)(s.uT,{name:"mdl"},{default:(0,i.w5)((()=>[(0,i.Wm)(d,{ref:"filters",collval:e.collval,params:e.params},null,8,["collval","params"])])),_:1}),(0,i.Wm)(u,{ref:"links",onEmit_link:r.emit_link},null,8,["onEmit_link"])]),a.link.show_categoryes&&a.link.path.length!=a.link.selected_categoryes.length?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",So,[0==r.paginatedData.length?((0,i.wg)(),(0,i.iD)("label",Eo," Ничего не найдено ")):(0,i.kq)("",!0),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(r.paginatedData,((t,o)=>((0,i.wg)(),(0,i.iD)("div",{class:"card",key:t},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t,((t,o)=>(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",{class:"row",key:t},[(0,i._)("div",To,(0,n.zw)(e.params[o+1])+" :",1),(0,i._)("div",qo,(0,n.zw)(t),1)])),[[s.F8,e.collval[o]]]))),128)),(0,i._)("div",Io,[(0,i.wy)((0,i._)("input",{type:"checkbox",class:"checkbox",id:o+"a","onUpdate:modelValue":e=>a.changeValue[o]=e},null,8,Oo),[[s.e8,a.changeValue[o]]]),(0,i._)("label",{for:o+"a"},null,8,Po),(0,i._)("div",{class:"edit_icon",onClick:o=>r.open_edit_modal(t,e.data.indexOf(t))},null,8,$o)])])))),128))])),(0,i.Wm)(p,{previous:a.page>1,next:a.page*a.count<e.data.length,page:a.page,blur:e.show_edit_modal,show:(!a.link.show_categoryes||a.link.path.length==a.link.selected_categoryes.length)&&0!=r.paginatedData.length,count:a.count,onChangePage:r.changePage,onChangeCount:r.changeCount},null,8,["previous","next","page","blur","show","count","onChangePage","onChangeCount"])],2)],64)}const Wo={key:0,class:"filters"},Mo={class:"title"};function Fo(e,t,o,l,a,r){const c=(0,i.up)("filter-number"),d=(0,i.up)("filter-text"),u=(0,i.up)("filter-list"),p=(0,i.up)("filter-date"),_=(0,i.up)("filter-flag");return e.show_filter?((0,i.wg)(),(0,i.iD)("div",Wo,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.filtersValue,((t,l)=>(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",{class:"item",key:l},[(0,i._)("div",Mo,(0,n.zw)(o.params[l+1]),1),1==t.type||2==t.type?((0,i.wg)(),(0,i.j4)(c,{key:0,item:t,idx:l,onChange_filter_value:r.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,i.kq)("",!0),3==t.type||4==t.type?((0,i.wg)(),(0,i.j4)(d,{key:1,item:t,idx:l,onChange_filter_value:r.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,i.kq)("",!0),5==t.type||6==t.type?((0,i.wg)(),(0,i.j4)(u,{key:2,item:t,idx:l,selector_options:t.selector_options,onChange_filter_value:r.change_filter_value},null,8,["item","idx","selector_options","onChange_filter_value"])):(0,i.kq)("",!0),7==t.type||8==t.type?((0,i.wg)(),(0,i.j4)(p,{key:3,item:t,idx:l,onChange_filter_value:r.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,i.kq)("",!0),9==t.type?((0,i.wg)(),(0,i.j4)(_,{key:4,item:t,idx:l,onChange_filter_value:r.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,i.kq)("",!0)])),[[s.F8,e.show_filter&&!1!==o.collval[l]]]))),128))])):(0,i.kq)("",!0)}var Ho={props:{collval:{type:Array,required:!0,default(){return[]}},params:{type:Array,required:!0,default(){return[]}}},components:{FilterNumber:Ut,FilterText:Bt,FilterList:Kt,FilterDate:oo,FilterFlag:ao},data(){return{filtersValue:[]}},computed:{...(0,ro.Se)(["fields","show_filter"])},mounted(){this.feelFilters()},methods:{reset_filtersValue(){this.filtersValue=[]},change_filter_value(e,t){Object.assign(this.filtersValue[t],e)},feelFilters(){this.params.forEach(((e,t)=>{if(0!=t&&t!=this.params.length-1){let t=null,o=[];this.fields.forEach((i=>i.field==e?(t=i.type.value,o=i.selector_options):null));let i=null;5!=t&&6!=t||(i=[!0]),9==t&&(i=1);const n={type:t,option:1,selector_options:o,value:i};this.filtersValue.push(n)}}))}}};const Ao=(0,we.Z)(Ho,[["render",Fo],["__scopeId","data-v-64f368bd"]]);var Uo=Ao;const Lo=e=>((0,i.dD)("data-v-2472252f"),e=e(),(0,i.Cn)(),e),jo={class:"links"},No=["onClick"],Yo={class:"grid"},Bo=["onClick"],Ro={class:"row"},Zo=Lo((()=>(0,i._)("div",{class:"name"},null,-1))),zo={class:"value"};function Xo(e,t,o,l,a,r){return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",jo,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.selected_categoryes,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["triangle",{triangle_last:a.path.length-1==t}]),key:e,onClick:e=>{a.sel_idx=t,a.selected_categoryes.splice(t)}},(0,n.zw)(a.path[t]),11,No)))),128))]),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.path,((e,t)=>(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",{class:"path",key:e},[(0,i._)("div",Yo,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.categoryes[e],(e=>((0,i.wg)(),(0,i.iD)("div",{class:"card",key:e,onClick:t=>{a.selected_categoryes.push(e),a.sel_idx+=1}},[(0,i._)("div",Ro,[Zo,(0,i._)("div",zo,(0,n.zw)(e),1)])],8,Bo)))),128))])])),[[s.F8,a.sel_idx==t&&a.show_categoryes]]))),128))],64)}var Ko={emits:{get_data:null},data(){return{path:["Поступление","№ партии","НДС включен в цену"],selected_categoryes:[],sel_idx:0,show_categoryes:!0,categoryes:{}}},computed:{...(0,ro.Se)(["params","data"]),link(){const e={path:this.path,selected_categoryes:this.selected_categoryes,sel_idx:this.sel_idx,show_categoryes:this.show_categoryes,categoryes:this.categoryes};return e}},mounted(){this.get_data_categoryes(),this.emit_link()},watch:{link:{handler:function(){this.emit_link()},deep:!0},show_categoryes(){this.show_categoryes||this.reset_sel()}},methods:{showcategoryes(){this.show_categoryes=!0},reset_sel(){this.selected_categoryes=[],this.sel_idx=0},emit_link(){this.$emit("emit_link",this.link)},get_data_categoryes(){function e(e){let t=[];for(let o of e)t.includes(o)||t.push(o);return t}this.categoryes={};const t={};let o=[];o=o.concat(this.params),o.pop(),o.shift(),o.forEach(((o,i)=>{t[o]=[];let n=[];this.data.forEach((e=>{n.push(e[i])})),t[o]=e(n)})),Object.assign(this.categoryes,t)}}};const Go=(0,we.Z)(Ko,[["render",Xo],["__scopeId","data-v-2472252f"]]);var Jo=Go,Qo={name:"Main_grid",components:{EditItem:qt,GridBottom:It.Z,CardGridFilters:Uo,CardGridLinks:Jo},props:{},emits:{},data(){return{count:5,page:1,edit_data:[],changeValue:[],link:{path:null,selected_categoryes:null,sel_idx:null,show_categoryes:null,categoryes:null}}},computed:{countPage(){return this.count*(this.page-1)},paginatedData(){if(this.link.show_categoryes){let e=[];e=e.concat(this.data);let t=[];return e.forEach((e=>{let o=!0;this.link.path.forEach(((t,i)=>{const n=this.params.indexOf(t)-1;o=e[n]==this.link.selected_categoryes[i]&&o})),o&&t.push(e)})),t.slice(this.countPage,this.count*this.page)}return this.data.slice(this.countPage,this.count*this.page)},show_buttons(){let e=!1;return this.changeValue.forEach((t=>{void 0!=t&&(e=t||e)})),e},...(0,ro.Se)(["show_edit_modal"]),ref_links(){return this.$refs.links},ref_filters(){return this.$refs.filters}},watch:{page(){this.page<1&&(this.page=1)},count(){this.page=1},paginatedData:{handler:function(){this.changeValue=[]},deep:!0},data:{handler:function(){this.ref_links.get_data_categoryes(),this.ref_filters?.reset_filtersValue(),this.ref_filters?.feelFilters()},deep:!0},changeValue:{handler:function(){},deep:!0},show_buttons(){this.$store.commit("open_close_buttons",this.show_buttons)}},methods:{changeCount(e){this.count=e},changePage(e){this.page=e},drop_page(){this.page=1,this.ref_links.reset_sel(),this.ref_links.showcategoryes(),this.ref_filters?.feelFilters()},emit_link(e){Object.assign(this.link,e)},open_edit_modal(e,t){this.edit_data=[],this.edit_data=this.edit_data.concat(e),this.$store.commit("open_edit_modal",t)}}};const ei=(0,we.Z)(Qo,[["render",Vo],["__scopeId","data-v-129937c6"]]);var ti=ei;const oi=e=>((0,i.dD)("data-v-2b31fee3"),e=e(),(0,i.Cn)(),e),ii={class:"modal"},ni={class:"wrapper"},si=oi((()=>(0,i._)("div",{class:"modal-header"},[(0,i._)("div",{class:"head-text"},"Настройка таблицы")],-1))),li={class:"modal-body"},ai=oi((()=>(0,i._)("div",{class:"text"},[(0,i._)("small",{class:"small-text"},"Перетаскивайте колонки для изменения очередности")],-1))),ri=["onUpdate:modelValue","id","disabled"],ci=["for"],di={class:"modal-footer"};function ui(e,t,o,l,a,r){const c=(0,i.up)("draggable"),d=(0,i.up)("btns-save-close");return(0,i.wg)(),(0,i.iD)("div",ii,[(0,i._)("div",ni,[si,(0,i._)("div",li,[ai,(0,i.Wm)(c,{class:"dragArea",list:a.list,onChange:e.changeData},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.list,(e=>((0,i.wg)(),(0,i.iD)("div",{class:"item",key:e},[(0,i.wy)((0,i._)("input",{type:"checkbox","onUpdate:modelValue":t=>e.visible=t,id:e.code,class:"checkbox",disabled:2===e.visible||-1===e.visible},null,8,ri),[[s.e8,e.visible]]),(0,i._)("label",{for:e.code},null,8,ci),(0,i.Uk)(" "+(0,n.zw)(e.name),1)])))),128))])),_:1},8,["list","onChange"])]),(0,i._)("div",di,[(0,i.Wm)(d,{onClose:r.close,onSave:r.save},null,8,["onClose","onSave"])])])])}
/*!
  * vue-draggable-next v2.1.0
  * (c) 2021 Anish George
  * @license MIT
  */
/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
function pi(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,i)}return o}function _i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?pi(Object(o),!0).forEach((function(t){mi(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):pi(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function hi(e){return hi="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hi(e)}function mi(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function fi(){return fi=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},fi.apply(this,arguments)}function gi(e,t){if(null==e)return{};var o,i,n={},s=Object.keys(e);for(i=0;i<s.length;i++)o=s[i],t.indexOf(o)>=0||(n[o]=e[o]);return n}function vi(e,t){if(null==e)return{};var o,i,n=gi(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)o=s[i],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}var yi="1.14.0";function wi(e){if("undefined"!==typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var bi=wi(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Ci=wi(/Edge/i),ki=wi(/firefox/i),Di=wi(/safari/i)&&!wi(/chrome/i)&&!wi(/android/i),xi=wi(/iP(ad|od|hone)/i),Si=wi(/chrome/i)&&wi(/android/i),Ei={capture:!1,passive:!1};function Ti(e,t,o){e.addEventListener(t,o,!bi&&Ei)}function qi(e,t,o){e.removeEventListener(t,o,!bi&&Ei)}function Ii(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(o){return!1}return!1}}function Oi(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function Pi(e,t,o,i){if(e){o=o||document;do{if(null!=t&&(">"===t[0]?e.parentNode===o&&Ii(e,t):Ii(e,t))||i&&e===o)return e;if(e===o)break}while(e=Oi(e))}return null}var $i,Vi=/\s+/g;function Wi(e,t,o){if(e&&t)if(e.classList)e.classList[o?"add":"remove"](t);else{var i=(" "+e.className+" ").replace(Vi," ").replace(" "+t+" "," ");e.className=(i+(o?" "+t:"")).replace(Vi," ")}}function Mi(e,t,o){var i=e&&e.style;if(i){if(void 0===o)return document.defaultView&&document.defaultView.getComputedStyle?o=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(o=e.currentStyle),void 0===t?o:o[t];t in i||-1!==t.indexOf("webkit")||(t="-webkit-"+t),i[t]=o+("string"===typeof o?"":"px")}}function Fi(e,t){var o="";if("string"===typeof e)o=e;else do{var i=Mi(e,"transform");i&&"none"!==i&&(o=i+" "+o)}while(!t&&(e=e.parentNode));var n=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return n&&new n(o)}function Hi(e,t,o){if(e){var i=e.getElementsByTagName(t),n=0,s=i.length;if(o)for(;n<s;n++)o(i[n],n);return i}return[]}function Ai(){var e=document.scrollingElement;return e||document.documentElement}function Ui(e,t,o,i,n){if(e.getBoundingClientRect||e===window){var s,l,a,r,c,d,u;if(e!==window&&e.parentNode&&e!==Ai()?(s=e.getBoundingClientRect(),l=s.top,a=s.left,r=s.bottom,c=s.right,d=s.height,u=s.width):(l=0,a=0,r=window.innerHeight,c=window.innerWidth,d=window.innerHeight,u=window.innerWidth),(t||o)&&e!==window&&(n=n||e.parentNode,!bi))do{if(n&&n.getBoundingClientRect&&("none"!==Mi(n,"transform")||o&&"static"!==Mi(n,"position"))){var p=n.getBoundingClientRect();l-=p.top+parseInt(Mi(n,"border-top-width")),a-=p.left+parseInt(Mi(n,"border-left-width")),r=l+s.height,c=a+s.width;break}}while(n=n.parentNode);if(i&&e!==window){var _=Fi(n||e),h=_&&_.a,m=_&&_.d;_&&(l/=m,a/=h,u/=h,d/=m,r=l+d,c=a+u)}return{top:l,left:a,bottom:r,right:c,width:u,height:d}}}function Li(e,t,o){var i=Zi(e,!0),n=Ui(e)[t];while(i){var s=Ui(i)[o],l=void 0;if(l="top"===o||"left"===o?n>=s:n<=s,!l)return i;if(i===Ai())break;i=Zi(i,!1)}return!1}function ji(e,t,o,i){var n=0,s=0,l=e.children;while(s<l.length){if("none"!==l[s].style.display&&l[s]!==ns.ghost&&(i||l[s]!==ns.dragged)&&Pi(l[s],o.draggable,e,!1)){if(n===t)return l[s];n++}s++}return null}function Ni(e,t){var o=e.lastElementChild;while(o&&(o===ns.ghost||"none"===Mi(o,"display")||t&&!Ii(o,t)))o=o.previousElementSibling;return o||null}function Yi(e,t){var o=0;if(!e||!e.parentNode)return-1;while(e=e.previousElementSibling)"TEMPLATE"===e.nodeName.toUpperCase()||e===ns.clone||t&&!Ii(e,t)||o++;return o}function Bi(e){var t=0,o=0,i=Ai();if(e)do{var n=Fi(e),s=n.a,l=n.d;t+=e.scrollLeft*s,o+=e.scrollTop*l}while(e!==i&&(e=e.parentNode));return[t,o]}function Ri(e,t){for(var o in e)if(e.hasOwnProperty(o))for(var i in t)if(t.hasOwnProperty(i)&&t[i]===e[o][i])return Number(o);return-1}function Zi(e,t){if(!e||!e.getBoundingClientRect)return Ai();var o=e,i=!1;do{if(o.clientWidth<o.scrollWidth||o.clientHeight<o.scrollHeight){var n=Mi(o);if(o.clientWidth<o.scrollWidth&&("auto"==n.overflowX||"scroll"==n.overflowX)||o.clientHeight<o.scrollHeight&&("auto"==n.overflowY||"scroll"==n.overflowY)){if(!o.getBoundingClientRect||o===document.body)return Ai();if(i||t)return o;i=!0}}}while(o=o.parentNode);return Ai()}function zi(e,t){if(e&&t)for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}function Xi(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function Ki(e,t){return function(){if(!$i){var o=arguments,i=this;1===o.length?e.call(i,o[0]):e.apply(i,o),$i=setTimeout((function(){$i=void 0}),t)}}}function Gi(){clearTimeout($i),$i=void 0}function Ji(e,t,o){e.scrollLeft+=t,e.scrollTop+=o}function Qi(e){var t=window.Polymer,o=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):o?o(e).clone(!0)[0]:e.cloneNode(!0)}var en="Sortable"+(new Date).getTime();function tn(){var e,t=[];return{captureAnimationState:function(){if(t=[],this.options.animation){var e=[].slice.call(this.el.children);e.forEach((function(e){if("none"!==Mi(e,"display")&&e!==ns.ghost){t.push({target:e,rect:Ui(e)});var o=_i({},t[t.length-1].rect);if(e.thisAnimationDuration){var i=Fi(e,!0);i&&(o.top-=i.f,o.left-=i.e)}e.fromRect=o}}))}},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(Ri(t,{target:e}),1)},animateAll:function(o){var i=this;if(!this.options.animation)return clearTimeout(e),void("function"===typeof o&&o());var n=!1,s=0;t.forEach((function(e){var t=0,o=e.target,l=o.fromRect,a=Ui(o),r=o.prevFromRect,c=o.prevToRect,d=e.rect,u=Fi(o,!0);u&&(a.top-=u.f,a.left-=u.e),o.toRect=a,o.thisAnimationDuration&&Xi(r,a)&&!Xi(l,a)&&(d.top-a.top)/(d.left-a.left)===(l.top-a.top)/(l.left-a.left)&&(t=nn(d,r,c,i.options)),Xi(a,l)||(o.prevFromRect=l,o.prevToRect=a,t||(t=i.options.animation),i.animate(o,d,a,t)),t&&(n=!0,s=Math.max(s,t),clearTimeout(o.animationResetTimer),o.animationResetTimer=setTimeout((function(){o.animationTime=0,o.prevFromRect=null,o.fromRect=null,o.prevToRect=null,o.thisAnimationDuration=null}),t),o.thisAnimationDuration=t)})),clearTimeout(e),n?e=setTimeout((function(){"function"===typeof o&&o()}),s):"function"===typeof o&&o(),t=[]},animate:function(e,t,o,i){if(i){Mi(e,"transition",""),Mi(e,"transform","");var n=Fi(this.el),s=n&&n.a,l=n&&n.d,a=(t.left-o.left)/(s||1),r=(t.top-o.top)/(l||1);e.animatingX=!!a,e.animatingY=!!r,Mi(e,"transform","translate3d("+a+"px,"+r+"px,0)"),this.forRepaintDummy=on(e),Mi(e,"transition","transform "+i+"ms"+(this.options.easing?" "+this.options.easing:"")),Mi(e,"transform","translate3d(0,0,0)"),"number"===typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){Mi(e,"transition",""),Mi(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),i)}}}}function on(e){return e.offsetWidth}function nn(e,t,o,i){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-o.top,2)+Math.pow(t.left-o.left,2))*i.animation}var sn=[],ln={initializeByDefault:!0},an={mount:function(e){for(var t in ln)ln.hasOwnProperty(t)&&!(t in e)&&(e[t]=ln[t]);sn.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),sn.push(e)},pluginEvent:function(e,t,o){var i=this;this.eventCanceled=!1,o.cancel=function(){i.eventCanceled=!0};var n=e+"Global";sn.forEach((function(i){t[i.pluginName]&&(t[i.pluginName][n]&&t[i.pluginName][n](_i({sortable:t},o)),t.options[i.pluginName]&&t[i.pluginName][e]&&t[i.pluginName][e](_i({sortable:t},o)))}))},initializePlugins:function(e,t,o,i){for(var n in sn.forEach((function(i){var n=i.pluginName;if(e.options[n]||i.initializeByDefault){var s=new i(e,t,e.options);s.sortable=e,s.options=e.options,e[n]=s,fi(o,s.defaults)}})),e.options)if(e.options.hasOwnProperty(n)){var s=this.modifyOption(e,n,e.options[n]);"undefined"!==typeof s&&(e.options[n]=s)}},getEventProperties:function(e,t){var o={};return sn.forEach((function(i){"function"===typeof i.eventProperties&&fi(o,i.eventProperties.call(t[i.pluginName],e))})),o},modifyOption:function(e,t,o){var i;return sn.forEach((function(n){e[n.pluginName]&&n.optionListeners&&"function"===typeof n.optionListeners[t]&&(i=n.optionListeners[t].call(e[n.pluginName],o))})),i}};function rn(e){var t=e.sortable,o=e.rootEl,i=e.name,n=e.targetEl,s=e.cloneEl,l=e.toEl,a=e.fromEl,r=e.oldIndex,c=e.newIndex,d=e.oldDraggableIndex,u=e.newDraggableIndex,p=e.originalEvent,_=e.putSortable,h=e.extraEventProperties;if(t=t||o&&o[en],t){var m,f=t.options,g="on"+i.charAt(0).toUpperCase()+i.substr(1);!window.CustomEvent||bi||Ci?(m=document.createEvent("Event"),m.initEvent(i,!0,!0)):m=new CustomEvent(i,{bubbles:!0,cancelable:!0}),m.to=l||o,m.from=a||o,m.item=n||o,m.clone=s,m.oldIndex=r,m.newIndex=c,m.oldDraggableIndex=d,m.newDraggableIndex=u,m.originalEvent=p,m.pullMode=_?_.lastPutMode:void 0;var v=_i(_i({},h),an.getEventProperties(i,t));for(var y in v)m[y]=v[y];o&&o.dispatchEvent(m),f[g]&&f[g].call(t,m)}}var cn=["evt"],dn=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=o.evt,n=vi(o,cn);an.pluginEvent.bind(ns)(e,t,_i({dragEl:pn,parentEl:_n,ghostEl:hn,rootEl:mn,nextEl:fn,lastDownEl:gn,cloneEl:vn,cloneHidden:yn,dragStarted:Pn,putSortable:xn,activeSortable:ns.active,originalEvent:i,oldIndex:wn,oldDraggableIndex:Cn,newIndex:bn,newDraggableIndex:kn,hideGhostForTarget:es,unhideGhostForTarget:ts,cloneNowHidden:function(){yn=!0},cloneNowShown:function(){yn=!1},dispatchSortableEvent:function(e){un({sortable:t,name:e,originalEvent:i})}},n))};function un(e){rn(_i({putSortable:xn,cloneEl:vn,targetEl:pn,rootEl:mn,oldIndex:wn,oldDraggableIndex:Cn,newIndex:bn,newDraggableIndex:kn},e))}var pn,_n,hn,mn,fn,gn,vn,yn,wn,bn,Cn,kn,Dn,xn,Sn,En,Tn,qn,In,On,Pn,$n,Vn,Wn,Mn,Fn=!1,Hn=!1,An=[],Un=!1,Ln=!1,jn=[],Nn=!1,Yn=[],Bn="undefined"!==typeof document,Rn=xi,Zn=Ci||bi?"cssFloat":"float",zn=Bn&&!Si&&!xi&&"draggable"in document.createElement("div"),Xn=function(){if(Bn){if(bi)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Kn=function(e,t){var o=Mi(e),i=parseInt(o.width)-parseInt(o.paddingLeft)-parseInt(o.paddingRight)-parseInt(o.borderLeftWidth)-parseInt(o.borderRightWidth),n=ji(e,0,t),s=ji(e,1,t),l=n&&Mi(n),a=s&&Mi(s),r=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+Ui(n).width,c=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+Ui(s).width;if("flex"===o.display)return"column"===o.flexDirection||"column-reverse"===o.flexDirection?"vertical":"horizontal";if("grid"===o.display)return o.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(n&&l["float"]&&"none"!==l["float"]){var d="left"===l["float"]?"left":"right";return!s||"both"!==a.clear&&a.clear!==d?"horizontal":"vertical"}return n&&("block"===l.display||"flex"===l.display||"table"===l.display||"grid"===l.display||r>=i&&"none"===o[Zn]||s&&"none"===o[Zn]&&r+c>i)?"vertical":"horizontal"},Gn=function(e,t,o){var i=o?e.left:e.top,n=o?e.right:e.bottom,s=o?e.width:e.height,l=o?t.left:t.top,a=o?t.right:t.bottom,r=o?t.width:t.height;return i===l||n===a||i+s/2===l+r/2},Jn=function(e,t){var o;return An.some((function(i){var n=i[en].options.emptyInsertThreshold;if(n&&!Ni(i)){var s=Ui(i),l=e>=s.left-n&&e<=s.right+n,a=t>=s.top-n&&t<=s.bottom+n;return l&&a?o=i:void 0}})),o},Qn=function(e){function t(e,o){return function(i,n,s,l){var a=i.options.group.name&&n.options.group.name&&i.options.group.name===n.options.group.name;if(null==e&&(o||a))return!0;if(null==e||!1===e)return!1;if(o&&"clone"===e)return e;if("function"===typeof e)return t(e(i,n,s,l),o)(i,n,s,l);var r=(o?i:n).options.group.name;return!0===e||"string"===typeof e&&e===r||e.join&&e.indexOf(r)>-1}}var o={},i=e.group;i&&"object"==hi(i)||(i={name:i}),o.name=i.name,o.checkPull=t(i.pull,!0),o.checkPut=t(i.put),o.revertClone=i.revertClone,e.group=o},es=function(){!Xn&&hn&&Mi(hn,"display","none")},ts=function(){!Xn&&hn&&Mi(hn,"display","")};Bn&&document.addEventListener("click",(function(e){if(Hn)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Hn=!1,!1}),!0);var os=function(e){if(pn){e=e.touches?e.touches[0]:e;var t=Jn(e.clientX,e.clientY);if(t){var o={};for(var i in e)e.hasOwnProperty(i)&&(o[i]=e[i]);o.target=o.rootEl=t,o.preventDefault=void 0,o.stopPropagation=void 0,t[en]._onDragOver(o)}}},is=function(e){pn&&pn.parentNode[en]._isOutsideThisEl(e.target)};function ns(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=fi({},t),e[en]=this;var o={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Kn(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==ns.supportPointer&&"PointerEvent"in window&&!Di,emptyInsertThreshold:5};for(var i in an.initializePlugins(this,e,o),o)!(i in t)&&(t[i]=o[i]);for(var n in Qn(t),this)"_"===n.charAt(0)&&"function"===typeof this[n]&&(this[n]=this[n].bind(this));this.nativeDraggable=!t.forceFallback&&zn,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?Ti(e,"pointerdown",this._onTapStart):(Ti(e,"mousedown",this._onTapStart),Ti(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(Ti(e,"dragover",this),Ti(e,"dragenter",this)),An.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),fi(this,tn())}function ss(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function ls(e,t,o,i,n,s,l,a){var r,c,d=e[en],u=d.options.onMove;return!window.CustomEvent||bi||Ci?(r=document.createEvent("Event"),r.initEvent("move",!0,!0)):r=new CustomEvent("move",{bubbles:!0,cancelable:!0}),r.to=t,r.from=e,r.dragged=o,r.draggedRect=i,r.related=n||t,r.relatedRect=s||Ui(t),r.willInsertAfter=a,r.originalEvent=l,e.dispatchEvent(r),u&&(c=u.call(d,r,l)),c}function as(e){e.draggable=!1}function rs(){Nn=!1}function cs(e,t,o){var i=Ui(ji(o.el,0,o.options,!0)),n=10;return t?e.clientX<i.left-n||e.clientY<i.top&&e.clientX<i.right:e.clientY<i.top-n||e.clientY<i.bottom&&e.clientX<i.left}function ds(e,t,o){var i=Ui(Ni(o.el,o.options.draggable)),n=10;return t?e.clientX>i.right+n||e.clientX<=i.right&&e.clientY>i.bottom&&e.clientX>=i.left:e.clientX>i.right&&e.clientY>i.top||e.clientX<=i.right&&e.clientY>i.bottom+n}function us(e,t,o,i,n,s,l,a){var r=i?e.clientY:e.clientX,c=i?o.height:o.width,d=i?o.top:o.left,u=i?o.bottom:o.right,p=!1;if(!l)if(a&&Wn<c*n){if(!Un&&(1===Vn?r>d+c*s/2:r<u-c*s/2)&&(Un=!0),Un)p=!0;else if(1===Vn?r<d+Wn:r>u-Wn)return-Vn}else if(r>d+c*(1-n)/2&&r<u-c*(1-n)/2)return ps(t);return p=p||l,p&&(r<d+c*s/2||r>u-c*s/2)?r>d+c/2?1:-1:0}function ps(e){return Yi(pn)<Yi(e)?1:-1}function _s(e){var t=e.tagName+e.className+e.src+e.href+e.textContent,o=t.length,i=0;while(o--)i+=t.charCodeAt(o);return i.toString(36)}function hs(e){Yn.length=0;var t=e.getElementsByTagName("input"),o=t.length;while(o--){var i=t[o];i.checked&&Yn.push(i)}}function ms(e){return setTimeout(e,0)}function fs(e){return clearTimeout(e)}ns.prototype={constructor:ns,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||($n=null)},_getDirection:function(e,t){return"function"===typeof this.options.direction?this.options.direction.call(this,e,t,pn):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,o=this.el,i=this.options,n=i.preventOnFilter,s=e.type,l=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,a=(l||e).target,r=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||a,c=i.filter;if(hs(o),!pn&&!(/mousedown|pointerdown/.test(s)&&0!==e.button||i.disabled)&&!r.isContentEditable&&(this.nativeDraggable||!Di||!a||"SELECT"!==a.tagName.toUpperCase())&&(a=Pi(a,i.draggable,o,!1),(!a||!a.animated)&&gn!==a)){if(wn=Yi(a),Cn=Yi(a,i.draggable),"function"===typeof c){if(c.call(this,e,a,this))return un({sortable:t,rootEl:r,name:"filter",targetEl:a,toEl:o,fromEl:o}),dn("filter",t,{evt:e}),void(n&&e.cancelable&&e.preventDefault())}else if(c&&(c=c.split(",").some((function(i){if(i=Pi(r,i.trim(),o,!1),i)return un({sortable:t,rootEl:i,name:"filter",targetEl:a,fromEl:o,toEl:o}),dn("filter",t,{evt:e}),!0})),c))return void(n&&e.cancelable&&e.preventDefault());i.handle&&!Pi(r,i.handle,o,!1)||this._prepareDragStart(e,l,a)}}},_prepareDragStart:function(e,t,o){var i,n=this,s=n.el,l=n.options,a=s.ownerDocument;if(o&&!pn&&o.parentNode===s){var r=Ui(o);if(mn=s,pn=o,_n=pn.parentNode,fn=pn.nextSibling,gn=o,Dn=l.group,ns.dragged=pn,Sn={target:pn,clientX:(t||e).clientX,clientY:(t||e).clientY},In=Sn.clientX-r.left,On=Sn.clientY-r.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,pn.style["will-change"]="all",i=function(){dn("delayEnded",n,{evt:e}),ns.eventCanceled?n._onDrop():(n._disableDelayedDragEvents(),!ki&&n.nativeDraggable&&(pn.draggable=!0),n._triggerDragStart(e,t),un({sortable:n,name:"choose",originalEvent:e}),Wi(pn,l.chosenClass,!0))},l.ignore.split(",").forEach((function(e){Hi(pn,e.trim(),as)})),Ti(a,"dragover",os),Ti(a,"mousemove",os),Ti(a,"touchmove",os),Ti(a,"mouseup",n._onDrop),Ti(a,"touchend",n._onDrop),Ti(a,"touchcancel",n._onDrop),ki&&this.nativeDraggable&&(this.options.touchStartThreshold=4,pn.draggable=!0),dn("delayStart",this,{evt:e}),!l.delay||l.delayOnTouchOnly&&!t||this.nativeDraggable&&(Ci||bi))i();else{if(ns.eventCanceled)return void this._onDrop();Ti(a,"mouseup",n._disableDelayedDrag),Ti(a,"touchend",n._disableDelayedDrag),Ti(a,"touchcancel",n._disableDelayedDrag),Ti(a,"mousemove",n._delayedDragTouchMoveHandler),Ti(a,"touchmove",n._delayedDragTouchMoveHandler),l.supportPointer&&Ti(a,"pointermove",n._delayedDragTouchMoveHandler),n._dragStartTimer=setTimeout(i,l.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){pn&&as(pn),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;qi(e,"mouseup",this._disableDelayedDrag),qi(e,"touchend",this._disableDelayedDrag),qi(e,"touchcancel",this._disableDelayedDrag),qi(e,"mousemove",this._delayedDragTouchMoveHandler),qi(e,"touchmove",this._delayedDragTouchMoveHandler),qi(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?Ti(document,"pointermove",this._onTouchMove):Ti(document,t?"touchmove":"mousemove",this._onTouchMove):(Ti(pn,"dragend",this),Ti(mn,"dragstart",this._onDragStart));try{document.selection?ms((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(o){}},_dragStarted:function(e,t){if(Fn=!1,mn&&pn){dn("dragStarted",this,{evt:t}),this.nativeDraggable&&Ti(document,"dragover",is);var o=this.options;!e&&Wi(pn,o.dragClass,!1),Wi(pn,o.ghostClass,!0),ns.active=this,e&&this._appendGhost(),un({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(En){this._lastX=En.clientX,this._lastY=En.clientY,es();var e=document.elementFromPoint(En.clientX,En.clientY),t=e;while(e&&e.shadowRoot){if(e=e.shadowRoot.elementFromPoint(En.clientX,En.clientY),e===t)break;t=e}if(pn.parentNode[en]._isOutsideThisEl(e),t)do{if(t[en]){var o=void 0;if(o=t[en]._onDragOver({clientX:En.clientX,clientY:En.clientY,target:e,rootEl:t}),o&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);ts()}},_onTouchMove:function(e){if(Sn){var t=this.options,o=t.fallbackTolerance,i=t.fallbackOffset,n=e.touches?e.touches[0]:e,s=hn&&Fi(hn,!0),l=hn&&s&&s.a,a=hn&&s&&s.d,r=Rn&&Mn&&Bi(Mn),c=(n.clientX-Sn.clientX+i.x)/(l||1)+(r?r[0]-jn[0]:0)/(l||1),d=(n.clientY-Sn.clientY+i.y)/(a||1)+(r?r[1]-jn[1]:0)/(a||1);if(!ns.active&&!Fn){if(o&&Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))<o)return;this._onDragStart(e,!0)}if(hn){s?(s.e+=c-(Tn||0),s.f+=d-(qn||0)):s={a:1,b:0,c:0,d:1,e:c,f:d};var u="matrix(".concat(s.a,",").concat(s.b,",").concat(s.c,",").concat(s.d,",").concat(s.e,",").concat(s.f,")");Mi(hn,"webkitTransform",u),Mi(hn,"mozTransform",u),Mi(hn,"msTransform",u),Mi(hn,"transform",u),Tn=c,qn=d,En=n}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!hn){var e=this.options.fallbackOnBody?document.body:mn,t=Ui(pn,!0,Rn,!0,e),o=this.options;if(Rn){Mn=e;while("static"===Mi(Mn,"position")&&"none"===Mi(Mn,"transform")&&Mn!==document)Mn=Mn.parentNode;Mn!==document.body&&Mn!==document.documentElement?(Mn===document&&(Mn=Ai()),t.top+=Mn.scrollTop,t.left+=Mn.scrollLeft):Mn=Ai(),jn=Bi(Mn)}hn=pn.cloneNode(!0),Wi(hn,o.ghostClass,!1),Wi(hn,o.fallbackClass,!0),Wi(hn,o.dragClass,!0),Mi(hn,"transition",""),Mi(hn,"transform",""),Mi(hn,"box-sizing","border-box"),Mi(hn,"margin",0),Mi(hn,"top",t.top),Mi(hn,"left",t.left),Mi(hn,"width",t.width),Mi(hn,"height",t.height),Mi(hn,"opacity","0.8"),Mi(hn,"position",Rn?"absolute":"fixed"),Mi(hn,"zIndex","100000"),Mi(hn,"pointerEvents","none"),ns.ghost=hn,e.appendChild(hn),Mi(hn,"transform-origin",In/parseInt(hn.style.width)*100+"% "+On/parseInt(hn.style.height)*100+"%")}},_onDragStart:function(e,t){var o=this,i=e.dataTransfer,n=o.options;dn("dragStart",this,{evt:e}),ns.eventCanceled?this._onDrop():(dn("setupClone",this),ns.eventCanceled||(vn=Qi(pn),vn.draggable=!1,vn.style["will-change"]="",this._hideClone(),Wi(vn,this.options.chosenClass,!1),ns.clone=vn),o.cloneId=ms((function(){dn("clone",o),ns.eventCanceled||(o.options.removeCloneOnHide||mn.insertBefore(vn,pn),o._hideClone(),un({sortable:o,name:"clone"}))})),!t&&Wi(pn,n.dragClass,!0),t?(Hn=!0,o._loopId=setInterval(o._emulateDragOver,50)):(qi(document,"mouseup",o._onDrop),qi(document,"touchend",o._onDrop),qi(document,"touchcancel",o._onDrop),i&&(i.effectAllowed="move",n.setData&&n.setData.call(o,i,pn)),Ti(document,"drop",o),Mi(pn,"transform","translateZ(0)")),Fn=!0,o._dragStartId=ms(o._dragStarted.bind(o,t,e)),Ti(document,"selectstart",o),Pn=!0,Di&&Mi(document.body,"user-select","none"))},_onDragOver:function(e){var t,o,i,n,s=this.el,l=e.target,a=this.options,r=a.group,c=ns.active,d=Dn===r,u=a.sort,p=xn||c,_=this,h=!1;if(!Nn){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),l=Pi(l,a.draggable,s,!0),q("dragOver"),ns.eventCanceled)return h;if(pn.contains(e.target)||l.animated&&l.animatingX&&l.animatingY||_._ignoreWhileAnimating===l)return O(!1);if(Hn=!1,c&&!a.disabled&&(d?u||(i=_n!==mn):xn===this||(this.lastPutMode=Dn.checkPull(this,c,pn,e))&&r.checkPut(this,c,pn,e))){if(n="vertical"===this._getDirection(e,l),t=Ui(pn),q("dragOverValid"),ns.eventCanceled)return h;if(i)return _n=mn,I(),this._hideClone(),q("revert"),ns.eventCanceled||(fn?mn.insertBefore(pn,fn):mn.appendChild(pn)),O(!0);var m=Ni(s,a.draggable);if(!m||ds(e,n,this)&&!m.animated){if(m===pn)return O(!1);if(m&&s===e.target&&(l=m),l&&(o=Ui(l)),!1!==ls(mn,s,pn,t,l,o,e,!!l))return I(),s.appendChild(pn),_n=s,P(),O(!0)}else if(m&&cs(e,n,this)){var f=ji(s,0,a,!0);if(f===pn)return O(!1);if(l=f,o=Ui(l),!1!==ls(mn,s,pn,t,l,o,e,!1))return I(),s.insertBefore(pn,f),_n=s,P(),O(!0)}else if(l.parentNode===s){o=Ui(l);var g,v,y=0,w=pn.parentNode!==s,b=!Gn(pn.animated&&pn.toRect||t,l.animated&&l.toRect||o,n),C=n?"top":"left",k=Li(l,"top","top")||Li(pn,"top","top"),D=k?k.scrollTop:void 0;if($n!==l&&(g=o[C],Un=!1,Ln=!b&&a.invertSwap||w),y=us(e,l,o,n,b?1:a.swapThreshold,null==a.invertedSwapThreshold?a.swapThreshold:a.invertedSwapThreshold,Ln,$n===l),0!==y){var x=Yi(pn);do{x-=y,v=_n.children[x]}while(v&&("none"===Mi(v,"display")||v===hn))}if(0===y||v===l)return O(!1);$n=l,Vn=y;var S=l.nextElementSibling,E=!1;E=1===y;var T=ls(mn,s,pn,t,l,o,e,E);if(!1!==T)return 1!==T&&-1!==T||(E=1===T),Nn=!0,setTimeout(rs,30),I(),E&&!S?s.appendChild(pn):l.parentNode.insertBefore(pn,E?S:l),k&&Ji(k,0,D-k.scrollTop),_n=pn.parentNode,void 0===g||Ln||(Wn=Math.abs(g-Ui(l)[C])),P(),O(!0)}if(s.contains(pn))return O(!1)}return!1}function q(a,r){dn(a,_,_i({evt:e,isOwner:d,axis:n?"vertical":"horizontal",revert:i,dragRect:t,targetRect:o,canSort:u,fromSortable:p,target:l,completed:O,onMove:function(o,i){return ls(mn,s,pn,t,o,Ui(o),e,i)},changed:P},r))}function I(){q("dragOverAnimationCapture"),_.captureAnimationState(),_!==p&&p.captureAnimationState()}function O(t){return q("dragOverCompleted",{insertion:t}),t&&(d?c._hideClone():c._showClone(_),_!==p&&(Wi(pn,xn?xn.options.ghostClass:c.options.ghostClass,!1),Wi(pn,a.ghostClass,!0)),xn!==_&&_!==ns.active?xn=_:_===ns.active&&xn&&(xn=null),p===_&&(_._ignoreWhileAnimating=l),_.animateAll((function(){q("dragOverAnimationComplete"),_._ignoreWhileAnimating=null})),_!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(l===pn&&!pn.animated||l===s&&!l.animated)&&($n=null),a.dragoverBubble||e.rootEl||l===document||(pn.parentNode[en]._isOutsideThisEl(e.target),!t&&os(e)),!a.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),h=!0}function P(){bn=Yi(pn),kn=Yi(pn,a.draggable),un({sortable:_,name:"change",toEl:s,newIndex:bn,newDraggableIndex:kn,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){qi(document,"mousemove",this._onTouchMove),qi(document,"touchmove",this._onTouchMove),qi(document,"pointermove",this._onTouchMove),qi(document,"dragover",os),qi(document,"mousemove",os),qi(document,"touchmove",os)},_offUpEvents:function(){var e=this.el.ownerDocument;qi(e,"mouseup",this._onDrop),qi(e,"touchend",this._onDrop),qi(e,"pointerup",this._onDrop),qi(e,"touchcancel",this._onDrop),qi(document,"selectstart",this)},_onDrop:function(e){var t=this.el,o=this.options;bn=Yi(pn),kn=Yi(pn,o.draggable),dn("drop",this,{evt:e}),_n=pn&&pn.parentNode,bn=Yi(pn),kn=Yi(pn,o.draggable),ns.eventCanceled||(Fn=!1,Ln=!1,Un=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),fs(this.cloneId),fs(this._dragStartId),this.nativeDraggable&&(qi(document,"drop",this),qi(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Di&&Mi(document.body,"user-select",""),Mi(pn,"transform",""),e&&(Pn&&(e.cancelable&&e.preventDefault(),!o.dropBubble&&e.stopPropagation()),hn&&hn.parentNode&&hn.parentNode.removeChild(hn),(mn===_n||xn&&"clone"!==xn.lastPutMode)&&vn&&vn.parentNode&&vn.parentNode.removeChild(vn),pn&&(this.nativeDraggable&&qi(pn,"dragend",this),as(pn),pn.style["will-change"]="",Pn&&!Fn&&Wi(pn,xn?xn.options.ghostClass:this.options.ghostClass,!1),Wi(pn,this.options.chosenClass,!1),un({sortable:this,name:"unchoose",toEl:_n,newIndex:null,newDraggableIndex:null,originalEvent:e}),mn!==_n?(bn>=0&&(un({rootEl:_n,name:"add",toEl:_n,fromEl:mn,originalEvent:e}),un({sortable:this,name:"remove",toEl:_n,originalEvent:e}),un({rootEl:_n,name:"sort",toEl:_n,fromEl:mn,originalEvent:e}),un({sortable:this,name:"sort",toEl:_n,originalEvent:e})),xn&&xn.save()):bn!==wn&&bn>=0&&(un({sortable:this,name:"update",toEl:_n,originalEvent:e}),un({sortable:this,name:"sort",toEl:_n,originalEvent:e})),ns.active&&(null!=bn&&-1!==bn||(bn=wn,kn=Cn),un({sortable:this,name:"end",toEl:_n,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){dn("nulling",this),mn=pn=_n=hn=fn=vn=gn=yn=Sn=En=Pn=bn=kn=wn=Cn=$n=Vn=xn=Dn=ns.dragged=ns.ghost=ns.clone=ns.active=null,Yn.forEach((function(e){e.checked=!0})),Yn.length=Tn=qn=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":pn&&(this._onDragOver(e),ss(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e,t=[],o=this.el.children,i=0,n=o.length,s=this.options;i<n;i++)e=o[i],Pi(e,s.draggable,this.el,!1)&&t.push(e.getAttribute(s.dataIdAttr)||_s(e));return t},sort:function(e,t){var o={},i=this.el;this.toArray().forEach((function(e,t){var n=i.children[t];Pi(n,this.options.draggable,i,!1)&&(o[e]=n)}),this),t&&this.captureAnimationState(),e.forEach((function(e){o[e]&&(i.removeChild(o[e]),i.appendChild(o[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return Pi(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var o=this.options;if(void 0===t)return o[e];var i=an.modifyOption(this,e,t);o[e]="undefined"!==typeof i?i:t,"group"===e&&Qn(o)},destroy:function(){dn("destroy",this);var e=this.el;e[en]=null,qi(e,"mousedown",this._onTapStart),qi(e,"touchstart",this._onTapStart),qi(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(qi(e,"dragover",this),qi(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),An.splice(An.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!yn){if(dn("hideClone",this),ns.eventCanceled)return;Mi(vn,"display","none"),this.options.removeCloneOnHide&&vn.parentNode&&vn.parentNode.removeChild(vn),yn=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(yn){if(dn("showClone",this),ns.eventCanceled)return;pn.parentNode!=mn||this.options.group.revertClone?fn?mn.insertBefore(vn,fn):mn.appendChild(vn):mn.insertBefore(vn,pn),this.options.group.revertClone&&this.animate(pn,vn),Mi(vn,"display",""),yn=!1}}else this._hideClone()}},Bn&&Ti(document,"touchmove",(function(e){(ns.active||Fn)&&e.cancelable&&e.preventDefault()})),ns.utils={on:Ti,off:qi,css:Mi,find:Hi,is:function(e,t){return!!Pi(e,t,e,!1)},extend:zi,throttle:Ki,closest:Pi,toggleClass:Wi,clone:Qi,index:Yi,nextTick:ms,cancelNextTick:fs,detectDirection:Kn,getChild:ji},ns.get=function(e){return e[en]},ns.mount=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(ns.utils=_i(_i({},ns.utils),e.utils)),an.mount(e)}))},ns.create=function(e,t){return new ns(e,t)},ns.version=yi;var gs,vs,ys,ws,bs,Cs,ks=[],Ds=!1;function xs(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"===typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?Ti(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Ti(document,"pointermove",this._handleFallbackAutoScroll):t.touches?Ti(document,"touchmove",this._handleFallbackAutoScroll):Ti(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?qi(document,"dragover",this._handleAutoScroll):(qi(document,"pointermove",this._handleFallbackAutoScroll),qi(document,"touchmove",this._handleFallbackAutoScroll),qi(document,"mousemove",this._handleFallbackAutoScroll)),Es(),Ss(),Gi()},nulling:function(){bs=vs=gs=Ds=Cs=ys=ws=null,ks.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var o=this,i=(e.touches?e.touches[0]:e).clientX,n=(e.touches?e.touches[0]:e).clientY,s=document.elementFromPoint(i,n);if(bs=e,t||this.options.forceAutoScrollFallback||Ci||bi||Di){Ts(e,this.options,s,t);var l=Zi(s,!0);!Ds||Cs&&i===ys&&n===ws||(Cs&&Es(),Cs=setInterval((function(){var s=Zi(document.elementFromPoint(i,n),!0);s!==l&&(l=s,Ss()),Ts(e,o.options,s,t)}),10),ys=i,ws=n)}else{if(!this.options.bubbleScroll||Zi(s,!0)===Ai())return void Ss();Ts(e,this.options,Zi(s,!1),!1)}}},fi(e,{pluginName:"scroll",initializeByDefault:!0})}function Ss(){ks.forEach((function(e){clearInterval(e.pid)})),ks=[]}function Es(){clearInterval(Cs)}var Ts=Ki((function(e,t,o,i){if(t.scroll){var n,s=(e.touches?e.touches[0]:e).clientX,l=(e.touches?e.touches[0]:e).clientY,a=t.scrollSensitivity,r=t.scrollSpeed,c=Ai(),d=!1;vs!==o&&(vs=o,Ss(),gs=t.scroll,n=t.scrollFn,!0===gs&&(gs=Zi(o,!0)));var u=0,p=gs;do{var _=p,h=Ui(_),m=h.top,f=h.bottom,g=h.left,v=h.right,y=h.width,w=h.height,b=void 0,C=void 0,k=_.scrollWidth,D=_.scrollHeight,x=Mi(_),S=_.scrollLeft,E=_.scrollTop;_===c?(b=y<k&&("auto"===x.overflowX||"scroll"===x.overflowX||"visible"===x.overflowX),C=w<D&&("auto"===x.overflowY||"scroll"===x.overflowY||"visible"===x.overflowY)):(b=y<k&&("auto"===x.overflowX||"scroll"===x.overflowX),C=w<D&&("auto"===x.overflowY||"scroll"===x.overflowY));var T=b&&(Math.abs(v-s)<=a&&S+y<k)-(Math.abs(g-s)<=a&&!!S),q=C&&(Math.abs(f-l)<=a&&E+w<D)-(Math.abs(m-l)<=a&&!!E);if(!ks[u])for(var I=0;I<=u;I++)ks[I]||(ks[I]={});ks[u].vx==T&&ks[u].vy==q&&ks[u].el===_||(ks[u].el=_,ks[u].vx=T,ks[u].vy=q,clearInterval(ks[u].pid),0==T&&0==q||(d=!0,ks[u].pid=setInterval(function(){i&&0===this.layer&&ns.active._onTouchMove(bs);var t=ks[this.layer].vy?ks[this.layer].vy*r:0,o=ks[this.layer].vx?ks[this.layer].vx*r:0;"function"===typeof n&&"continue"!==n.call(ns.dragged.parentNode[en],o,t,e,bs,ks[this.layer].el)||Ji(ks[this.layer].el,o,t)}.bind({layer:u}),24))),u++}while(t.bubbleScroll&&p!==c&&(p=Zi(p,!1)));Ds=d}}),30),qs=function(e){var t=e.originalEvent,o=e.putSortable,i=e.dragEl,n=e.activeSortable,s=e.dispatchSortableEvent,l=e.hideGhostForTarget,a=e.unhideGhostForTarget;if(t){var r=o||n;l();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,d=document.elementFromPoint(c.clientX,c.clientY);a(),r&&!r.el.contains(d)&&(s("spill"),this.onSpill({dragEl:i,putSortable:o}))}};function Is(){}function Os(){}function Ps(){return"undefined"!==typeof window?window.console:o.g.console}Is.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,o=e.putSortable;this.sortable.captureAnimationState(),o&&o.captureAnimationState();var i=ji(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(t,i):this.sortable.el.appendChild(t),this.sortable.animateAll(),o&&o.animateAll()},drop:qs},fi(Is,{pluginName:"revertOnSpill"}),Os.prototype={onSpill:function(e){var t=e.dragEl,o=e.putSortable,i=o||this.sortable;i.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),i.animateAll()},drop:qs},fi(Os,{pluginName:"removeOnSpill"}),ns.mount(new xs),ns.mount(Os,Is);const $s=Ps();function Vs(e){const t=Object.create(null);return function(o){const i=t[o];return i||(t[o]=e(o))}}const Ws=/-(\w)/g,Ms=Vs((e=>e.replace(Ws,((e,t)=>t?t.toUpperCase():""))));function Fs(e){null!==e.parentElement&&e.parentElement.removeChild(e)}function Hs(e,t,o){const i=0===o?e.children[0]:e.children[o-1].nextSibling;e.insertBefore(t,i)}function As(e,t){return Object.values(e).indexOf(t)}function Us(e,t,o,i){if(!e)return[];const n=Object.values(e),s=t.length-i,l=[...t].map(((e,t)=>t>=s?n.length:n.indexOf(e)));return l}function Ls(e,t){this.$nextTick((()=>this.$emit(e.toLowerCase(),t)))}function js(e){return t=>{null!==this.realList&&this["onDrag"+e](t),Ls.call(this,e,t)}}function Ns(e){return["transition-group","TransitionGroup"].includes(e)}function Ys(e){if(!e||1!==e.length)return!1;const[{type:t}]=e;return!!t&&Ns(t.name)}function Bs(e,t){return t?{...t.props,...t.attrs}:e}const Rs=["Start","Add","Remove","Update","End"],Zs=["Choose","Unchoose","Sort","Filter","Clone"],zs=["Move",...Rs,...Zs].map((e=>"on"+e));let Xs=null;const Ks={options:Object,list:{type:Array,required:!1,default:null},noTransitionOnDrag:{type:Boolean,default:!1},clone:{type:Function,default:e=>e},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null},component:{type:String,default:null},modelValue:{type:Array,required:!1,default:null}},Gs=(0,i.aZ)({name:"VueDraggableNext",inheritAttrs:!1,emits:["update:modelValue","move","change",...Rs.map((e=>e.toLowerCase())),...Zs.map((e=>e.toLowerCase()))],props:Ks,data(){return{transitionMode:!1,noneFunctionalComponentMode:!1,headerOffset:0,footerOffset:0,_sortable:{},visibleIndexes:[],context:{}}},render(){const e=this.$slots.default?this.$slots.default():null,t=Bs(this.$attrs,this.componentData);return e?(this.transitionMode=Ys(e),(0,i.h)(this.getTag(),t,e)):(0,i.h)(this.getTag(),t,[])},created(){null!==this.list&&null!==this.modelValue&&$s.error("list props are mutually exclusive! Please set one.")},mounted(){const e={};Rs.forEach((t=>{e["on"+t]=js.call(this,t)})),Zs.forEach((t=>{e["on"+t]=Ls.bind(this,t)}));const t=Object.keys(this.$attrs).reduce(((e,t)=>(e[Ms(t)]=this.$attrs[t],e)),{}),o=Object.assign({},t,e,{onMove:(e,t)=>this.onDragMove(e,t)});!("draggable"in o)&&(o.draggable=">*");const i=1===this.$el.nodeType?this.$el:this.$el.parentElement;this._sortable=new ns(i,o),i.__draggable_component__=this,this.computeIndexes()},beforeUnmount(){try{void 0!==this._sortable&&this._sortable.destroy()}catch(e){}},computed:{realList(){return this.list?this.list:this.modelValue}},watch:{$attrs:{handler(e){this.updateOptions(e)},deep:!0},realList(){this.computeIndexes()}},methods:{getTag(){return this.component?(0,i.up)(this.component):this.tag},updateOptions(e){for(var t in e){const o=Ms(t);-1===zs.indexOf(o)&&this._sortable.option(o,e[t])}},getChildrenNodes(){return this.$el.children},computeIndexes(){this.$nextTick((()=>{this.visibleIndexes=Us(this.getChildrenNodes(),this.$el.children,this.transitionMode,this.footerOffset)}))},getUnderlyingVm(e){const t=As(this.getChildrenNodes()||[],e);if(-1===t)return null;const o=this.realList[t];return{index:t,element:o}},emitChanges(e){this.$nextTick((()=>{this.$emit("change",e)}))},alterList(e){if(this.list)return void e(this.list);const t=[...this.modelValue];e(t),this.$emit("update:modelValue",t)},spliceList(){const e=e=>e.splice(...arguments);this.alterList(e)},updatePosition(e,t){const o=o=>o.splice(t,0,o.splice(e,1)[0]);this.alterList(o)},getVmIndex(e){const t=this.visibleIndexes,o=t.length;return e>o-1?o:t[e]},getComponent(){return this.$slots.default?this.$slots.default()[0].componentInstance:null},resetTransitionData(e){if(!this.noTransitionOnDrag||!this.transitionMode)return;var t=this.getChildrenNodes();t[e].data=null;const o=this.getComponent();o.children=[],o.kept=void 0},onDragStart(e){this.context=this.getUnderlyingVm(e.item),this.context&&(e.item._underlying_vm_=this.clone(this.context.element),Xs=e.item)},onDragAdd(e){const t=e.item._underlying_vm_;if(void 0===t)return;Fs(e.item);const o=this.getVmIndex(e.newIndex);this.spliceList(o,0,t),this.computeIndexes();const i={element:t,newIndex:o};this.emitChanges({added:i})},onDragRemove(e){if(Hs(this.$el,e.item,e.oldIndex),"clone"===e.pullMode)return void Fs(e.clone);if(!this.context)return;const t=this.context.index;this.spliceList(t,1);const o={element:this.context.element,oldIndex:t};this.resetTransitionData(t),this.emitChanges({removed:o})},onDragUpdate(e){Fs(e.item),Hs(e.from,e.item,e.oldIndex);const t=this.context.index,o=this.getVmIndex(e.newIndex);this.updatePosition(t,o);const i={element:this.context.element,oldIndex:t,newIndex:o};this.emitChanges({moved:i})},updateProperty(e,t){e.hasOwnProperty(t)&&(e[t]+=this.headerOffset)},onDragMove(e,t){const o=this.move;if(!o||!this.realList)return!0;const i=this.getRelatedContextFromMoveEvent(e),n=this.context,s=this.computeFutureIndex(i,e);Object.assign(n,{futureIndex:s});const l=Object.assign({},e,{relatedContext:i,draggedContext:n});return o(l,t)},onDragEnd(){this.computeIndexes(),Xs=null},getTrargetedComponent(e){return e.__draggable_component__},getRelatedContextFromMoveEvent({to:e,related:t}){const o=this.getTrargetedComponent(e);if(!o)return{component:o};const i=o.realList,n={list:i,component:o};if(e!==t&&i&&o.getUnderlyingVm){const e=o.getUnderlyingVm(t);if(e)return Object.assign(e,n)}return n},computeFutureIndex(e,t){const o=[...t.to.children].filter((e=>"none"!==e.style["display"]));if(0===o.length)return 0;const i=o.indexOf(t.related),n=e.component.getVmIndex(i),s=-1!==o.indexOf(Xs);return s||!t.willInsertAfter?n:n+1}}});var Js={components:{draggable:Gs,BtnsSaveClose:he.Z},props:{selectedWH:{type:Object}},emits:{},data(){return{list:[]}},computed:{tableConfig(){return this.$store.state.account.tableConfig}},async mounted(){await this.$store.dispatch("getTableConfig","whs"!=this.selectedWH.value?this.selectedWH.value:"");const e=[];Object.entries(this.tableConfig).map((t=>{t[1].code=t[0],e.push(t[1])})),this.list=JSON.parse(JSON.stringify(e)),this.list.map((e=>{1===e.visible&&(e.visible=!0),0===e.visible&&(e.visible=!1)}))},methods:{save(){this.list.map(((e,t)=>e.sort=t+1));const e={value:{config:[],code:"whs"!=this.selectedWH.value?this.selectedWH.value:""},wh:"whs"!=this.selectedWH.value?this.selectedWH.value:""};this.list.forEach((t=>{t.visible&&e.value.config.push(t.code)})),this.$store.dispatch("update_config_table",e),this.$store.commit("close_table_settings")},close(){this.$store.commit("close_table_settings")}}};const Qs=(0,we.Z)(Js,[["render",ui],["__scopeId","data-v-2b31fee3"]]);var el=Qs;const tl=e=>((0,i.dD)("data-v-565debf2"),e=e(),(0,i.Cn)(),e),ol={class:"bgc"},il={class:"container"},nl={class:"header"},sl={class:"top"},ll=tl((()=>(0,i._)("label",null,"Настройки товаров",-1))),al=(0,i.Uk)("Назад"),rl=tl((()=>(0,i._)("br",null,null,-1))),cl={class:"bottom"},dl={class:"permits"},ul={class:"permit"},pl=tl((()=>(0,i._)("label",{for:"q1"}," Разрешать добавлять товары из резерва в другие сделки ",-1))),_l={class:"permit"},hl=tl((()=>(0,i._)("label",{for:"q2"}," Изменить цену у товаров в открытых сделках (по умолчанию) ",-1))),ml={class:"permit"},fl=tl((()=>(0,i._)("label",{for:"q3"}," Разрешать добавлять в сделки товар с нулевым остатком ",-1))),gl={class:"sync"},vl=tl((()=>(0,i._)("label",null,"Синхронизация товаров на складе с товарами amoCRM",-1))),yl={class:"list"},wl={class:"label_input"},bl=tl((()=>(0,i._)("label",null," Выберите список товаров из amoCRM для синхронизации ",-1))),Cl={class:"label_input"},kl=tl((()=>(0,i._)("label",null," Скрытие штатной вкладки amoCRM с товарами. В штатной вкладке с товарами так же можно прикреплять товары к сделкам, но количество товара на складе учитываться учитываться не будет. ",-1))),Dl={class:"content"},xl=tl((()=>(0,i._)("h6",null,"Этапы резервирования товаров со склада",-1))),Sl=tl((()=>(0,i._)("div",{class:"small"}," Внимание! В рамках одной воронки этап резерирования должен быть раньше этапа списания. Если этап презервирования не выбран, то резерирование будет происходить в момент добавления товара в сделку. ",-1))),El={class:"steps"},Tl=tl((()=>(0,i._)("h6",null,"Этапы списания товаров со склада",-1))),ql=tl((()=>(0,i._)("div",{class:"small"}," Внимание! В рамках одной воронки этап списания должен быть позже этапа резерирования. ",-1))),Il={class:"steps"},Ol=tl((()=>(0,i._)("h6",null,"Привязка полей сделок",-1))),Pl={class:"steps"},$l={class:"footer"},Vl=(0,i.Uk)("Назад");function Wl(e,t,o,l,a,r){const c=(0,i.up)("btns-save-close"),d=(0,i.up)("SelectorVue");return(0,i.wg)(),(0,i.iD)("div",{class:"wrapper",onClick:t[5]||(t[5]=(0,s.iM)((e=>r.close()),["self"]))},[(0,i._)("div",ol,[(0,i._)("div",il,[(0,i._)("div",nl,[(0,i._)("div",sl,[ll,(0,i.Wm)(c,{onClose:r.close,onSave:r.save},{close:(0,i.w5)((()=>[al])),_:1},8,["onClose","onSave"])]),rl,(0,i._)("div",cl,[(0,i._)("div",dl,[(0,i._)("div",ul,[(0,i.wy)((0,i._)("input",{type:"checkbox",class:"checkbox",id:"q1","onUpdate:modelValue":t[0]||(t[0]=e=>a.copyConfing.allow_add_reserve=e)},null,512),[[s.e8,a.copyConfing.allow_add_reserve]]),pl]),(0,i._)("div",_l,[(0,i.wy)((0,i._)("input",{type:"checkbox",class:"checkbox",id:"q2","onUpdate:modelValue":t[1]||(t[1]=e=>a.copyConfing.allow_change_price=e)},null,512),[[s.e8,a.copyConfing.allow_change_price]]),hl]),(0,i._)("div",ml,[(0,i.wy)((0,i._)("input",{type:"checkbox",class:"checkbox",id:"q3","onUpdate:modelValue":t[2]||(t[2]=e=>a.copyConfing.allow_add_with_zero_count=e)},null,512),[[s.e8,a.copyConfing.allow_add_with_zero_count]]),fl])]),(0,i._)("div",gl,[vl,(0,i._)("div",yl,[(0,i._)("div",wl,[bl,(0,i.Wm)(d,{options_props:a.copyProductLists,onSelect:t[3]||(t[3]=e=>r.optionSelectSync(e,"amo_product_list")),selected_option:a.copyProductLists[0]},null,8,["options_props","selected_option"])]),(0,i._)("div",Cl,[kl,(0,i.Wm)(d,{options_props:a.amoLeadsGroupHide,onSelect:t[4]||(t[4]=e=>r.optionSelectSync(e,"amo_leads_group_hide")),selected_option:a.selectedAmoLeadsGroupHide},null,8,["options_props","selected_option"])])])])])]),(0,i._)("div",Dl,[xl,Sl,(0,i._)("div",El,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.copyPipelinesList,(e=>((0,i.wg)(),(0,i.iD)("div",{class:"label_input",key:e},[(0,i._)("label",null,' Воронка "'+(0,n.zw)(e?.name)+'" ',1),(0,i.Wm)(d,{options_props:e?.statuses,onSelect:t=>r.optionSelectSteps(t,e?.value,"reserve_off"),selected_option:e.selectedReserveOff},null,8,["options_props","onSelect","selected_option"])])))),128))]),Tl,ql,(0,i._)("div",Il,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.copyPipelinesList,(e=>((0,i.wg)(),(0,i.iD)("div",{class:"label_input",key:e},[(0,i._)("label",null,' Воронка "'+(0,n.zw)(e?.name)+'" ',1),(0,i.Wm)(d,{options_props:e?.statuses,onSelect:t=>r.optionSelectSteps(t,e?.value,"write_off"),selected_option:e.selectedWriteOff},null,8,["options_props","onSelect","selected_option"])])))),128))]),Ol,(0,i._)("div",Pl,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.leadsDeals,(e=>((0,i.wg)(),(0,i.iD)("div",{class:"label_input",key:e},[(0,i._)("label",null,' Поле "'+(0,n.zw)(e?.name)+'" ',1),(0,i.Wm)(d,{options_props:a.leadsDealsList,onSelect:t=>r.optionSelectLeadsDeals(t,e?.code),selected_option:e?.selected},null,8,["options_props","onSelect","selected_option"])])))),128))])]),(0,i._)("div",$l,[(0,i.Wm)(c,{onClose:r.close,onSave:r.save},{close:(0,i.w5)((()=>[Vl])),_:1},8,["onClose","onSave"])])])])])}var Ml={components:{SelectorVue:_e.Z,BtnsSaveClose:he.Z},data(){return{copyConfing:{reserve_off:[],write_off:[]},copyPipelinesList:[],copyLeadFieldsList:[],leadsDeals:[{name:"Товары",code:"field_products",selected:{name:"Не выбрано",value:-1}},{name:"Себестоимость",code:"field_cost_price",selected:{name:"Не выбрано",value:-1}},{name:"Прибыль",code:"field_profit",selected:{name:"Не выбрано",value:-1}},{name:"Общий бюджет",code:"field_budget",selected:{name:"Не выбрано",value:-1}},{name:"НДС сумма",code:"field_nds_sum",selected:{name:"Не выбрано",value:-1}}],leadsDealsList:[],copyProductLists:[],amoLeadsGroupHide:[],selectedAmoLeadsGroupHide:{name:"Не выбрано",value:-1}}},async mounted(){await this.$store.dispatch("get_account"),this.copyConfing=this.$store.state.account.account.config,await this.$store.dispatch("getPipelinesList"),this.copyPipelinesList=this.pipelinesList,await this.$store.dispatch("getLeadFieldsList"),this.copyLeadFieldsList=this.leadFieldsList,await this.$store.dispatch("getProductLists"),this.copyProductLists=this.productLists,this.searchSelectedPipelines(),this.feelLeadsDealsList(),this.feelAmoLeadsGroupHide()},computed:{pipelinesList(){const e=[];return Object.entries(this.$store.state.account.pipelinesList).map((t=>{const o=[];Object.entries(t[1].statuses).forEach((e=>o.push({name:e[1],value:e[0]}))),t[1].statuses=o,t[1].statuses.unshift({name:"Не выбрано",value:-1}),t[1].selectedReserveOff={name:"Не выбрано",value:-1},t[1].selectedWriteOff={name:"Не выбрано",value:-1},e.push({value:t[0],...t[1]})})),e},leadFieldsList(){const e=[];return Object.entries(this.$store.state.account.leadFieldsList).map((t=>{const o=[];Object.entries(t[1].fields).forEach((e=>o.push({name:e[1],value:e[0]}))),t[1].fields=o,t[1].fields.unshift({name:"Не выбрано",value:-1}),t[1].selected={name:"Не выбрано",value:-1},e.push({value:t[0],...t[1]})})),e},productLists(){return[...this.$store.state.account.productLists,{name:"Не выбрано",value:-1}]}},methods:{save(){this.$store.dispatch("update_account",this.copyConfing),this.close()},close(){this.$store.commit("open_close_show_edit_stuff",!1)},optionSelectLeadsDeals(e,t){-1==e.value?this.copyConfing[t]=0:this.copyConfing[t]=e.value,this.leadsDeals.map((o=>{o.code==t&&(o.selected=e)}))},optionSelectSync(e,t){-1==e.value?this.copyConfing[t]=0:("amo_leads_group_hide"==t&&(this.selectedAmoLeadsGroupHide=e),this.copyConfing[t]=e.value)},optionSelectSteps(e,t,o){let i=!0;this.copyConfing[o][t]&&(this.copyConfing[o][t]=e.value,i=!1);const n={};n[t]=e.value,i&&this.copyConfing[o].push(n),-1==e.value&&this.copyConfing[o].forEach(((e,i)=>{Object.entries(e)[0][0]==t&&delete this.copyConfing[o][i]})),this.copyPipelinesList.map((i=>{i.value==t&&("write_off"==o?i.selectedWriteOff=e:i.selectedReserveOff=e)}))},searchSelectedInArr(e,t,o){let i={name:"Не выбрано",value:-1};return t.forEach((t=>{t[o]==e&&(i=t)})),i},searchSelectedPipelines(){this.copyPipelinesList.map((e=>{this.copyConfing.reserve_off[e.value]&&(e.selectedReserveOff=this.searchSelectedInArr(this.copyConfing.reserve_off[e.value],e.statuses,"value")),this.copyConfing.write_off[e.value]&&(e.selectedWriteOff=this.searchSelectedInArr(this.copyConfing.write_off[e.value],e.statuses,"value"))}))},feelLeadsDealsList(){this.leadsDealsList.push({name:"Не выбрано",value:-1}),this.copyLeadFieldsList.forEach((e=>{const t=e.name;this.leadsDealsList.push({name:t,value:"optgroup"});const o=e.fields.splice(1,999);o.forEach((e=>this.leadsDealsList.push({...e,optgroup:!0})))}))},feelAmoLeadsGroupHide(){this.amoLeadsGroupHide.push({name:"Не выбрано",value:-1}),this.copyLeadFieldsList.forEach((e=>{this.amoLeadsGroupHide.push({name:e.name,value:e.value})}))},searchSelectedAmoLeadsGroupHide(){this.amoLeadsGroupHide.forEach((e=>{e.value==this.copyConfing.amo_leads_group_hide&&(this.selectedAmoLeadsGroupHide=e)}))}}};const Fl=(0,we.Z)(Ml,[["render",Wl],["__scopeId","data-v-565debf2"]]);var Hl=Fl;const Al=e=>((0,i.dD)("data-v-817a3b86"),e=e(),(0,i.Cn)(),e),Ul={class:"wrapper"},Ll={class:"container"},jl=Al((()=>(0,i._)("div",{class:"header"},[(0,i._)("label",null,"Добавление товаров")],-1))),Nl={class:"content"},Yl={class:"table"},Bl={class:"row title"},Rl=Al((()=>(0,i._)("td",{class:"item"},null,-1))),Zl={class:"item"},zl=["onUpdate:modelValue","onFocusin","onFocusout","onInput","disabled"],Xl=["onUpdate:modelValue","onFocusin","onFocusout","onInput","disabled"],Kl={class:"item"},Gl={class:"select_input"},Jl=["onUpdate:modelValue","disabled"],Ql={class:"item"},ea={class:"item"},ta=["onUpdate:modelValue","disabled"],oa={class:"item"},ia={class:"item"},na=["onUpdate:modelValue","disabled"],sa={class:"item"},la=["onUpdate:modelValue"],aa={class:"nds"},ra={key:0},ca=["onUpdate:modelValue","id"],da=["for"],ua={key:1,class:"hiden"},pa={class:"checkboxes"},_a=["onUpdate:modelValue","id"],ha=["for"],ma=["onUpdate:modelValue","id"],fa=["for"],ga=["onUpdate:modelValue","id"],va=["for"],ya=["onUpdate:modelValue"],wa={class:"item"},ba={class:"item"},Ca=["onClick"],ka={class:"content_footer"},Da={class:"autocomplete_teleport"},xa=["onClick"],Sa={class:"footer"};function Ea(e,t,o,l,a,r){const c=(0,i.up)("selector-vue"),d=(0,i.up)("btns-save-close");return(0,i.wg)(),(0,i.iD)("div",Ul,[(0,i._)("div",Ll,[jl,(0,i._)("div",Nl,[(0,i._)("table",Yl,[(0,i._)("thead",null,[(0,i._)("tr",Bl,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.title,(e=>((0,i.wg)(),(0,i.iD)("td",{class:"item",key:e},(0,n.zw)(e),1)))),128)),Rl])]),(0,i._)("tbody",null,[(0,i.Wm)(s.W3,{name:"row"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.new_items,((t,o)=>((0,i.wg)(),(0,i.iD)("tr",{class:"row",key:t},[(0,i._)("td",Zl,[(0,i.Wm)(c,{options_props:a.options_type,onSelect:(e,t)=>r.option_select(e,t,"type"),selected_option:t.type,idx:o,disabled:!t.new},null,8,["options_props","onSelect","selected_option","idx","disabled"])]),(0,i._)("td",{class:"item",ref_for:!0,ref:e=>a.selected_field_autocomplete.idx==o&&"article"==a.selected_field_autocomplete.field?a.targetAutocomplete=e:null},[(0,i.wy)((0,i._)("input",{type:"text","onUpdate:modelValue":e=>t.article=e,onFocusin:e=>r.set_selected_field_autocomplete("article",t.article,o),onFocusout:e=>r.set_selected_field_autocomplete("","",o),onInput:e=>r.set_selected_field_autocomplete("article",t.article,o),class:(0,n.C_)(["input",{not_valid:""==t.article&&e.try_accept}]),disabled:!t.new},null,42,zl),[[s.nr,t.article]])],512),(0,i._)("td",{class:"item",ref_for:!0,ref:e=>a.selected_field_autocomplete.idx==o&&"name"==a.selected_field_autocomplete.field?a.targetAutocomplete=e:null},[(0,i.wy)((0,i._)("input",{type:"text","onUpdate:modelValue":e=>t.name=e,onFocusin:e=>r.set_selected_field_autocomplete("name",t.name,o),onFocusout:e=>r.set_selected_field_autocomplete("","",o),onInput:e=>r.set_selected_field_autocomplete("name",t.name,o),class:(0,n.C_)(["input",{not_valid:""==t.name&&e.try_accept}]),disabled:!t.new},null,42,Xl),[[s.nr,t.name]])],512),(0,i._)("td",Kl,[(0,i._)("div",Gl,[(0,i.Wm)(c,{options_props:a.batch_category_options,onSelect:(e,t)=>r.option_select(e,t,"batch_category"),selected_option:t.batch_category,idx:o,disabled:!t.new||2==t.type.value},null,8,["options_props","onSelect","selected_option","idx","disabled"]),(0,i.wy)((0,i._)("input",{type:"text","onUpdate:modelValue":e=>t.batch=e,class:(0,n.C_)(["input",{not_valid:""==t.batch&&e.try_accept&&2!=t.type.value}]),disabled:!t.new||2==t.type.value},null,10,Jl),[[s.nr,t.batch]])])]),(0,i._)("td",Ql,[(0,i.Wm)(c,{options_props:a.wh_options,onSelect:(e,t)=>r.option_select(e,t,"wh"),selected_option:t.wh,idx:o,disabled:2==t.type.value},null,8,["options_props","onSelect","selected_option","idx","disabled"])]),(0,i._)("td",ea,[(0,i.wy)((0,i._)("input",{type:"number","onUpdate:modelValue":e=>t.count=e,class:(0,n.C_)(["input",{not_valid:(""==t.count||void 0==t.count)&&e.try_accept&&2!=t.type}]),disabled:2==t.type.value,min:"0"},null,10,ta),[[s.nr,t.count]])]),(0,i._)("td",oa,[(0,i.Wm)(c,{options_props:a.units_options,onSelect:(e,t)=>r.option_select(e,t,"units"),selected_option:t.units,idx:o,disabled:2==t.type.value},null,8,["options_props","onSelect","selected_option","idx","disabled"])]),(0,i._)("td",ia,[(0,i.wy)((0,i._)("input",{type:"number","onUpdate:modelValue":e=>t.cost_price=e,class:(0,n.C_)(["input",{not_valid:""==t.cost_price&&e.try_accept}]),min:"0",disabled:!t.new},null,10,na),[[s.nr,t.cost_price]])]),(0,i._)("td",sa,[(0,i.wy)((0,i._)("input",{type:"number","onUpdate:modelValue":e=>t.price.cost=e,class:(0,n.C_)(["input",{not_valid:""==t.price.cost&&e.try_accept}]),min:"0"},null,10,la),[[s.nr,t.price.cost]])]),(0,i._)("td",{class:(0,n.C_)(["item",{long:t.price.is_nds}])},[(0,i._)("div",aa,[t.price.is_nds?((0,i.wg)(),(0,i.iD)("div",ua,[(0,i._)("div",pa,[(0,i.wy)((0,i._)("input",{type:"checkbox","onUpdate:modelValue":e=>t.price.is_nds=e,class:"checkbox",id:o+"nq"},null,8,_a),[[s.e8,t.price.is_nds]]),(0,i._)("label",{for:o+"nq"},"НДС",8,ha),(0,i.wy)((0,i._)("input",{type:"checkbox","onUpdate:modelValue":e=>t.price.is_price_include_nds=e,class:"checkbox",id:o+"nw"},null,8,ma),[[s.e8,t.price.is_price_include_nds]]),(0,i._)("label",{for:o+"nw"},"включен в цену",8,fa),(0,i.wy)((0,i._)("input",{type:"checkbox","onUpdate:modelValue":e=>t.price.is_manager_can_change_nds=e,class:"checkbox",id:o+"ne"},null,8,ga),[[s.e8,t.price.is_manager_can_change_nds]]),(0,i._)("label",{for:o+"ne"},"можно менять %",8,va)]),(0,i.wy)((0,i._)("input",{type:"number",class:"input","onUpdate:modelValue":e=>t.price.nds=e,placeholder:"% НДС",min:"0"},null,8,ya),[[s.nr,t.price.nds]])])):((0,i.wg)(),(0,i.iD)("div",ra,[(0,i.wy)((0,i._)("input",{type:"checkbox","onUpdate:modelValue":e=>t.price.is_nds=e,class:"checkbox",id:o+"nq"},null,8,ca),[[s.e8,t.price.is_nds]]),(0,i._)("label",{for:o+"nq"},null,8,da)]))])],2),(0,i._)("td",wa,[(0,i.Wm)(c,{options_props:a.categories_options,onSelect:(e,t)=>r.option_select(e,t,"category"),selected_option:t.category,idx:o},null,8,["options_props","onSelect","selected_option","idx"])]),(0,i.Wm)(s.uT,{name:"row"},{default:(0,i.w5)((()=>[(0,i._)("td",ba,[(0,i.wy)((0,i._)("button",{class:"del_btn",onClick:t=>e.del_item(o)}," X ",8,Ca),[[s.F8,a.new_items.length>1]])])])),_:2},1024)])))),128))])),_:1})])]),(0,i._)("div",ka,[(0,i._)("button",{class:"add_new_button",onClick:t[0]||(t[0]=e=>r.push_new_item())},"+")])]),a.selected_field_autocomplete_list.length?((0,i.wg)(),(0,i.j4)(i.lR,{key:0,to:a.targetAutocomplete},[(0,i._)("ul",Da,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.selected_field_autocomplete_list,(e=>((0,i.wg)(),(0,i.iD)("li",{key:e.id,onClick:t=>r.select_current_product(e.fields.name,e.fields.article)},(0,n.zw)(e.fields.name),9,xa)))),128))])],8,["to"])):(0,i.kq)("",!0),(0,i._)("div",Sa,[(0,i.Wm)(d,{onClose:r.close,onSave:r.save},null,8,["onClose","onSave"])])])])}o(2262),o(4506);var Ta={components:{SelectorVue:_e.Z,BtnsSaveClose:he.Z},props:{currentItems:{type:Array,required:!1,default(){return[]}}},data(){return{title:["Тип","Артикул","Название","№ партии","Склад","Кол-во","Единицы измерений","Себестоимость","Цена","НДС","Категория"],new_items:[],options_type:[{name:"Товар",value:1},{name:"Услуга",value:2}],batch_category_options:[],wh_options:[],units_options:[],categories_options:[],selected_field_autocomplete:{idx:null,field:"",value:""},selected_field_autocomplete_list:[],timer:0,targetAutocomplete:null}},computed:{fields(){return this.$store.state.fields.all_fields}},async mounted(){await this.$store.dispatch("get_fields_properties"),await this.$store.dispatch("get_all_fields"),this.get_categories_options(),this.get_options("batch",this.batch_category_options,"Новая"),this.get_options("wh",this.wh_options,"Не выбрано"),this.get_options("units",this.units_options,"Не выбрано"),this.currentItems.length?this.pushCurrentItems():this.push_new_item()},watch:{selected_field_autocomplete:{async handler(){clearTimeout(this.timer),this.timer=setTimeout((async()=>{const e=this.selected_field_autocomplete;if(this.selected_field_autocomplete_list=[],""!==e.field&&e.value.length>2&&" "!=e.value.split("").at(-1)&&" "!=e.value.split("")[0]){const t=await this.$store.dispatch("autocomplete_"+e.field,e.value);void 0!=t&&(this.selected_field_autocomplete_list=[...t])}}),500)},deep:!0}},methods:{push_new_item(){const e={new:!0,type:{name:"Товар",value:1},article:"",name:"",batch_category:{name:"Новая",value:-1},batch:"",wh:{name:"Не выбрано",value:-1},count:0,units:{name:"Не выбрано",value:-1},cost_price:0,category:{name:"Не выбрано",value:-1},price:{cost:0,currency:"RUB",is_manager_can_change_nds:!1,is_nds:!1,is_price_include_nds:!1,nds:0}};this.new_items.push(e)},pushCurrentItems(){this.currentItems.forEach((e=>{const t={new:!1,type:{name:"Товар",value:1},article:e.fields.article,name:e.fields.name,batch_category:{name:"",value:-1},batch:e.fields.batch,wh:{name:"Не выбрано",value:-1},count:0,units:{name:"Не выбрано",value:-1},cost_price:e.fields.cost_price,category:{...this.categories_options.filter((t=>t.value==e.fields.category))[0]},price:{cost:0,currency:"RUB",is_manager_can_change_nds:!1,is_nds:!1,is_price_include_nds:!1,nds:0}};this.new_items.push(t)}))},set_selected_field_autocomplete(e,t,o){""==e&&(this.targetAutocomplete=null),this.selected_field_autocomplete={field:e,value:t,idx:o}},select_current_product(e,t){this.new_items[this.selected_field_autocomplete.idx].name=e,this.new_items[this.selected_field_autocomplete.idx].article=t,this.set_selected_field_autocomplete("","",null)},get_options(e,t,o){t.push({name:o,value:-1}),this.search_type_options(this.fields,e).forEach(((e,o)=>t.push({name:e,value:o})))},get_categories_options(){this.$store.state.categories.fields_properties.forEach((e=>{let t="";for(let o=1;o<e.level;o++)t+="    ";this.categories_options.push({name:t+e.name,value:e.id})}))},search_type_options(e,t){let o=[];return e.forEach((e=>{e.code==t&&e.data&&(o=e.data)})),o},option_select(e,t,o){this.new_items[t][o]={...e}},close(){this.$emit("close"),this.$store.commit("open_close_new_position",!1)},save(){const e={products:[]};this.new_items.forEach((t=>{const o={is_service:t.type.value-1,fields:{name:t.name,article:t.article,batch:t.batch,units:t.units.name,cost_price:t.cost_price,
//!!!не работают
price:t.price,category:t.category.value}};e.products.push(o)})),this.$store.dispatch("add_product",e),this.close()}}};const qa=(0,we.Z)(Ta,[["render",Ea],["__scopeId","data-v-817a3b86"]]);var Ia=qa;const Oa=e=>((0,i.dD)("data-v-619b2ece"),e=e(),(0,i.Cn)(),e),Pa={class:"wrapper"},$a={class:"container"},Va=Oa((()=>(0,i._)("div",{class:"header"},[(0,i._)("label",null,"Списание товаров")],-1))),Wa={class:"content"},Ma={class:"table"},Fa={class:"row title"},Ha={class:"item"},Aa=["onUpdate:modelValue"],Ua={class:"item"},La=["onUpdate:modelValue"],ja={class:"item"},Na={class:"select_input"},Ya={class:"item"},Ba=["onUpdate:modelValue"],Ra={class:"item"},Za=["onUpdate:modelValue"],za={class:"footer"};function Xa(e,t,o,l,a,r){const c=(0,i.up)("selector-vue"),d=(0,i.up)("btns-save-close");return(0,i.wg)(),(0,i.iD)("div",Pa,[(0,i._)("div",$a,[Va,(0,i._)("div",Wa,[(0,i._)("table",Ma,[(0,i._)("thead",null,[(0,i._)("tr",Fa,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.title,(e=>((0,i.wg)(),(0,i.iD)("td",{class:"item",key:e},(0,n.zw)(e),1)))),128))])]),(0,i._)("tbody",null,[(0,i.Wm)(s.W3,{name:"row"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.items_to_cancel,((e,t)=>((0,i.wg)(),(0,i.iD)("tr",{class:"row",key:e},[(0,i._)("td",Ha,[(0,i.wy)((0,i._)("input",{type:"text","onUpdate:modelValue":e=>a.items_to_cancel[t][0]=e,class:"input",disabled:""},null,8,Aa),[[s.nr,a.items_to_cancel[t][0]]])]),(0,i._)("td",Ua,[(0,i.wy)((0,i._)("input",{type:"text","onUpdate:modelValue":e=>a.items_to_cancel[t][1]=e,class:"input",disabled:""},null,8,La),[[s.nr,a.items_to_cancel[t][1]]])]),(0,i._)("td",ja,[(0,i._)("div",Na,[(0,i.Wm)(c,{options_props:a.options1[t],onSelect:r.option_select1,selected_option:a.items_to_cancel[t][2],idx:t,disabled:!0},null,8,["options_props","onSelect","selected_option","idx"])])]),(0,i._)("td",Ya,[(0,i.wy)((0,i._)("input",{type:"number","onUpdate:modelValue":e=>a.items_to_cancel[t][3]=e,class:(0,n.C_)(["input",{not_valid:""==a.items_to_cancel[t][3]&&a.try_accept}])},null,10,Ba),[[s.nr,a.items_to_cancel[t][3]]])]),(0,i._)("td",Ra,[(0,i.wy)((0,i._)("input",{type:"text","onUpdate:modelValue":e=>a.items_to_cancel[t][4]=e,class:(0,n.C_)(["input",{not_valid:""==a.items_to_cancel[t][4]&&a.try_accept}])},null,10,Za),[[s.nr,a.items_to_cancel[t][4]]])])])))),128))])),_:1})])])]),(0,i._)("div",za,[(0,i.Wm)(d,{onClose:r.close_modal,onSave:r.save},null,8,["onClose","onSave"])])])])}var Ka={components:{SelectorVue:_e.Z,BtnsSaveClose:he.Z},props:{rows:{type:Array,required:!0,default(){return[]}},idxes:{type:Array,required:!0}},data(){return{title:["Артикул","Название","№ партии","Кол-во","Причина списания"],items_to_cancel:[],options1:[],try_accept:!1,max_count_to_cancel:[]}},watch:{items_to_cancel:{handler:function(){this.items_to_cancel.forEach(((e,t)=>{e[3]<0&&(this.items_to_cancel[t][3]=0),e[3]>this.max_count_to_cancel[t]&&(this.items_to_cancel[t][3]=this.max_count_to_cancel[t])}))},deep:!0}},mounted(){(0,i.Y3)((()=>{this.push_current_item(),this.items_to_cancel.forEach((e=>{this.max_count_to_cancel.push(e[3])}))}))},methods:{push_current_item(){this.rows.forEach(((e,t)=>{this.items_to_cancel.push([]),e.forEach((e=>{this.items_to_cancel[t].push(e)})),this.options1.push([{name:this.items_to_cancel[t][2],value:1}]),this.items_to_cancel[t][2]=this.options1[t][0]}))},save(){this.try_accept=!0;let e=!0;this.items_to_cancel.forEach((t=>{e=e&&""!=t[3]&&""!=t[4]&&void 0!=t[3]&&void 0!=t[4]})),e&&(this.items_to_cancel.forEach(((e,t)=>{const o={name:"На складе",idx:this.idxes[t],count:e[3]};this.$store.commit("cancel_item_in_data",o)})),this.close_modal())},close_modal(){this.items_to_cancel=[],this.try_accept=!1,this.$store.commit("open_close_cancel_position",!1)},option_select1(e,t){this.items_to_cancel[t][2]=e}}};const Ga=(0,we.Z)(Ka,[["render",Xa],["__scopeId","data-v-619b2ece"]]);var Ja=Ga,Qa=o(7821);const er=e=>((0,i.dD)("data-v-816d79e2"),e=e(),(0,i.Cn)(),e),tr={class:"bgc"},or={class:"container"},ir={class:"header"},nr={class:"top"},sr=er((()=>(0,i._)("label",null,"Категории товаров",-1))),lr=(0,i.Uk)("Назад"),ar=er((()=>(0,i._)("br",null,null,-1))),rr={class:"bottom"},cr={class:"tooltip_teleport"},dr={class:"content"},ur=["onDragstart"],pr={class:"input_name"},_r=["onMouseenter"],hr=["onKeyup","onUpdate:modelValue","disabled"],mr=["onClick","onMouseenter"],fr=["onClick","onMouseenter"],gr=er((()=>(0,i._)("div",{class:"rename btn"},null,-1))),vr=[gr],yr=["onClick","onMouseenter"],wr=er((()=>(0,i._)("div",{class:"remove btn"},null,-1))),br=[wr],Cr=["id","onClick","onMouseenter"],kr=er((()=>(0,i._)("div",{class:"add btn"},null,-1))),Dr=[kr],xr={class:"footer"},Sr=(0,i.Uk)("Назад");function Er(e,t,o,l,a,r){const c=(0,i.up)("btns-save-close"),d=(0,i.up)("ProductsCategoryRemoveModal"),u=(0,i.up)("draggable");return(0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["wrapper",{opened_close_remove_modal:a.del_modal_config.show}]),onClick:t[11]||(t[11]=(0,s.iM)((e=>r.close_product_category()),["self"]))},[(0,i._)("div",tr,[(0,i._)("div",or,[(0,i._)("div",ir,[(0,i._)("div",nr,[sr,(0,i.Wm)(c,{onClose:r.close_product_category,onSave:e.save,show_save:!1},{close:(0,i.w5)((()=>[lr])),_:1},8,["onClose","onSave"])]),ar,(0,i._)("div",rr,[a.del_modal_config.show?((0,i.wg)(),(0,i.j4)(i.lR,{key:0,to:"body"},[(0,i.Wm)(d,{onRemove:r.remove,onClose:r.closeRemoveModal},null,8,["onRemove","onClose"])])):(0,i.kq)("",!0),null!==a.target?((0,i.wg)(),(0,i.j4)(i.lR,{key:1,to:a.target},[(0,i._)("div",{onFocusout:t[4]||(t[4]=e=>r.reset_fields_cat_name())},[(0,i.wy)((0,i._)("input",{type:"text",class:"input_teleport","onUpdate:modelValue":t[0]||(t[0]=e=>a.fields_cat_name=e),ref:"input",onKeyup:[t[1]||(t[1]=(0,s.D2)((t=>r.add_new(a.fields_cat_name,e.item)),["enter"])),t[2]||(t[2]=(0,s.D2)((e=>r.reset_fields_cat_name()),["esc"]))]},null,544),[[s.nr,a.fields_cat_name]]),(0,i._)("button",{class:"button_teleport",onClick:t[3]||(t[3]=t=>r.add_new(a.fields_cat_name,e.item))}," ок ")],32)],8,["to"])):(0,i.kq)("",!0),null!==a.target_hovered_category?((0,i.wg)(),(0,i.j4)(i.lR,{key:2,to:a.target_hovered_category},[(0,i._)("p",cr,(0,n.zw)(a.hovered_category_text[a.hovered_category?.type]),1)],8,["to"])):(0,i.kq)("",!0)])]),(0,i._)("div",dr,[(0,i.Wm)(u,{class:"dragArea",list:r.copy_fields_properties,onChange:r.changeData},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(r.copy_fields_properties,((e,o)=>((0,i.wg)(),(0,i.iD)("div",{key:e.id,class:(0,n.C_)(["item",{darag:a.isDragged==o}]),style:(0,n.j5)({width:r.calculate_width(e.level)+"%"}),onDragstart:e=>a.isDragged=o,onDragend:t[10]||(t[10]=e=>a.isDragged=null)},[(0,i._)("div",pr,[(0,i._)("div",{onMouseenter:t=>a.hovered_category={id:e.id,type:"name"},onMouseleave:t[5]||(t[5]=e=>a.target_hovered_category=null),ref_for:!0,ref:t=>e.id===a.hovered_category?.id&&"name"==a.hovered_category.type?a.target_hovered_category=t:null,class:"text_block"},[(0,i.wy)((0,i._)("input",{type:"text",class:"input",onKeyup:(0,s.D2)((t=>r.rename(e.id)),["enter"]),"onUpdate:modelValue":t=>e.name=t,disabled:0===e.parent_id},null,40,hr),[[s.nr,e.name]])],40,_r),!a.all_old?.name?.includes(e.name)&&a.all_old?.id?.includes(e.id)?((0,i.wg)(),(0,i.iD)("button",{key:0,onClick:t=>r.rename(e.id),class:"btns",onMouseenter:t=>a.hovered_category={id:e.id,type:"apply"},onMouseleave:t[6]||(t[6]=e=>a.target_hovered_category=null),ref_for:!0,ref:t=>e.id===a.hovered_category?.id&&"apply"==a.hovered_category.type?a.target_hovered_category=t:null},[(0,i._)("div",{class:(0,n.C_)(["btn",{apply:!a.confirm,confirm:a.confirm}])},null,2)],40,mr)):(0,i.kq)("",!0),!a.all_old?.name?.includes(e.name)&&a.all_old?.id?.includes(e.id)?((0,i.wg)(),(0,i.iD)("button",{key:1,onClick:t=>r.prevname(e.id),class:"btns",onMouseenter:t=>a.hovered_category={id:e.id,type:"prevname"},onMouseleave:t[7]||(t[7]=e=>a.target_hovered_category=null),ref_for:!0,ref:t=>e.id===a.hovered_category?.id&&"prevname"==a.hovered_category.type?a.target_hovered_category=t:null},vr,40,fr)):(0,i.kq)("",!0)]),(0,i._)("div",null,[0!==e.parent_id&&(!r.copy_fields_properties[o+1]||r.copy_fields_properties[o+1]?.level<=e.level)?((0,i.wg)(),(0,i.iD)("button",{key:0,onClick:(0,s.iM)((t=>r.setRemoveModalConfig(e.id,e.level)),["stop"]),class:"btns",onMouseenter:t=>a.hovered_category={id:e.id,type:"delete"},onMouseleave:t[8]||(t[8]=e=>a.target_hovered_category=null),ref_for:!0,ref:t=>e.id===a.hovered_category?.id&&"delete"==a.hovered_category.type?a.target_hovered_category=t:null},br,40,yr)):(0,i.kq)("",!0),(0,i._)("button",{id:e.id,onClick:t=>a.selected_category_id=e.id,class:"btns",ref_for:!0,ref:t=>e.id===a.selected_category_id?a.target=t:e.id===a.hovered_category?.id&&"add"==a.hovered_category.type?a.target_hovered_category=t:null,onMouseenter:t=>a.hovered_category={id:e.id,type:"add"},onMouseleave:t[9]||(t[9]=e=>a.target_hovered_category=null)},Dr,40,Cr)])],46,ur)))),128))])),_:1},8,["list","onChange"])]),(0,i._)("div",xr,[(0,i.Wm)(c,{onClose:r.close_product_category,onSave:e.save,show_save:!1},{close:(0,i.w5)((()=>[Sr])),_:1},8,["onClose","onSave"])])])])],2)}const Tr=e=>((0,i.dD)("data-v-32531ac4"),e=e(),(0,i.Cn)(),e),qr={class:"bg"},Ir={class:"modal"},Or=Tr((()=>(0,i._)("h3",{class:"header"},"Подтверждаете удаление категории?",-1))),Pr=Tr((()=>(0,i._)("p",{class:"text"}," В случае удаления категории свойства товаров этой категории будут перенесены в корневую категорию ",-1))),$r={class:"buttons"},Vr=(0,i.Uk)("Удалить");function Wr(e,t,o,n,s,l){const a=(0,i.up)("BtnsSaveClose");return(0,i.wg)(),(0,i.iD)("div",qr,[(0,i._)("div",Ir,[Or,Pr,(0,i._)("div",$r,[(0,i.Wm)(a,{onClose:l.close,onSave:l.remove},{save:(0,i.w5)((()=>[Vr])),_:1},8,["onClose","onSave"])])])])}var Mr={components:{BtnsSaveClose:he.Z},methods:{close(){this.$emit("close")},remove(){this.$emit("remove")}}};const Fr=(0,we.Z)(Mr,[["render",Wr],["__scopeId","data-v-32531ac4"]]);var Hr=Fr,Ar={components:{BtnsSaveClose:he.Z,ProductsCategoryRemoveModal:Hr,draggable:Gs},data(){return{fields_cat_name:"",selected_category_id:null,hovered_category:null,target:null,target_hovered_category:null,all_old:{},isDragged:null,confirm:!1,del_modal_config:{show:!1,id:null,level:null},hovered_category_text:{name:"Изменение названия категории",apply:"Сохраняет название категории",prevname:"Возвращает изначальное название",delete:"Удаление категории",add:"Добавлние новой подкатегории"}}},async mounted(){this.$store.dispatch("get_fields_properties").then((()=>this.get_all_old()))},computed:{copy_fields_properties(){return this.$store.state.categories.fields_properties}},watch:{target:{handler:function(){(0,kt.nextTick)((()=>{null!==this.target&&this.$refs.input.focus()}))},deep:!0},target_hovered_category(){}},methods:{changeData(e){const t=e.moved.newIndex,o=[...this.copy_fields_properties],i={id:o[t].id,parent_id:o[t-1].id,name:""};this.$store.dispatch("update_fields_properties",i)},get_all_old(){const e={name:[],id:[],parent_id:[],fields_id:[],level:[],levels:[]};this.$store.state.categories.fields_properties.forEach((t=>Object.entries(t).forEach((t=>e[t[0]]?.push(t[1]))))),Object.assign(this.all_old,e)},add_new(){const e=this.copy_fields_properties.filter((e=>e.id===this.selected_category_id))[0];e.level+1<=10&&""!=this.fields_cat_name&&(this.$store.dispatch("add_fields_properties",{name:this.fields_cat_name,parent_id:e.id}),this.reset_fields_cat_name())},async rename(e){const t=[...this.copy_fields_properties].filter((t=>t.id===e))[0],o={id:t.id,parent_id:"",name:t.name};await this.$store.dispatch("update_fields_properties",o),this.confirm=!0,setTimeout((()=>{this.confirm=!1,this.get_all_old()}),1e3)},prevname(e){this.$store.state.categories.fields_properties.map((t=>{const o=()=>{let t="";return this.all_old.id.forEach(((o,i)=>o===e?t=this.all_old.name[i]:null)),t};t.id===e&&(t.name=o(),this.rename(e))}))},reset_fields_cat_name(){setTimeout((()=>{this.selected_category_id=null,this.fields_cat_name="",this.target=null}),100)},calculate_width(e){let t=100;return t*=.95**(e-1),t},setRemoveModalConfig(e,t){this.del_modal_config.level=t,this.del_modal_config.id=e,this.del_modal_config.show=!0},remove(){1!=this.del_modal_config.level&&this.$store.dispatch("delete_fields_properties",{id:this.del_modal_config.id}),this.closeRemoveModal()},closeRemoveModal(){this.del_modal_config.show=!1},close_product_category(){this.$store.commit("open_close_product_category",!1)}}};const Ur=(0,we.Z)(Ar,[["render",Er],["__scopeId","data-v-816d79e2"]]);var Lr=Ur;const jr=e=>((0,i.dD)("data-v-2e459476"),e=e(),(0,i.Cn)(),e),Nr={class:"bgc"},Yr={class:"container"},Br={class:"header"},Rr={class:"top"},Zr=jr((()=>(0,i._)("label",null,"Свойства товаров",-1))),zr=(0,i.Uk)("Назад"),Xr=jr((()=>(0,i._)("br",null,null,-1))),Kr={class:"links"},Gr=["onClick"],Jr={class:"bottom"},Qr={class:"content"},ec=jr((()=>(0,i._)("h6",null,"Поля товаров в сделке",-1))),tc={class:"rows"},oc=jr((()=>(0,i._)("tr",{class:"row"},[(0,i._)("th",{class:"item"},[(0,i._)("div",{class:"copy_fields"},[(0,i._)("span",null,"Поле")])]),(0,i._)("th",{class:"item"},"Тип"),(0,i._)("th",{class:"item"},"Видимость в сделке"),(0,i._)("th",{class:"item"},"Редактирование в сделке"),(0,i._)("th",{class:"item"})],-1))),ic={class:"item"},nc={key:0},sc=["onUpdate:modelValue","onKeyup","onChange"],lc={class:"item selectors"},ac={key:0,class:"type_selector_options"},rc=["onUpdate:modelValue","onChange"],cc=["onClick"],dc=["onClick"],uc={class:"box item"},pc=["id","disabled","onUpdate:modelValue","onChange"],_c=["for"],hc={class:"box item"},mc=["id","disabled","onUpdate:modelValue","onChange"],fc=["for"],gc={class:"item del_sell"},vc=["onClick"],yc=["onClick"],wc={class:"item"},bc=["onUpdate:modelValue","onKeyup"],Cc={class:"item selectors"},kc={key:0,class:"type_selector_options"},Dc=["onUpdate:modelValue"],xc=["onClick"],Sc=["onClick"],Ec={class:"box item"},Tc=["id","disabled","onUpdate:modelValue"],qc=["for"],Ic={class:"box item"},Oc=["id","disabled","onUpdate:modelValue"],Pc=["for"],$c={class:"item del_sell"},Vc=["onClick"],Wc=["onClick"],Mc={class:"footer"},Fc=(0,i.Uk)("Назад");function Hc(e,t,o,l,a,r){const c=(0,i.up)("btns-save-close"),d=(0,i.up)("SelectorVue");return(0,i.wg)(),(0,i.iD)("div",{class:"wrapper",onClick:t[1]||(t[1]=(0,s.iM)((e=>r.close_product_properties()),["self"]))},[(0,i._)("div",Nr,[(0,i._)("div",Yr,[(0,i._)("div",Br,[(0,i._)("div",Rr,[Zr,(0,i.Wm)(c,{onClose:r.close_product_properties,show_save:!1},{close:(0,i.w5)((()=>[zr])),_:1},8,["onClose"])]),Xr,(0,i._)("div",Kr,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.selected_fields_properties,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:(0,n.C_)(["triangle",{triangle_last:a.selected_fields_properties.length-1==t}]),key:e.id,onClick:e=>r.prev_cat(t)},(0,n.zw)(e.name),11,Gr)))),128))]),(0,i._)("div",Jr,[(0,i.Wm)(d,{options_props:a.data_fields_properties.items,onSelect:r.option_select_fields_properties,selected_option:a.data_fields_properties.selected},null,8,["options_props","onSelect","selected_option"])])]),(0,i._)("div",Qr,[ec,(0,i._)("table",tc,[oc,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.copy_fields,((e,t)=>(0,i.wy)(((0,i.wg)(),(0,i.iD)("tr",{class:(0,n.C_)(["row",{load:a.is_loading}]),key:e.id},[(0,i._)("td",ic,[e.is_system?((0,i.wg)(),(0,i.iD)("span",nc,(0,n.zw)(e.name),1)):(0,i.wy)(((0,i.wg)(),(0,i.iD)("input",{key:1,type:"text",class:(0,n.C_)(["input new_item_input",{error:e.nameError}]),"onUpdate:modelValue":t=>e.name=t,onKeyup:(0,s.D2)((e=>r.update_field(t,["name"])),["enter"]),onChange:t=>e.change=!0},null,42,sc)),[[s.nr,e.name]])]),(0,i._)("td",lc,[(0,i.Wm)(d,{options_props:r.types,onSelect:r.option_select_type,selected_option:r.search_type(e.type),disabled:!0,idx:t},null,8,["options_props","onSelect","selected_option","idx"]),5==e.type||6==e.type?((0,i.wg)(),(0,i.iD)("div",ac,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.data,((o,n)=>((0,i.wg)(),(0,i.iD)("div",{class:"type_selector_option",key:n},[(0,i.wy)((0,i._)("input",{type:"text",class:"input","onUpdate:modelValue":t=>e.data[n]=t,onChange:t=>e.change=!0},null,40,rc),[[s.nr,e.data[n]]]),(0,i._)("button",{class:"del_button",onClick:o=>(r.remove_selector_option(t,n),e.change=!0)},null,8,cc)])))),128)),(0,i._)("button",{onClick:o=>(r.add_selector_option(t),e.change=!0),class:"add_button"},null,8,dc)])):(0,i.kq)("",!0)]),(0,i._)("td",uc,[(0,i.wy)((0,i._)("input",{type:"checkbox",class:"checkbox",id:t+"nb",disabled:e.lead_config.visible.disabled,"onUpdate:modelValue":t=>e.lead_config.visible.value=t,onChange:t=>e.change=!0},null,40,pc),[[s.e8,e.lead_config.visible.value]]),(0,i._)("label",{for:t+"nb"},null,8,_c)]),(0,i._)("td",hc,[(0,i.wy)((0,i._)("input",{type:"checkbox",class:"checkbox",id:t+"n",disabled:e.lead_config.editable.disabled,"onUpdate:modelValue":t=>e.lead_config.editable.value=t,onChange:t=>e.change=!0},null,40,mc),[[s.e8,e.lead_config.editable.value]]),(0,i._)("label",{for:t+"n"},null,8,fc)]),(0,i._)("td",gc,[(0,i.wy)((0,i._)("button",{class:"del_btn",onClick:t=>r.delete_field(e.id)},null,8,vc),[[s.F8,!e.is_system]]),e.change?((0,i.wg)(),(0,i.iD)("button",{key:0,class:"btn btn_save btn_blue",onClick:e=>r.update_field(t,["name","data","lead_config"])}," Сохранить ",8,yc)):(0,i.kq)("",!0)])],2)),[[s.F8,a.selected_fields_properties.at(-1)?.id===e.category_id]]))),128)),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.new_fields,((e,t)=>((0,i.wg)(),(0,i.iD)("tr",{class:"row",key:e.id},[(0,i._)("td",wc,[(0,i.wy)((0,i._)("input",{type:"text",class:(0,n.C_)(["input new_item_input",{error:e.nameError}]),"onUpdate:modelValue":t=>e.name=t,onKeyup:(0,s.D2)((o=>r.add_new(e,t)),["enter"])},null,42,bc),[[s.nr,e.name]])]),(0,i._)("td",Cc,[(0,i.Wm)(d,{options_props:r.types,onSelect:r.option_select_new_field_type,selected_option:r.search_type(e.type),idx:t},null,8,["options_props","onSelect","selected_option","idx"]),5==a.new_fields[t].type||6==a.new_fields[t].type?((0,i.wg)(),(0,i.iD)("div",kc,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.data,((o,n)=>((0,i.wg)(),(0,i.iD)("div",{class:"type_selector_option",key:n},[(0,i.wy)((0,i._)("input",{type:"text",class:"input","onUpdate:modelValue":t=>e.data[n]=t},null,8,Dc),[[s.nr,e.data[n]]]),(0,i._)("button",{class:"del_button",onClick:e=>r.remove_new_fields_selector_option(t,n)},null,8,xc)])))),128)),(0,i._)("button",{onClick:e=>r.add_new_fields_selector_option(t),class:"add_button"},null,8,Sc)])):(0,i.kq)("",!0)]),(0,i._)("td",Ec,[(0,i.wy)((0,i._)("input",{type:"checkbox",class:"checkbox",id:t+"nb1",disabled:a.new_fields[t].disabled?.visible.value,"onUpdate:modelValue":e=>a.new_fields[t].lead_config.visible.value=e},null,8,Tc),[[s.e8,a.new_fields[t].lead_config.visible.value]]),(0,i._)("label",{for:t+"nb1"},null,8,qc)]),(0,i._)("td",Ic,[(0,i.wy)((0,i._)("input",{type:"checkbox",class:"checkbox",id:t+"n1",disabled:a.new_fields[t].disabled?.editable.value,"onUpdate:modelValue":e=>a.new_fields[t].lead_config.editable.value=e},null,8,Oc),[[s.e8,a.new_fields[t].lead_config.editable.value]]),(0,i._)("label",{for:t+"n1"},null,8,Pc)]),(0,i._)("td",$c,[(0,i._)("button",{class:"del_btn",onClick:e=>r.delete_new_field(t)},null,8,Vc),""!=e.name?((0,i.wg)(),(0,i.iD)("button",{key:0,class:"btn btn_save btn_blue",onClick:o=>r.add_new(e,t)}," Сохранить ",8,Wc)):(0,i.kq)("",!0)])])))),128))]),(0,i._)("button",{onClick:t[0]||(t[0]=e=>r.add_new_field()),class:"add_new_button"})]),(0,i._)("div",Mc,[(0,i.Wm)(c,{onClose:r.close_product_properties,show_save:!1},{close:(0,i.w5)((()=>[Fc])),_:1},8,["onClose"])])])])])}var Ac={components:{SelectorVue:_e.Z,BtnsSaveClose:he.Z},data(){return{copy_fields:[],new_fields:[],new_fields_cat:[],idx_to_delete:[],copy_fields_properties:[],selected_fields_properties:[],data_fields_properties:{items:null,selected:{name:"Выбор подкатегории",value:-1}},is_loading:!1}},async mounted(){this.is_loading=!0,await this.$store.dispatch("get_types"),await this.$store.dispatch("get_fields_properties"),this.copy_fields_properties=[...this.$store.state.categories.fields_properties],this.option_select_fields_properties({value:this.copy_fields_properties.filter((e=>0===e.parent_id))[0]}),this.get_fields(),this.is_loading=!1},computed:{types(){const e=[];return Object.entries(this.$store.state.fields.types).forEach((t=>{e.push({name:t[1],value:t[0]})})),e},properties_for_selector(){const e=[];return this.copy_fields_properties.forEach((t=>{let o="";for(let e=1;e<t.level;e++)o+="    ";e.push({name:o+t.name,value:t.id})})),e}},methods:{add_new_field(){const e={id:this.copy_fields.length+1,category_id:this.selected_fields_properties.at(-1).id,type:3,name:"",data:[],nameError:!1,lead_config:{visible:{disabled:!1,value:!1},editable:{disabled:!1,value:!1}}};this.new_fields.push(e)},async add_new(e,t){const o=(e,t)=>{let o=0;return e&&t&&(o=2),e&&!t&&(o=1),e||t||(o=0),!e&&t&&(o=-1),o},i={visible:o(e.lead_config.visible.value,e.lead_config.visible.disabled),editable:o(e.lead_config.editable.value,e.lead_config.editable.disabled)},n={type:e.type,name:e.name,category_id:e.category_id,lead_config:i,data:e.data},s=await this.$store.dispatch("update_fields",n),l="This field name exist."==s.error;l&&(this.new_fields[t]["nameError"]=!0),s.error||(this.new_fields.splice(this.new_fields.indexOf(e),1),this.get_fields())},prev_cat(e){this.selected_fields_properties.splice(e+1),this.feel_data_fields_properties(this.selected_fields_properties.at(-1).id)},feel_data_fields_properties(e){this.data_fields_properties.items=this.preparing_fields_properties(e),this.get_fields()},preparing_fields_properties(e){const t=[],o=this.copy_fields_properties.filter((t=>t.parent_id==e));return o.forEach((e=>t.push({name:e.name,value:e}))),t},option_select_fields_properties(e){const t=JSON.parse(JSON.stringify(e));this.selected_fields_properties.push(t.value),this.feel_data_fields_properties(e.value.id)},async update_field(e,t){const o={};o["id"]=this.copy_fields[e]["id"],t.forEach((t=>{o[t]=this.copy_fields[e][t]})),this.copy_fields[e]?.is_system&&delete o?.name;const i=await this.$store.dispatch("update_fields",o),n="This field name exist."==i.error;this.copy_fields[e]["nameError"]=n,i.error||(this.copy_fields[e].change=!1)},async get_fields(){this.is_loading=!0,await this.$store.dispatch("get_fields",this.selected_fields_properties.at(-1).id),this.copy_fields=[...this.$store.state.fields.fields],this.copy_fields.map((e=>{e["nameError"]=!1,e["change"]=!1;const t=e.lead_config.visible;e.lead_config.visible={disabled:-1==t||2==t,value:t>0};const o=e.lead_config.editable;e.lead_config.editable={disabled:-1==o||2==o,value:o>0}})),this.is_loading=!1},search_type(e){return this.types.filter((t=>t.value==e))[0]},delete_new_field(e){const t=this.selected_fields_properties.at(-1),o=t.fields_id.length-this.new_fields.length+e;this.new_fields.splice(e,1),this.copy_fields_properties.map((e=>e.id===t.id?e.fields_id.splice(o,1):null)),t.fields_id.splice(o,1)},delete_field(e){this.$store.dispatch("delete_field",e),this.get_fields()},option_select_type(e,t){this.copy_fields[t].type=e},option_select_new_field_type(e,t){this.new_fields[t].type=e.value},async option_select_copy_fields(e){const t=await this.$store.dispatch("get_fields_not_save",e.value),o=t.filter((e=>!e.is_system));o.forEach((async e=>{const t={id:e.id,category_id:this.selected_fields_properties.at(-1).id};await this.$store.dispatch("update_fields",t)})),this.get_fields()},add_selector_option(e){null==this.copy_fields[e].data&&(this.copy_fields[e].data=[]),this.copy_fields[e].data.push("")},remove_selector_option(e,t){this.copy_fields[e].data.splice(t,1)},add_new_fields_selector_option(e){this.new_fields[e].data.push("")},remove_new_fields_selector_option(e,t){this.new_fields[e].data.splice(t,1)},close_product_properties(){this.$store.commit("open_close_show_product_properties",!1)}}};const Uc=(0,we.Z)(Ac,[["render",Hc],["__scopeId","data-v-2e459476"]]);var Lc=Uc;const jc=e=>((0,i.dD)("data-v-b35f25b8"),e=e(),(0,i.Cn)(),e),Nc={class:"container"},Yc={class:"header"},Bc=jc((()=>(0,i._)("label",null,"Интеграции",-1))),Rc=jc((()=>(0,i._)("div",{class:"icon"},null,-1))),Zc=[Rc],zc={class:"content"},Xc={class:"item"},Kc=jc((()=>(0,i._)("div",{class:"icon"},null,-1))),Gc={key:0,href:" https://www.amocrm.ru/oauth/?state=%7B%22external_source%22:%22gosklad%22%7D&client_id=d9322b36-0001-4269-bb61-976571e8a51a",target:"blank"},Jc=jc((()=>(0,i._)("button",{class:"btn"},"Установить",-1))),Qc=[Jc],ed={key:1},td=jc((()=>(0,i._)("div",{class:"footer"},null,-1)));function od(e,t,o,n,l,a){return(0,i.wg)(),(0,i.iD)("div",{class:"wrapper",onClick:t[1]||(t[1]=(0,s.iM)((e=>a.close()),["self"]))},[(0,i._)("div",Nc,[(0,i._)("div",Yc,[Bc,(0,i._)("button",{class:"btn_del",onClick:t[0]||(t[0]=e=>a.close())},Zc)]),(0,i._)("div",zc,[(0,i._)("div",Xc,[Kc,a.oneC?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("a",Gc,Qc)),a.oneC?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("small",ed," Для интеграции с 1С-Генезис необходимо установить виджет «Генезис: 1С интеграция» "))])]),td])])}var id={computed:{oneC(){return this.$store.state.account.account?.config?.g_enabled}},methods:{close(){this.$store.commit("openCloseThirdPpartyIntegrations",!1)}}};const nd=(0,we.Z)(id,[["render",od],["__scopeId","data-v-b35f25b8"]]);var sd=nd,ld={components:{MainGrid:Do,TableSettings:el,EditStuff:Hl,NewPosition:Ia,CancelPosition:Ja,CardGrid:ti,DocumentSetting:Qa.Z,ProductCategory:Lr,ProductProperties:Lc,ThirdPpartyIntegrations:sd},provide(){return{isServicePage:(0,i.Fl)((()=>this.isServicePage))}},data(){return{filter_value:!1,paginatedData:[],paginatedParams:[],selectedWH:{name:"Все склады",value:"whs"},whs:[],grid:!1,currentItems:[],whsFull:!1}},computed:{show_modals(){return this.show_settings||this.disabled_for_modals},disabled_for_modals(){return this.show_edit_modal||this.show_table_settings||this.show_edit_stuff||this.show_product_category||this.show_product_properties||this.show_new_position||this.show_cancel_position||this.show_document_setting||this.showThirdPpartyIntegrations},isServicePage(){return"services"===this.selectedWH.value},...(0,ro.Se)(["catalog","show_edit_modal","show_settings","show_table_settings","show_buttons","show_filter","show_edit_stuff","show_sync","show_new_position","show_cancel_position","show_document_setting","show_product_category","show_product_properties","showThirdPpartyIntegrations"]),totalCountProducts(){return this.$store.state.products.meta.meta.total},oneC(){return this.$store.state.account.account?.config?.g_enabled},ref_main(){return this.$refs.main},ref_card(){return this.$refs.card}},async mounted(){await this.$store.dispatch("get_account"),this.getWHS()},watch:{filter_value(){this.$store.commit("open_close_filter",this.filter_value)},show_modals(){this.show_modals?(window.scrollBy(-99999,-99999),document.body.style.overflowX="hidden"):document.body.style.overflowX="auto"},selected_storage(){this.grid?this.ref_card.drop_page():this.ref_main.drop_page()}},methods:{clearFilters(){this.ref_main?.clearFilters()},getWHS(){this.$store.state.account.account.whs.forEach((e=>this.whs.push({name:e.name,value:e.code}))),this.whs.push({name:"Услуги",value:"services"})},selectWH(e){this.selectedWH=e},async archive_data(){const e={products:[]};this.ref_main?.selectedProducts.filter((e=>e.value))?.forEach((t=>{t.item.is_archive=1,e.products.push(t.item)})),await this.$store.dispatch("update_product",e),this.ref_main?.changePage(this.$store.state.products.meta.meta.current_page)},addCurrentProducts(){this.open_close_new_position(!0),this.currentItems=[...this.ref_main?.selectedProducts.filter((e=>e.value)).map((e=>e.item))]},dropCurrentItems(){this.currentItems=[]},open_close_new_position(e){this.$store.commit("open_close_new_position",e)},open_close_cancel_position(e){this.$store.commit("open_close_cancel_position",e)},open_close_settings(){this.$store.commit("open_close_settings")},close_settings(){this.$store.commit("close_settings")},close_sync(){this.$store.commit("close_sync")},open_close_sync(){this.$store.commit("open_close_sync")},open_edit_stuff(){this.$store.commit("open_close_show_edit_stuff",!0)},open_product_category(){this.$store.commit("open_close_product_category",!0)},openThirdPpartyIntegrations(){this.$store.commit("openCloseThirdPpartyIntegrations",!0)},open_product_properties(){this.$store.commit("open_close_show_product_properties",!0)},open_close_show_document_setting(e){this.$store.commit("open_close_show_document_setting",e)},route(e){this.$router.push("/"+e)}}};const ad=(0,we.Z)(ld,[["render",N],["__scopeId","data-v-1c1f7308"]]);var rd=ad},2262:function(e,t,o){"use strict";var i=o(2109),n=o(7908),s=o(6244),l=o(9303),a=o(1223);i({target:"Array",proto:!0},{at:function(e){var t=n(this),o=s(t),i=l(e),a=i>=0?i:o+i;return a<0||a>=o?void 0:t[a]}}),a("at")},4506:function(e,t,o){"use strict";var i=o(2109),n=o(1702),s=o(4488),l=o(9303),a=o(1340),r=o(7293),c=n("".charAt),d=r((function(){return"\ud842"!=="𠮷".at(-2)}));i({target:"String",proto:!0,forced:d},{at:function(e){var t=a(s(this)),o=t.length,i=l(e),n=i>=0?i:o+i;return n<0||n>=o?void 0:c(t,n)}})},7306:function(e,t,o){o(1703);var i,n,s=e.exports={};function l(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function r(e){if(i===setTimeout)return setTimeout(e,0);if((i===l||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}function c(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(function(){try{i="function"===typeof setTimeout?setTimeout:l}catch(e){i=l}try{n="function"===typeof clearTimeout?clearTimeout:a}catch(e){n=a}})();var d,u=[],p=!1,_=-1;function h(){p&&d&&(p=!1,d.length?u=d.concat(u):_=-1,u.length&&m())}function m(){if(!p){var e=r(h);p=!0;var t=u.length;while(t){d=u,u=[];while(++_<t)d&&d[_].run();_=-1,t=u.length}d=null,p=!1,c(e)}}function f(e,t){this.fun=e,this.array=t}function g(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];u.push(new f(e,t)),1!==u.length||p||r(m)},f.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=g,s.addListener=g,s.once=g,s.off=g,s.removeListener=g,s.removeAllListeners=g,s.emit=g,s.prependListener=g,s.prependOnceListener=g,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}}}]);
//# sourceMappingURL=126.d8b3d2f9.js.map