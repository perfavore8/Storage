"use strict";(self["webpackChunkstorage"]=self["webpackChunkstorage"]||[]).push([[804],{804:function(e,t,s){s.r(t),s.d(t,{default:function(){return ro}});var l=s(3396),i=s(9242);const a=e=>((0,l.dD)("data-v-65eed9b3"),e=e(),(0,l.Cn)(),e),o={class:"app"},n={class:"header"},r=a((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24"},[(0,l._)("path",{fill:"none",stroke:"#fff","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 18h3.75a5.25 5.25 0 1 0 0-10.5H5M7.5 4L4 7.5L7.5 11"})],-1))),d=[r],c=(0,l.Uk)(" Сохраняем "),u=a((()=>(0,l._)("span",{class:"animate-pulse ml-1"},".",-1))),p=a((()=>(0,l._)("span",{class:"animate-pulse",style:{"animation-delay":"0.667s"}},".",-1))),h=a((()=>(0,l._)("span",{class:"animate-pulse",style:{"animation-delay":"1.333s"}},".",-1))),g=(0,l.Uk)(" Сохранить "),_={class:"content mt-4"};function m(e,t,s,a,r,m){const v=(0,l.up)("AppRadioBtnsGroupUnderlined");return(0,l.wg)(),(0,l.iD)("div",o,[(0,l._)("div",n,[(0,l._)("button",{class:"bg-slate-400 bg-opacity-90 p-2 h-fit w-fit rounded-xl absolute left-0 hover:shadow-sm hover:drop-shadow-md outline-none focus-visible:drop-shadow-md",onClick:t[0]||(t[0]=e=>a.back())},d),(0,l.Wm)(i.uT,{name:"side"},{default:(0,l.w5)((()=>[a.saveParams.needSave?((0,l.wg)(),(0,l.iD)("button",{key:0,class:"absolute top-20 left-0 btn pointer-events-auto inline-flex transition-all rounded-md bg-white text-[0.8125rem] font-medium leading-5 text-slate-700 shadow-sm ring-1 ring-slate-700/10 hover:bg-slate-50 hover:text-slate-900 hover:disabled:bg-white disabled:opacity-30 disabled:cursor-not-allowed",onClick:t[1]||(t[1]=e=>a.saveParams.save())},[a.saveParams.isSaving?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[c,u,p,h],64)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[g],64))])):(0,l.kq)("",!0)])),_:1}),(0,l.Wm)(v,{class:"w-4/5",list:a.tabs.list,selected:a.tabs.selected,onSelect:t[2]||(t[2]=e=>a.tabs.select(e))},null,8,["list","selected"])]),(0,l._)("div",_,[((0,l.wg)(),(0,l.j4)(l.Ob,null,[((0,l.wg)(),(0,l.j4)((0,l.LL)(a.tabs.selected.code)))],1024))])])}var v=s(1120);const w=e=>((0,l.dD)("data-v-14c8bdc7"),e=e(),(0,l.Cn)(),e),f={class:"grid grid-cols-3 gap-10 mx-auto justify-items-start items-start w-4/5"},y={class:"w-full cont px-1"},b=w((()=>(0,l._)("h2",{class:"font-semibold text-gray-700 mb-4 w-full text-start"}," Список позиций ",-1)));function k(e,t,s,i,a,o){const n=(0,l.up)("main-page"),r=(0,l.up)("ProductsTabFields"),d=(0,l.up)("ProductsTabCastomFields");return(0,l.wg)(),(0,l.iD)("div",f,[(0,l._)("div",y,[b,(0,l.Wm)(n,{ref:"widjet"},null,512)]),(0,l.Wm)(r,{total:i.total},null,8,["total"]),(0,l.Wm)(d)])}var C=s(7139);const x=e=>((0,l.dD)("data-v-6c7c6853"),e=e(),(0,l.Cn)(),e),D={class:"app"},L={class:"container1"},P=x((()=>(0,l._)("div",{class:"header"},null,-1))),S={class:"content"},W={class:"flex flex-col"},q={class:"top"},F={class:"btns"},j=x((()=>(0,l._)("label",{for:"grid"},null,-1))),V=x((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 24 24"},[(0,l._)("path",{fill:"white",d:"M12 19q-.425 0-.713-.288T11 18v-5H6q-.425 0-.713-.288T5 12q0-.425.288-.713T6 11h5V6q0-.425.288-.713T12 5q.425 0 .713.288T13 6v5h5q.425 0 .713.288T19 12q0 .425-.288.713T18 13h-5v5q0 .425-.288.713T12 19Z"})],-1))),A=[V],I={key:0,class:"bottom"},H={class:"links"},T=["disabled","onClick"],Y={key:0,class:"spinner"},z=x((()=>(0,l._)("img",{src:"https://warehouse2.salesup.pro/images/spinner.gif",alt:"spinner"},null,-1))),Z=[z],$={class:"path"},E={class:"categories sls_grid"},O=["onClick"],U=x((()=>(0,l._)("div",{class:"name"},null,-1))),B={class:"value"},M={key:0,class:"sls_row"},N={key:1,class:"w-full h-full bg-black/30 absolute left-0 top-0 z-10"},K=["src"],R=["src"],G={class:"products sls_grid"},X={key:0,class:"text"},J=["onClick"],Q=x((()=>(0,l._)("div",{class:"bg_image"},[(0,l._)("img",{src:"https://img2.freepng.ru/20180518/rpa/kisspng-parcel-computer-icons-package-tracking-mail-5aff95be3be2a8.2770409315266994542453.jpg",class:"img"})],-1))),ee={class:"back"},te={class:"sls_row title"},se=x((()=>(0,l._)("div",{class:"name"},null,-1))),le={class:"value"},ie={class:"rows"},ae={class:"sls_row"},oe=x((()=>(0,l._)("div",{class:"name",style:{"font-weight":"500"}}," Тип : ",-1))),ne={class:"value"},re={class:"sls_row"},de={class:"name",style:{"font-weight":"500"}},ce={class:"value"},ue={class:"sls_row",style:{"margin-left":"8px"}},pe=x((()=>(0,l._)("div",{class:"name"},"НДС :",-1))),he={class:"value"},ge={class:"sls_row",style:{"margin-left":"8px"}},_e=x((()=>(0,l._)("div",{class:"name"},"НДС включен в цену :",-1))),me={class:"value"},ve={class:"sls_row"},we={class:"name",style:{"font-weight":"500"}},fe=x((()=>(0,l._)("div",{class:"value"},null,-1))),ye={class:"sls_row",style:{"margin-left":"8px"}},be=x((()=>(0,l._)("div",{class:"name"},"Свободно для резерва:",-1))),ke={class:"value"},Ce={key:2,class:"sls_row"},xe={class:"name",style:{"font-weight":"500"}},De={class:"value"},Le={key:4,class:"sls_row"},Pe={class:"name"},Se={class:"value"},We={class:"card_footer"},qe=["onUpdate:modelValue"],Fe=["onClick"],je=x((()=>(0,l._)("div",{class:"sls_row title"},[(0,l._)("div",{class:"name"}),(0,l._)("div",{class:"value"})],-1))),Ve={class:"rows"},Ae=x((()=>(0,l._)("div",{class:"name"},null,-1))),Ie=x((()=>(0,l._)("div",{class:"value"},null,-1))),He=[Ae,Ie],Te=x((()=>(0,l._)("div",{class:"card_footer"},[(0,l._)("div",{class:"sls_btn btn_green btn_del"}),(0,l._)("div",{class:"sls_btn btn_green btn_del"})],-1))),Ye=x((()=>(0,l._)("div",{class:"footer"},null,-1)));function ze(e,t,s,a,o,n){const r=(0,l.up)("ProductCard"),d=(0,l.up)("AppInputSelect"),c=(0,l.up)("AppPaginator"),u=(0,l.up)("filters-modal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",D,[(0,l._)("div",L,[P,(0,l._)("div",S,[(0,l._)("div",W,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.addedProducts,((e,t)=>((0,l.wg)(),(0,l.j4)(r,{key:e.id,fields:n.fields,copyItem:e,onChange_value:(...e)=>n.change_value(t,...e),onDel:()=>n.deleteAddedProduct(t)},null,8,["fields","copyItem","onChange_value","onDel"])))),128))]),(0,l._)("div",q,[(0,l.Wm)(d,{list:o.search.list,value:o.search.value,placeholder:"Добавление (поиск на складе по названию или артикулу)...",countLettersReq:3,disabled:n.disableAddToDeal,onChangeInputValue:n.getProductsAutocomplete,onSelect:t[0]||(t[0]=e=>n.addToLeadAutocomplete(e.id))},null,8,["list","value","placeholder","disabled","onChangeInputValue"]),(0,l._)("div",F,[(0,l.wy)((0,l._)("input",{type:"checkbox",class:"sls_checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>o.show_cards=e),id:"grid"},null,512),[[i.e8,o.show_cards]]),j,(0,l._)("div",{class:(0,C.C_)(["sls_btn",{sls_btn_disable:n.disableAddToDeal}]),id:"sls_btn_open_filter",onClick:t[2]||(t[2]=e=>n.disableAddToDeal?null:n.openModal())},A,2)])]),(0,l.Wm)(i.uT,{name:"rows"},{default:(0,l.w5)((()=>[o.show_cards?((0,l.wg)(),(0,l.iD)("div",I,[(0,l._)("div",H,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.selectedCategories,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:(0,C.C_)(["triangle",{triangle_last:!n.categories.length&&o.selectedCategories.length-1==t}]),disabled:!n.categories.length&&o.selectedCategories.length-1==t,key:e,onClick:t=>n.selectCategories(e)},(0,C.zw)(e?.name),11,T)))),128))]),o.showSpinner?((0,l.wg)(),(0,l.iD)("div",Y,Z)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[(0,l._)("div",$,[(0,l._)("div",E,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.categories,(e=>((0,l.wg)(),(0,l.iD)("div",{class:"card group/card",key:e,onClick:t=>n.selectCategories(e)},[(0,l._)("div",{class:(0,C.C_)(["sls_row title relative z-20",{"text-white":e.img_url}])},[U,(0,l._)("div",B,(0,C.zw)(e.name),1)],2),e.img_url?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",M)),e.img_url?((0,l.wg)(),(0,l.iD)("div",N)):(0,l.kq)("",!0),e.img_url?((0,l.wg)(),(0,l.iD)("img",{key:2,src:e.img_url,class:"aspect-auto w-3/4 z-[3] absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 transition-all duration-300 group-hover/card:scale-[0.6]"},null,8,K)):(0,l.kq)("",!0),e.img_url?((0,l.wg)(),(0,l.iD)("img",{key:3,src:e.img_url,class:"aspect-auto w-3/4 z-[2] blur2 absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 transition-all duration-300 group-hover/card:scale-[0.6]"},null,8,R)):(0,l.kq)("",!0)],8,O)))),128))])]),0!=n.products.length?((0,l.wg)(),(0,l.j4)(c,{key:0,class:"sls_paginator",page:n.page,onChangePage:n.changePage},null,8,["page","onChangePage"])):(0,l.kq)("",!0),(0,l._)("div",G,[0==n.products.length?((0,l.wg)(),(0,l.iD)("label",X," Ничего не найдено ")):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[o.useSkeletonCard?((0,l.wg)(!0),(0,l.iD)(l.HY,{key:1},(0,l.Ko)(n.products,(e=>((0,l.wg)(),(0,l.iD)("div",{class:"card skeleton",key:e},[je,(0,l._)("div",Ve,[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(7,(e=>(0,l._)("div",{key:e,class:"sls_row"},He))),64))]),Te])))),128)):((0,l.wg)(!0),(0,l.iD)(l.HY,{key:0},(0,l.Ko)(n.products,((e,s)=>((0,l.wg)(),(0,l.iD)("div",{class:(0,C.C_)(["card",{card__flip:o.flip[s]}]),onClick:e=>o.flip[s]=!o.flip[s],key:e},[Q,(0,l._)("div",ee,[(0,l._)("div",te,[se,(0,l._)("div",le,(0,C.zw)(e?.fields?.name),1)]),(0,l._)("div",ie,[(0,l._)("div",ae,[oe,(0,l._)("div",ne,(0,C.zw)(e.is_service?"Услуга":"Товар"),1)]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.sortedFields,(t=>((0,l.wg)(),(0,l.iD)(l.HY,{key:t},[11===t.type?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l._)("div",re,[(0,l._)("div",de,(0,C.zw)(t.name)+" : ",1),(0,l._)("div",ce,(0,C.zw)(e?.fields[t.code]?.cost?e?.fields[t.code]?.cost:(e?.fields[t.code]?.currency,e?.fields[t.code]?.currency)),1)]),e?.fields[t.code]?.is_nds?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l._)("div",ue,[pe,(0,l._)("div",he,(0,C.zw)(e?.fields[t.code]?.nds),1)]),(0,l._)("div",ge,[_e,(0,l._)("div",me,(0,C.zw)(e?.fields[t.code]?.is_price_include_nds?"Да":"Нет"),1)])],64)):(0,l.kq)("",!0)],64)):13===t.type?((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[(0,l._)("div",ve,[(0,l._)("div",we,(0,C.zw)(t.name)+": ",1),fe]),(0,l._)("div",ye,[be,(0,l._)("div",ke,(0,C.zw)(Number(e?.fields[t.code]?.count?e?.fields[t.code]?.count:0)+Number(e?.fields[t.code]?.reserve?e?.fields[t.code]?.reserve:0)),1)])],64)):12===t.type?((0,l.wg)(),(0,l.iD)("div",Ce,[(0,l._)("div",xe,(0,C.zw)(t.name)+": ",1),(0,l._)("div",De,(0,C.zw)(n.categoriesForCard?.[e?.fields?.[t.code]]),1)])):"name"===t.code?((0,l.wg)(),(0,l.iD)(l.HY,{key:3},[],64)):((0,l.wg)(),(0,l.iD)("div",Le,[(0,l._)("div",Pe,(0,C.zw)(t.name)+":",1),(0,l._)("div",Se,(0,C.zw)(e?.fields[t.code]),1)]))],64)))),128))]),(0,l._)("div",We,[e.is_service?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[o.allWhsList?.[s]?.length?(0,l.wy)(((0,l.wg)(),(0,l.iD)("input",{key:0,type:"number",class:"sls_input",style:{"min-width":"70px"},"onUpdate:modelValue":e=>o.allWhsList[s][0].specialValue=e},null,8,qe)),[[i.nr,o.allWhsList[s][0].specialValue]]):(0,l.kq)("",!0)],64)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[o.allWhsList?.[s]?.length?((0,l.wg)(),(0,l.j4)(d,{key:0,onClick:t[3]||(t[3]=(0,i.iM)((()=>{}),["stop"])),style:{"min-width":"70px",width:"100%"},list:o.allWhsList?.[s]?.filter((t=>(e.allow_add_with_zero_count||!(t.count<1))&&(!n.selectedWirePerLead.value||t.code==n.selectedWirePerLead.value))),special:!0,requestDelay:0,countLettersReq:0,allow_add_with_zero_count:e.allow_add_with_zero_count,one_wh_per_lead:e.one_wh_per_lead,placeholder:o.allWhsList?.[s]?.reduce(((e,t)=>e+Number(t?.specialValue)),0),onChangeInputValue:e=>o.inputValues[s]=e},null,8,["list","allow_add_with_zero_count","one_wh_per_lead","placeholder","onChangeInputValue"])):(0,l.kq)("",!0)],64)),(0,l._)("div",{class:(0,C.C_)(["sls_btn btn_green btn_del",{btn_del_disabled:!!n.disableAddToDeal||(e.is_service?!o.allWhsList[s][0].specialValue:0==o.allWhsList?.[s]?.reduce(((e,t)=>e+Number(t?.specialValue)),0))}]),onClick:(0,i.iM)((()=>n.disableAddToDeal?null:(e.is_service?o.allWhsList[s][0].specialValue:0!=o.allWhsList?.[s]?.reduce(((e,t)=>e+Number(t?.specialValue)),0))?n.addToLead(e.id):null),["stop"])}," Добавить к сделке ",10,Fe)])])],10,J)))),128))],64))]),0!=n.products.length?((0,l.wg)(),(0,l.j4)(c,{key:1,class:"sls_paginator",page:n.page,onChangePage:n.changePage},null,8,["page","onChangePage"])):(0,l.kq)("",!0)],64))])):(0,l.kq)("",!0)])),_:1})]),Ye])]),((0,l.wg)(),(0,l.j4)(l.lR,{to:"body"},[(0,l.Wm)(i.uT,{name:"rows"},{default:(0,l.w5)((()=>[((0,l.wg)(),(0,l.j4)(l.Ob,null,[o.show_filters?((0,l.wg)(),(0,l.j4)(u,{key:0,onClose:n.close_filters,onAccept:n.accept_filters},null,8,["onClose","onAccept"])):(0,l.kq)("",!0)],1024))])),_:1})]))],64)}const Ze=e=>((0,l.dD)("data-v-4984747c"),e=e(),(0,l.Cn)(),e),$e={class:"input-select"},Ee=Ze((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[(0,l._)("path",{fill:"#757575",d:"M8.12 9.29L12 13.17l3.88-3.88a.996.996 0 1 1 1.41 1.41l-4.59 4.59a.996.996 0 0 1-1.41 0L6.7 10.7a.996.996 0 0 1 0-1.41c.39-.38 1.03-.39 1.42 0z"})],-1))),Oe=[Ee],Ue=["disabled","placeholder"],Be={key:0,class:"list top",ref:"listRef"},Me=["onClick"],Ne=["onUpdate:modelValue"],Ke={key:0,class:"placeholder"},Re=Ze((()=>(0,l._)("div",null,[(0,l._)("div",{class:"title"}),(0,l._)("div",{class:"text"})],-1))),Ge=Ze((()=>(0,l._)("div",{class:"aside"},null,-1))),Xe=[Re,Ge];function Je(e,t,s,a,o,n){return(0,l.wg)(),(0,l.iD)("div",$e,[s.special?((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,C.C_)(["title",{title_checked:a.showList}]),onClick:t[0]||(t[0]=e=>s.disabled?null:a.openList()),ref:"title"},[(0,l._)("p",null,(0,C.zw)(s.placeholder),1),s.disabled?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,C.C_)(["arrow",{rotate_arrow:a.showList}])},Oe,2))],2)):(0,l.wy)(((0,l.wg)(),(0,l.iD)("input",{key:1,type:"text",class:(0,C.C_)(["sls_input",{input_uderline:s.input_uderline,black_text:s.SelectedInTitle&&s.selected?.name}]),"onUpdate:modelValue":t[1]||(t[1]=e=>a.inputValue=e),onClick:t[2]||(t[2]=e=>a.openList()),disabled:s.disabled,placeholder:s.SelectedInTitle&&s.selected?.name?s.selected?.name:s.placeholder,ref:"title"},null,10,Ue)),[[i.nr,a.inputValue]]),a.showList?((0,l.wg)(),(0,l.iD)(l.HY,{key:2},[(0,l._)("div",{class:"backdrop",onClick:t[3]||(t[3]=e=>a.closeList())}),(0,l.Wm)(i.W3,{name:"list"},{default:(0,l.w5)((()=>[s.list.length?((0,l.wg)(),(0,l.iD)("ul",Be,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.list,(e=>((0,l.wg)(),(0,l.iD)("li",{class:(0,C.C_)(["item",{selected:e.value===s.selected?.value}]),key:e.value,onClick:t=>a.selectItem(e)},[s.special?(0,l.wy)(((0,l.wg)(),(0,l.iD)("input",{key:0,type:"number",class:"sls_input","onUpdate:modelValue":t=>e.specialValue=t,style:{width:"100px","min-width":"1%"},placeholder:"введите кол-во",onClick:t[4]||(t[4]=(0,i.iM)((()=>{}),["stop"]))},null,8,Ne)),[[i.nr,e.specialValue]]):(0,l.kq)("",!0),(0,l.Uk)(" "+(0,C.zw)(e.name),1)],10,Me)))),128))],512)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[a.showPlaceholder?((0,l.wg)(),(0,l.iD)("div",Ke,[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(4,(e=>(0,l._)("div",{class:"item",key:e},Xe))),64))])):(0,l.kq)("",!0)],64))])),_:1})],64)):(0,l.kq)("",!0)])}var Qe=s(4870),et=s(6367);const tt={props:{list:Array,selected:{type:Object,required:!1},countLettersReq:{type:Number,required:!1,default:()=>0},requestDelay:{type:Number,required:!1,default:()=>300},placeholder:{type:String,required:!1},input_uderline:{type:Boolean,required:!1,default:()=>!1},SelectedInTitle:{type:Boolean,required:!1,default:()=>!1},special:{type:Boolean,required:!1,default:()=>!1},disabled:{type:Boolean,required:!1,default:()=>!1},allow_add_with_zero_count:{type:Boolean,required:!1,default:()=>!1},one_wh_per_lead:{type:Boolean,required:!1,default:()=>!1}},emits:["changeInputValue","focusIn","select"],setup(e,t){const s=(0,Qe.iH)(""),i=(0,Qe.iH)(null),a=(0,Qe.iH)(!1),o=()=>{a.value=!1,clearTimeout(i.value),s.value.length>=e.countLettersReq&&(a.value=!0,i.value=setTimeout((()=>{t.emit("changeInputValue",s.value),setTimeout((()=>a.value=!1),3*e.requestDelay)}),e.requestDelay))};(0,l.YP)(s,(()=>o()));const n=(0,Qe.iH)(!1),r=()=>n.value=!1,d=()=>(n.value=!0,c(),o()),c=()=>t.emit("focusIn"),u=e=>{t.emit("select",e),r(),s.value=""};e.special&&(0,l.YP)(e.list,(()=>{e.list.map((t=>{t.specialValue>t.count&&!e.allow_add_with_zero_count&&(t.specialValue=t.count),t.specialValue<0&&(t.specialValue=0)}))}),{deep:!0}),(0,l.YP)(n,(()=>{(0,l.Y3)((()=>p()))}));const p=()=>{const e=h.value?.getBoundingClientRect();v.value=window.innerHeight-e?.bottom+e?.height+6+"px",g.value=e?.width-2+"px",_.value=e?.x+"px",m.value=e?.bottom+6+"px",w.value&&(window.innerHeight-e?.bottom+e?.height+2<400?w.value.classList.contains("top")&&(w.value.classList.add("bottom"),w.value.classList.remove("top")):w.value.classList.contains("bottom")&&(w.value.classList.remove("bottom"),w.value.classList.add("top")))},h=(0,Qe.iH)(null),g=(0,Qe.iH)(null),_=(0,Qe.iH)(null),m=(0,Qe.iH)(null),v=(0,Qe.iH)(null),w=(0,Qe.iH)(null),f=(0,et.CDf)(h);return(0,l.YP)(f,(()=>{f.value?window.addEventListener("scroll",p):window.removeEventListener("scroll",p)})),{inputValue:s,showList:n,closeList:r,openList:d,selectItem:u,showPlaceholder:a,title:h,optionsWidth:g,optionsX:_,optionsY:m,optionsBottom:v,listRef:w,titleIsVisible:f}}},st=()=>{(0,i.sj)((e=>({"5f9f344a":e.optionsY,"7c0f4209":e.optionsBottom,"58cddbb0":e.optionsWidth,"5f9f344c":e.optionsX})))},lt=tt.setup;tt.setup=lt?(e,t)=>(st(),lt(e,t)):st;var it=tt,at=s(89);const ot=(0,at.Z)(it,[["render",Je],["__scopeId","data-v-4984747c"]]);var nt=ot;const rt=e=>((0,l.dD)("data-v-3c025bb8"),e=e(),(0,l.Cn)(),e),dt={class:"app_modal"},ct={class:"sls_container"},ut={class:"sls_header"},pt={class:"saved"},ht=["onClick"],gt=rt((()=>(0,l._)("path",{fill:"red",d:"M6 19a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7H6v12M8 9h8v10H8V9m7.5-5l-1-1h-5l-1 1H5v2h14V4h-3.5Z"},null,-1))),_t=[gt],mt=rt((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 15 15"},[(0,l._)("path",{fill:"currentColor","fill-rule":"evenodd",d:"M11.782 4.032a.575.575 0 1 0-.813-.814L7.5 6.687L4.032 3.218a.575.575 0 0 0-.814.814L6.687 7.5l-3.469 3.468a.575.575 0 0 0 .814.814L7.5 8.313l3.469 3.469a.575.575 0 0 0 .813-.814L8.313 7.5l3.469-3.468Z","clip-rule":"evenodd"})],-1))),vt=[mt],wt={class:"sls_content"};function ft(e,t,s,i,a,o){const n=(0,l.up)("main-grid");return(0,l.wg)(),(0,l.iD)("div",dt,[(0,l._)("div",{class:"sls_backdrop_with_filter",onClick:t[0]||(t[0]=e=>i.close())}),(0,l._)("div",ct,[(0,l._)("div",ut,[(0,l._)("div",pt,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(i.savedAllWhsList,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{key:e,class:"item"},[(0,l.Uk)((0,C.zw)(e[0].product_name)+" : "+(0,C.zw)(e.reduce(((e,t)=>e+Number(t.specialValue)),0))+" ",1),((0,l.wg)(),(0,l.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",onClick:e=>i.deleteSavedAllWhsList(t)},_t,8,ht))])))),128))]),i.savedAllWhsList.length?((0,l.wg)(),(0,l.iD)("button",{key:0,class:"sls_btn btn2",onClick:t[1]||(t[1]=e=>i.accepMainGridRef())}," Добавить к сделке ")):(0,l.kq)("",!0),(0,l._)("button",{class:"exit",onClick:t[2]||(t[2]=e=>i.close())},vt)]),(0,l._)("div",wt,[((0,l.wg)(),(0,l.j4)(l.Ob,null,[(0,l.Wm)(n,{onChangeSavedAllWhsList:i.changeSavedAllWhsList,onAccept:i.accept,class:"main_grid",ref:"mainGridRef"},null,8,["onChangeSavedAllWhsList","onAccept"])],1024))])])])}const yt=e=>((0,l.dD)("data-v-6763ba33"),e=e(),(0,l.Cn)(),e),bt={key:0,class:"wrapper"},kt={class:"main"},Ct={class:"table",ref:"table"},xt={key:0,class:"spinner"},Dt=yt((()=>(0,l._)("img",{src:"https://warehouse2.salesup.pro/images/spinner.gif",alt:"spinner"},null,-1))),Lt=[Dt],Pt={key:0},St={class:"item"},Wt={key:0},qt=["onUpdate:modelValue"],Ft={key:1},jt={key:0},Vt={key:1},At={key:0,class:"text"},It={class:"right"};function Ht(e,t,s,a,o,n){const r=(0,l.up)("TableSettings"),d=(0,l.up)("MainGridFilters"),c=(0,l.up)("main-grid-bar"),u=(0,l.up)("AppInputSelect"),p=(0,l.up)("grid-bottom");return(0,l.wg)(),(0,l.iD)(l.HY,null,[((0,l.wg)(),(0,l.j4)(l.lR,{to:"body"},[(0,l.Wm)(i.uT,{name:"modal"},{default:(0,l.w5)((()=>[n.showTableSettings?((0,l.wg)(),(0,l.j4)(r,{key:0,onClose:n.closeTableSettings},null,8,["onClose"])):(0,l.kq)("",!0)])),_:1})])),o.isLoading?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",bt,[n.all_fields.length&&n.tableConfig!={}&&n.sortedFields.length?((0,l.wg)(),(0,l.j4)(d,{key:0,ref:"filters",fields:n.all_fields,tableConfig:n.tableConfig,sortedFields:n.sortedFields2,onConfirm:t[0]||(t[0]=()=>n.get_products(n.productsParams))},null,8,["fields","tableConfig","sortedFields"])):(0,l.kq)("",!0),(0,l._)("div",kt,[(0,l._)("table",Ct,[(0,l._)("thead",null,[(0,l.Wm)(c,{ref:"bar",fields:n.all_fields,onSort:n.sort,tableConfig:n.tableConfig,sortedFields:n.sortedFields,class:"main-grid-bar"},null,8,["fields","onSort","tableConfig","sortedFields"])]),o.showSpinner?((0,l.wg)(),(0,l.iD)("div",xt,Lt)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[n.products.length?((0,l.wg)(),(0,l.iD)("tbody",Pt,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.products,((e,t)=>((0,l.wg)(),(0,l.iD)("tr",{class:"row",key:e.id},[(0,l._)("td",St,[e.is_service?((0,l.wg)(),(0,l.iD)("div",Wt,[o.allWhsList?.[t]?.length?(0,l.wy)(((0,l.wg)(),(0,l.iD)("input",{key:0,type:"number",class:"sls_input",style:{"min-width":"70px"},"onUpdate:modelValue":e=>o.allWhsList[t][0].specialValue=e},null,8,qt)),[[i.nr,o.allWhsList[t][0].specialValue]]):(0,l.kq)("",!0)])):((0,l.wg)(),(0,l.iD)("div",Ft,[(0,l.Wm)(u,{style:{"min-width":"70px"},list:o.allWhsList?.[t]?.filter((t=>(e.allow_add_with_zero_count||!(t?.count<1))&&(!n.selectedWirePerLead.value||t.code==n.selectedWirePerLead.value))),special:!0,requestDelay:0,countLettersReq:0,allow_add_with_zero_count:e.allow_add_with_zero_count,one_wh_per_lead:e.one_wh_per_lead,placeholder:o.allWhsList?.[t]?.reduce(((e,t)=>e+Number(t?.specialValue)),0),onChangeInputValue:e=>o.inputValues[t]=e},null,8,["list","allow_add_with_zero_count","one_wh_per_lead","placeholder","onChangeInputValue"])]))]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.sortedFields,(t=>((0,l.wg)(),(0,l.iD)("td",{key:t,class:"item"},[t[0].split(".").length<2?((0,l.wg)(),(0,l.iD)("span",jt,(0,C.zw)("free_4_reserve"===t[0]&&-1==e.fields[t[0]]?"∞":"category"==t[0]?n.categories?.[e.fields?.[t?.[0]]]:9==t?.[1]?.type?e.fields?.[t[0]]?"Да":"Нет":"cost_price"==t[0]?e.fields?.[t[0]]?Math.round(100*e.fields?.[t[0]])/100:"0":e.fields?.[t[0]]),1)):((0,l.wg)(),(0,l.iD)("span",Vt,(0,C.zw)("cost"==t[0].split(".")[1]?void 0==e.fields?.[t[0].split(".")[0]]?.[t[0]?.split(".")?.[1]]?"0":e.fields?.[t[0]?.split(".")?.[0]]?.[t[0]?.split(".")?.[1]]+" "+(void 0==e.fields?.[t[0]?.split(".")?.[0]]?.currency||null==e.fields?.[t[0]?.split(".")?.[0]]?.currency?"":e.fields?.[t[0]?.split(".")?.[0]]?.currency):9==t[1].type?e.fields?.[t[0]?.split(".")?.[0]]?.[t[0]?.split(".")?.[1]]?"Да":"Нет":e.fields?.[t[0]?.split(".")?.[0]]?.[t[0]?.split(".")?.[1]]),1))])))),128))])))),128))])):(0,l.kq)("",!0)],64))],512),0==n.products.length?((0,l.wg)(),(0,l.iD)("label",At," Ничего не найдено ")):(0,l.kq)("",!0)]),(0,l._)("div",It,[(0,l.Wm)(p,{page:n.page,blur:e.show_edit_modal,show:0!=n.products.length,count:n.count,onChangePage:n.changePage,onChangeCount:n.changeCount},null,8,["page","blur","show","count","onChangePage","onChangeCount"])])]))],64)}const Tt=e=>((0,l.dD)("data-v-01bb50b0"),e=e(),(0,l.Cn)(),e),Yt={class:"modal"},zt={class:"wrapper"},Zt=Tt((()=>(0,l._)("div",{class:"modal-header"},[(0,l._)("div",{class:"head-text"},"Настройка таблицы")],-1))),$t={class:"modal-body"},Et=Tt((()=>(0,l._)("div",{class:"text"},[(0,l._)("small",{class:"small-text"},"Перетаскивайте колонки для изменения очередности")],-1))),Ot=["onUpdate:modelValue","id","disabled"],Ut=["for"],Bt={class:"modal-footer"};function Mt(e,t,s,a,o,n){const r=(0,l.up)("draggable"),d=(0,l.up)("btns-save-close");return(0,l.wg)(),(0,l.iD)("div",Yt,[(0,l._)("div",{class:"backdrop_with_filter sls_backdrop_with_filter",onClick:t[0]||(t[0]=e=>n.close())}),(0,l._)("div",zt,[Zt,(0,l._)("div",$t,[Et,(0,l.Wm)(r,{class:"dragArea",list:o.list,onChange:e.changeData},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.list,(e=>((0,l.wg)(),(0,l.iD)("div",{class:"item",key:e},[(0,l.wy)((0,l._)("input",{type:"checkbox","onUpdate:modelValue":t=>e.visible=t,id:e.code,class:"checkbox",disabled:2===e.visible||-1===e.visible},null,8,Ot),[[i.e8,e.visible]]),(0,l._)("label",{for:e.code},null,8,Ut),(0,l.Uk)(" "+(0,C.zw)(e.name),1)])))),128))])),_:1},8,["list","onChange"])]),(0,l._)("div",Bt,[(0,l.Wm)(d,{onClose:n.close,onSave:n.save},null,8,["onClose","onSave"])])])])}var Nt=s(4038),Kt=s(8249),Rt={components:{draggable:Kt.J,BtnsSaveClose:Nt.Z},props:{},emits:{},data(){return{list:[]}},computed:{tableConfig(){return this.$store.state.widjetFields.tableConfig}},async mounted(){await this.$store.dispatch("getTableConfigW",{code:"widget"});const e=[];Object.entries(this.tableConfig).map((t=>{t[1].code=t[0],e.push(t[1])})),this.list=JSON.parse(JSON.stringify(e)),this.list.map((e=>{1===e.visible&&(e.visible=!0),0===e.visible&&(e.visible=!1)}))},methods:{async save(){this.list.map(((e,t)=>e.sort=t+1));const e={config:[],code:"widget"};this.list.forEach((t=>{t.visible&&e.config.push(t.code)})),await this.$store.dispatch("updateTableConfigW",e),this.close()},close(){this.$emit("close"),this.$store.commit("toggleShowTableSettings",!1)}}};const Gt=(0,at.Z)(Rt,[["render",Mt],["__scopeId","data-v-01bb50b0"]]);var Xt=Gt;const Jt=e=>((0,l.dD)("data-v-2e8e577a"),e=e(),(0,l.Cn)(),e),Qt={class:"wrapper"},es={class:"filters"},ts={class:"item"},ss={key:0,class:"item"},ls={class:"title"},is=["onClick"],as=Jt((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 15 15"},[(0,l._)("path",{fill:"currentColor","fill-rule":"evenodd",d:"M11.782 4.032a.575.575 0 1 0-.813-.814L7.5 6.687L4.032 3.218a.575.575 0 0 0-.814.814L6.687 7.5l-3.469 3.468a.575.575 0 0 0 .814.814L7.5 8.313l3.469 3.469a.575.575 0 0 0 .813-.814L8.313 7.5l3.469-3.468Z","clip-rule":"evenodd"})],-1))),os=[as],ns={class:"accept_btn"};function rs(e,t,s,i,a,o){const n=(0,l.up)("selector-vue"),r=(0,l.up)("filter-number"),d=(0,l.up)("filter-text"),c=(0,l.up)("filter-list"),u=(0,l.up)("filter-date"),p=(0,l.up)("filter-flag");return(0,l.wg)(),(0,l.iD)("div",Qt,[(0,l._)("div",es,[(0,l._)("div",ts,[(0,l.Wm)(n,{options_props:o.filteredFiltersValue,selected_option:{name:"Добавить фильтр",value:-1},onSelect:o.add_filter},null,8,["options_props","onSelect"])]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.filtersValue,((e,t)=>((0,l.wg)(),(0,l.iD)(l.HY,{key:t},[e.selected?((0,l.wg)(),(0,l.iD)("div",ss,[(0,l._)("div",ls,(0,C.zw)(e.name),1),1==e.type||2==e.type?((0,l.wg)(),(0,l.j4)(r,{key:0,item:e,idx:t,onChange_filter_value:o.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,l.kq)("",!0),3==e.type||4==e.type?((0,l.wg)(),(0,l.j4)(d,{key:1,item:e,idx:t,onChange_filter_value:o.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,l.kq)("",!0),5==e.type||6==e.type?((0,l.wg)(),(0,l.j4)(c,{key:2,item:e,idx:t,selector_options:e.selector_options,onChange_filter_value:o.change_filter_value},null,8,["item","idx","selector_options","onChange_filter_value"])):(0,l.kq)("",!0),12==e.type?((0,l.wg)(),(0,l.j4)(c,{key:3,item:e,idx:t,selector_options:a.categories_options,onChange_filter_value:o.change_filter_value},null,8,["item","idx","selector_options","onChange_filter_value"])):(0,l.kq)("",!0),7==e.type||8==e.type?((0,l.wg)(),(0,l.j4)(u,{key:4,item:e,idx:t,onChange_filter_value:o.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,l.kq)("",!0),9==e.type?((0,l.wg)(),(0,l.j4)(p,{key:5,item:e,idx:t,onChange_filter_value:o.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,l.kq)("",!0),(0,l._)("button",{class:"sls_remove",onClick:t=>o.remove_filter(e)},os,8,is)])):(0,l.kq)("",!0)],64)))),128))]),(0,l._)("div",ns,[(0,l._)("button",{onClick:t[0]||(t[0]=e=>o.confirmFilters()),class:"btn2 sls_btn"},"Применить"),(0,l._)("button",{onClick:t[1]||(t[1]=e=>o.clearFilters()),class:"btn1 sls_btn"},"Очистить")])])}const ds={class:"filter"};function cs(e,t,s,a,o,n){return(0,l.wg)(),(0,l.iD)("div",ds,[(0,l._)("button",{onClick:t[0]||(t[0]=e=>4==o.option?o.option=0:o.option+=1)},[(0,l._)("span",{class:(0,C.C_)({big:0==o.option})},(0,C.zw)(o.options[o.option]),3)]),(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.filterValue=e),type:"number"},null,512),[[i.nr,o.filterValue]])])}var us={props:{item:{type:Object,required:!0},idx:{type:Number,required:!0}},data(){return{option:0,filterValue:null,options:["=",">",">=","<","<="]}},computed:{option_value(){return{option:this.options[this.option],value:this.filterValue}}},watch:{option_value:{handler(){this.emit_value()},deep:!0},item(){this.change_value()}},mounted(){this.change_value()},methods:{change_value(){(0,l.Y3)((()=>{this.filterValue=this.item.value,null==this.item.value&&(this.option=0)}))},emit_value(){this.$emit("change_filter_value",this.option_value,this.idx)}}};const ps=(0,at.Z)(us,[["render",cs],["__scopeId","data-v-ab8c92a8"]]);var hs=ps;const gs={class:"filter"};function _s(e,t,s,a,o,n){return(0,l.wg)(),(0,l.iD)("div",gs,[(0,l._)("button",{onClick:t[0]||(t[0]=e=>1==o.option?o.option=0:o.option+=1)},[(0,l._)("span",null,(0,C.zw)(o.options[o.option]),1)]),(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.filterValue=e),type:"text"},null,512),[[i.nr,o.filterValue]])])}var ms={props:{item:{type:Object,required:!0},idx:{type:Number,required:!0}},data(){return{option:0,filterValue:null,options:["=","~"]}},computed:{option_value(){return{option:this.options[this.option],value:this.filterValue}}},watch:{option_value:{handler(){this.emit_value()},deep:!0},item(){this.change_value()}},mounted(){this.change_value()},methods:{change_value(){(0,l.Y3)((()=>{this.filterValue=this.item.value,null==this.item.value&&(this.option=0)}))},emit_value(){this.$emit("change_filter_value",this.option_value,this.idx)}}};const vs=(0,at.Z)(ms,[["render",_s],["__scopeId","data-v-af2e967c"]]);var ws=vs;const fs=e=>((0,l.dD)("data-v-69ef1a12"),e=e(),(0,l.Cn)(),e),ys={class:"filter"},bs=fs((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[(0,l._)("path",{fill:"#757575",d:"M8.12 9.29L12 13.17l3.88-3.88a.996.996 0 1 1 1.41 1.41l-4.59 4.59a.996.996 0 0 1-1.41 0L6.7 10.7a.996.996 0 0 1 0-1.41c.39-.38 1.03-.39 1.42 0z"})],-1))),ks=[bs];function Cs(e,t,s,i,a,o){const n=(0,l.up)("multi-selector");return(0,l.wg)(),(0,l.iD)("div",ys,[(0,l._)("button",{onClick:t[0]||(t[0]=e=>o.open_selector())},[(0,l._)("div",{class:(0,C.C_)(["arrow",{rotate_arrow:a.show_selector}])},ks,2)]),a.show_selector?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l._)("div",{class:"backdrop",onClick:t[1]||(t[1]=e=>o.closeSelector())}),(0,l.Wm)(n,{class:"selector",id:"selector123",options_props:[{name:"Все",value:""},...s.selector_options],onSelect:o.option_select_multi,selected_options:a.filterValue,tabindex:"1"},null,8,["options_props","onSelect","selected_options"])],64)):(0,l.kq)("",!0)])}const xs={class:"multi_selector"},Ds=["onClick"];function Ls(e,t,s,i,a,o){return(0,l.wg)(),(0,l.iD)("div",xs,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.options_props,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:(0,C.C_)(["item",{selected:s.selected_options[t],disabled:s.disabled}]),key:e.value,onClick:e=>i.select(t)},(0,C.zw)(e.name),11,Ds)))),128))])}var Ps={name:"MultiSelector",props:{options_props:{type:Array,required:!0,default(){return[]}},selected_options:{type:Array,required:!0,default(){return[!0]}},disabled:{type:Boolean,required:!1,default(){return!1}}},emits:{select:null},setup(e,{emit:t}){const s=(0,Qe.iH)([]);(0,l.bv)((()=>s.value=[...e.selected_options])),(0,l.YP)((()=>e.selected_options),(()=>{s.value=[...e.selected_options]}),{deep:!0});const i=l=>{e.disabled||(0==l&&(s.value=[]),1==s.value[0]&&(s.value[0]=!1),s.value[l]=!s.value[l],s.value.includes(!0)||(s.value[0]=!0),t("select",s.value))};return{options_value:s,select:i}}};const Ss=(0,at.Z)(Ps,[["render",Ls],["__scopeId","data-v-0c74e135"]]);var Ws=Ss,qs={components:{MultiSelector:Ws},props:{item:{type:Object,required:!0},idx:{type:Number,required:!0},selector_options:{type:Array,required:!0}},data(){return{filterValue:[],show_selector:!1}},computed:{option_value(){return{value:this.filterValue}}},watch:{option_value:{handler(){this.emit_value()},deep:!0},item(){this.change_value()}},mounted(){this.change_value()},methods:{change_value(){(0,l.Y3)((()=>{this.filterValue=[!1],this.item.value.forEach(((e,t)=>{this.filterValue[t+1]=e}))}))},emit_value(){const e={value:[]},t=[{name:"Все",value:""},...this.selector_options];this.option_value.value.forEach(((s,l)=>s?12==this.item.type?e.value.push(t[l]?.value):e.value.push(t[l]?.name):null)),this.$emit("change_filter_value",e,this.idx)},option_select_multi(e){this.filterValue=e},open_selector(){this.show_selector=!0,(0,l.Y3)((()=>{this.show_selector&&document.getElementById("selector123").focus()}))},handleFocusOut(){setTimeout((()=>{(0,l.Y3)((()=>{this.show_selector=!1}))}),150)},closeSelector(){this.show_selector=!1}}};const Fs=(0,at.Z)(qs,[["render",Cs],["__scopeId","data-v-69ef1a12"]]);var js=Fs;const Vs={key:0,class:"filter"},As={key:1,class:"filter"};function Is(e,t,s,a,o,n){return(0,l.wg)(),(0,l.iD)(l.HY,null,[7==s.item.type?((0,l.wg)(),(0,l.iD)("div",Vs,[(0,l.wy)((0,l._)("input",{type:"date","onUpdate:modelValue":t[0]||(t[0]=e=>a.date_start=e)},null,512),[[i.nr,a.date_start]]),(0,l.wy)((0,l._)("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=e=>a.date_end=e)},null,512),[[i.nr,a.date_end]])])):(0,l.kq)("",!0),8==s.item.type?((0,l.wg)(),(0,l.iD)("div",As,[(0,l.wy)((0,l._)("input",{type:"datetime-local","onUpdate:modelValue":t[2]||(t[2]=e=>a.date_start=e)},null,512),[[i.nr,a.date_start]]),(0,l.wy)((0,l._)("input",{type:"datetime-local","onUpdate:modelValue":t[3]||(t[3]=e=>a.date_end=e)},null,512),[[i.nr,a.date_end]])])):(0,l.kq)("",!0)],64)}var Hs={props:{item:{type:Object,required:!0},idx:{type:Number,required:!0}},emits:{change_filter_value:null},setup(e,{emit:t}){const s=(0,Qe.iH)(""),i=(0,Qe.iH)(""),a=(0,l.Fl)((()=>({value:`${s.value}~${i.value}`})));function o(){t("change_filter_value",a.value,e.idx)}function n(){if(e.item.value){const[t,l]=e.item.value.split("~");s.value=t,i.value=l}else s.value="",i.value=""}return(0,l.bv)((()=>{(0,l.Y3)((()=>{n()}))})),(0,l.YP)((()=>e.item.value),(()=>{n()})),(0,l.YP)(a,(()=>o())),{date_start:s,date_end:i,emit_value:o}}};const Ts=(0,at.Z)(Hs,[["render",Is],["__scopeId","data-v-63272124"]]);var Ys=Ts;const zs={class:"filter"};function Zs(e,t,s,i,a,o){const n=(0,l.up)("selector-vue");return(0,l.wg)(),(0,l.iD)("div",zs,[(0,l.Wm)(n,{options_props:i.options,onSelect:i.option_select,selected_option:i.options[i.filterValue-1]},null,8,["options_props","onSelect","selected_option"])])}const $s=e=>((0,l.dD)("data-v-0a28a4c8"),e=e(),(0,l.Cn)(),e),Es={class:"v-select"},Os=$s((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[(0,l._)("path",{fill:"#757575",d:"M8.12 9.29L12 13.17l3.88-3.88a.996.996 0 1 1 1.41 1.41l-4.59 4.59a.996.996 0 0 1-1.41 0L6.7 10.7a.996.996 0 0 1 0-1.41c.39-.38 1.03-.39 1.42 0z"})],-1))),Us=[Os],Bs={class:"options",key:"a1"},Ms=["onClick"],Ns={key:0,class:"material-icons-outlined opacity-50"};function Ks(e,t,s,a,o,n){return(0,l.wg)(),(0,l.iD)("div",Es,[(0,l._)("div",{class:(0,C.C_)(["title",{title_checked:a.show_options,disabled:s.disabled}]),onClick:t[0]||(t[0]=e=>a.open_close_options()),onFocusout:t[1]||(t[1]=(...e)=>a.handleFocusOut&&a.handleFocusOut(...e)),tabindex:"0"},[(0,l._)("p",null,(0,C.zw)(s.selected_option.name),1),s.disabled?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,C.C_)(["arrow",{rotate_arrow:a.show_options}])},Us,2))],34),(0,l.Wm)(i.uT,{name:"list"},{default:(0,l.w5)((()=>[a.show_options?((0,l.wg)(),(0,l.iD)("div",Bs,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.options,(e=>((0,l.wg)(),(0,l.iD)("p",{key:e.value,class:(0,C.C_)({optgroup:"optgroup"===e.value,selected:e.value==s.selected_option.value}),style:(0,C.j5)({backgroundColor:e.color}),onClick:t=>a.select_option(e)},[e.value==s.selected_option.value&&e.color?((0,l.wg)(),(0,l.iD)("span",Ns," check ")):(0,l.kq)("",!0),e.optgroup?((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[(0,l.Uk)("     "+(0,C.zw)(e.name),1)],64)):((0,l.wg)(),(0,l.iD)(l.HY,{key:2},[(0,l.Uk)((0,C.zw)(e.name),1)],64))],14,Ms)))),128))])):(0,l.kq)("",!0)])),_:1})])}var Rs={props:{options_props:{type:Array,default(){return[]},required:!0},selected_option:{type:Object,required:!0,default(){return{}}},disabled:{type:Boolean,required:!1,default:!1},idx:{type:Number,required:!1}},emits:{select:null},setup(e,{emit:t}){const s=(0,Qe.iH)([]);(0,l.bv)((()=>{(0,l.Y3)((()=>{i()}))}));const i=()=>{s.value=[],e.options_props?.forEach((e=>s.value.push(e)))};(0,l.YP)((()=>e.options_props),(()=>{i()}),{deep:!0});const a=(0,Qe.iH)(!1),o=()=>{a.value=!1},n=()=>{e.disabled||(a.value=!a.value)},r=()=>{o()},d=s=>{"optgroup"!=s.value&&(t("select",s,e.idx),o())};return{open_close_options:n,handleFocusOut:r,show_options:a,options:s,select_option:d}}};const Gs=(0,at.Z)(Rs,[["render",Ks],["__scopeId","data-v-0a28a4c8"]]);var Xs=Gs,Js={components:{SelectorVue:Xs},props:{item:{type:Object,required:!0},idx:{type:Number,required:!0}},setup(e,{emit:t}){const s=(0,Qe.iH)([{name:"Все",value:1},{name:"Да",value:2},{name:"Нет",value:3}]),i=(0,Qe.iH)(1),a=(0,l.Fl)((()=>({value:i.value})));(0,l.YP)(a,(()=>{t("change_filter_value",a.value,e.idx)}),{deep:!0});const o=()=>{(0,l.Y3)((()=>{i.value=e.item.value}))},n=e=>{i.value=e.value};return(0,l.YP)((()=>e.item),o),o(),{options:s,filterValue:i,option_value:a,option_select:n}}};const Qs=(0,at.Z)(Js,[["render",Zs],["__scopeId","data-v-20ad93b4"]]);var el=Qs,tl={props:{fields:{type:Array,required:!0,default(){return[]}},sortedFields:{type:Array,required:!0,default(){return[]}},tableConfig:{type:Object}},components:{FilterNumber:hs,FilterText:ws,FilterList:js,FilterDate:Ys,FilterFlag:el,SelectorVue:Xs},data(){return{filtersValue:[],categories_options:[],isConfirmFilters:!1,filter:{}}},computed:{productsParams(){return this.$store.state.widjetProducts.productsParams},filteredFiltersValue(){return this.filtersValue.filter((e=>!e.selected))}},async mounted(){Promise.all([this.$store.dispatch("get_fields_propertiesW"),this.$store.dispatch("get_fields_properties2W")]),this.get_categories_options(),this.feelFilters()},watch:{sortedFields:{handler:function(){this.feelFilters()},deep:!0}},methods:{add_filter(e){e.selected=!0},remove_filter(e){e.selected=!1;let t=null;5!=e.type&&6!=e.type||(t=[]),9==e.type&&(t=1),12==e.type&&(t=[]),e.value=t,this.confirmFilters()},searchTitle(e){let t="";const[s,l]=e.split(".");return t=this.fields.find((e=>e.code===s))?.name,"count"===l&&(t+=": на складе"),"reserve"===l&&(t+=": в резерве"),"is_nds"===l&&(t+=": с НДС"),"is_price_include_nds"===l&&(t+=": НДС включен в цену"),"nds"===l&&(t+=": НДС %"),t},clearFilters(){this.feelFilters(),this.confirmFilters()},confirmFilters(){this.isConfirmFilters=!0;const e={};this.filtersValue.filter((e=>null!=e.value&&""!==e.value&&e.selected)).forEach((t=>{if(1!=t.type&&2!=t.type||(e[t.code]={compare:t.option,query:t.value}),3!=t.type&&4!=t.type||(e[t.code]={compare:t.option,query:t.value}),5!=t.type&&6!=t.type&&12!=t.type||t.value?.length&&(e[t.code]={compare:"in",query:t.value}),7==t.type){const s=t.value.split("~");s.forEach(((e,t)=>s[t]=e.split("-").join("."))),e[t.code]={from:s[0],to:s[1]}}if(8==t.type){const s=t.value.split("~");s.forEach(((e,t)=>{const l=e.split("T");l[0]=l[0].split("-").join("."),s[t]=l.join(" ")})),e[t.code]={from:s[0],to:s[1]}}})),this.filter=e,this.$store.commit("updateProductsParams",{filter:e,page:1}),this.$emit("confirm")},change_filter_value(e,t){Object.assign(this.filtersValue[t],e)},setFalseIsConfirmFilters(){this.isConfirmFilters=!1},setTrueIsConfirmFilters(){this.isConfirmFilters=!0},feelFilters(){this.filtersValue=[];const e=[];this.sortedFields.forEach((t=>{let s={};s={...this.fields.filter((e=>e.code.split(".")[0]==t[0].split(".")[0]))[0]},s.type=t[1].type,s.code=t[0],e.push(s)})),e.forEach((e=>{const t=e=>{const t=[];return null!=e&&e.forEach(((e,s)=>t.push({name:e,value:s}))),t};let s=null;5!=e.type&&6!=e.type||(s=[]),9==e.type&&(s=1),12==e.type&&(s=[]);const l={type:e.type,code:e.code,option:"=",selector_options:t(e.data),value:s,table_config:e.table_config,selected:!1,name:this.searchTitle(e.code)};this.filtersValue.push(l)}));const t={type:9,code:"isAvailable",option:"=",selector_options:[],value:1,table_config:{filtered:1,sort:2,sortable:1,visible:1},selected:!1,name:"Есть в наличии"};this.filtersValue.push(t)},get_categories_options(){this.$store.state.widjetCategories.fields_properties2.forEach((e=>{let t="";for(let s=1;s<e.level;s++)t+="-    ";this.categories_options.push({name:t+e.name,value:e.id})}))}}};const sl=(0,at.Z)(tl,[["render",rs],["__scopeId","data-v-2e8e577a"]]);var ll=sl;const il=e=>((0,l.dD)("data-v-dc235b08"),e=e(),(0,l.Cn)(),e),al={class:"bar_row"},ol={class:"bar_item item"},nl=il((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 512 512"},[(0,l._)("path",{fill:"#757575",d:"M495.9 166.6c3.2 8.7.5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4l-55.6 17.8c-8.8 2.8-18.6.3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4c-1.1-8.4-1.7-16.9-1.7-25.5s.6-17.1 1.7-25.4l-43.3-39.4c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160a80 80 0 1 0 0 160z"})],-1))),rl=[nl],dl=["onClick"],cl={class:"bar_item_group"},ul={key:0,class:"bar_item_icon"},pl={key:0,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},hl=il((()=>(0,l._)("path",{fill:"none",stroke:"#757575","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 5v14m4-10l-4-4M8 9l4-4"},null,-1))),gl=[hl],_l={key:1,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},ml=il((()=>(0,l._)("path",{fill:"none",stroke:"#757575","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 5v14m4-4l-4 4m-4-4l4 4"},null,-1))),vl=[ml],wl={key:2,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},fl=il((()=>(0,l._)("path",{fill:"none",stroke:"#757575","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m11 16l-3 3m0 0l-3-3m3 3V5m5 3l3-3m0 0l3 3m-3-3v14"},null,-1))),yl=[fl];function bl(e,t,s,i,a,o){return(0,l.wg)(),(0,l.iD)("tr",al,[(0,l._)("th",ol,[(0,l._)("div",{onClick:t[0]||(t[0]=e=>o.openTableSettings()),class:"tableSettings"},rl)]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.sortedFields,((e,t)=>((0,l.wg)(),(0,l.iD)("th",{class:"bar_item item",style:(0,C.j5)({minWidth:0!=o.width[t]?o.width[t]+"px":(o.collsCount>=8||o.collsCount,100/o.collsCount+"%")}),onClick:t=>e[1].sortable&&9!=e[1].type?o.sort(e[0]):null,key:e},[(0,l._)("div",cl,[(0,l._)("label",null,(0,C.zw)(e[1].name),1),e[1].sortable&&9!=e[1].type?((0,l.wg)(),(0,l.iD)("button",ul,[a.order.code===e[0]&&"desc"===a.order.prev_order?((0,l.wg)(),(0,l.iD)("svg",pl,gl)):a.order.code===e[0]&&"asc"===a.order.prev_order?((0,l.wg)(),(0,l.iD)("svg",_l,vl)):((0,l.wg)(),(0,l.iD)("svg",wl,yl))])):(0,l.kq)("",!0)])],12,dl)))),128))])}var kl=s(65),Cl={props:{fields:{type:Array,required:!0,default(){return[]}},sortedFields:{type:Array,required:!0,default(){return[]}},tableConfig:{type:Object}},data(){return{order:{code:"",prev_order:""},disableExportXlsx:!1,allSelectedProducts:!1}},computed:{...(0,kl.Se)(["fields"]),collsCount(){return this.tableConfig.length},productsParams(){return this.$store.state.widjetProducts.productsParams},width(){let e=[];return this.fields.forEach((t=>{let s=0;9==t.type&&(s=90),7!=t.type&&8!=t.type||(s=150),e.push(s)})),e}},methods:{isShow(e){let t=!1;return Object.entries(this.tableConfig).forEach((s=>{s[0].split(".")[0]==e&&s[1]?.visible&&(t=!0)})),t},dropOrder(){this.order={code:"",prev_order:""}},sort(e){const t=["asc","desc"];let s="";s=this.order.code===e&&this.order.prev_order==t[0]?t[1]:t[0],this.order={code:e,prev_order:s},e.split(".").length>1&&(e=e.split(".").join("->")),this.$emit("sort",e,s)},async exportXlsx(){this.disableExportXlsx=!0,this.$store.commit("openCloseTaskCenter",!0),setTimeout((()=>{this.$store.commit("openCloseTaskCenter",!1)}),5e3);const{sort:e,filter:t}=this.productsParams,s=[];Object.entries(this.tableConfig).filter((e=>e[1].visible)).sort(((e,t)=>e[1].sort>t[1].sort?1:e[1].sort==t[1].sort?0:e[1].sort<t[1].sort?-1:void 0)).forEach((e=>s.push(e[0])));const l={sort:e,filter:t,config:s};this.$store.dispatch("exportXlsx",l)},changeAllSelectedProducts(){this.$emit("changeAllSelectedProducts",this.allSelectedProducts)},dropAllSelectedProducts(){this.allSelectedProducts=!1},openTableSettings(){this.$store.commit("toggleShowTableSettings",!0)}}};const xl=(0,at.Z)(Cl,[["render",bl],["__scopeId","data-v-dc235b08"]]);var Dl=xl;function Ll(e,t,s,i,a,o){const n=(0,l.up)("AppPaginator"),r=(0,l.up)("ImportStuffSelector");return s.show?((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,C.C_)(["bottom",{blur:s.blur}])},[s.showBtns?((0,l.wg)(),(0,l.j4)(n,{key:0,page:s.page,onChangePage:o.changePage},null,8,["page","onChangePage"])):(0,l.kq)("",!0),s.showSelector?((0,l.wg)(),(0,l.j4)(r,{key:1,class:"count",options_props:a.count_values,selected_option:{name:s.count,value:s.count},onSelect:o.change_count},null,8,["options_props","selected_option","onSelect"])):(0,l.kq)("",!0)],2)):(0,l.kq)("",!0)}const Pl=e=>((0,l.dD)("data-v-512ab79e"),e=e(),(0,l.Cn)(),e),Sl={class:"v-select"},Wl=Pl((()=>(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},[(0,l._)("path",{fill:"#757575",d:"M8.12 9.29L12 13.17l3.88-3.88a.996.996 0 1 1 1.41 1.41l-4.59 4.59a.996.996 0 0 1-1.41 0L6.7 10.7a.996.996 0 0 1 0-1.41c.39-.38 1.03-.39 1.42 0z"})],-1))),ql=[Wl],Fl={class:"options",key:"a1"},jl=["onClick"];function Vl(e,t,s,a,o,n){return(0,l.wg)(),(0,l.iD)("div",Sl,[(0,l._)("div",{class:(0,C.C_)(["title",{title_checked:a.show_options,disabled:s.disabled}]),onClick:t[0]||(t[0]=e=>a.open_close_options()),onFocusout:t[1]||(t[1]=(...e)=>a.handleFocusOut&&a.handleFocusOut(...e)),ref:"title",tabindex:"0"},[(0,l._)("p",null,(0,C.zw)(s.selected_option.name),1),s.disabled?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,C.C_)(["arrow",{rotate_arrow:a.show_options}])},ql,2))],34),(0,l.Wm)(i.uT,{name:"list"},{default:(0,l.w5)((()=>[a.show_options?((0,l.wg)(),(0,l.iD)("div",Fl,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.options,(e=>((0,l.wg)(),(0,l.iD)("p",{key:e.value,class:(0,C.C_)({optgroup:"optgroup"===e.value,selected:e.value==s.selected_option.value}),onClick:t=>a.select_option(e)},[e.optgroup?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l.Uk)("     "+(0,C.zw)(e.name),1)],64)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[(0,l.Uk)((0,C.zw)(e.name),1)],64))],10,jl)))),128))])):(0,l.kq)("",!0)])),_:1})])}const Al={props:{options_props:{type:Array,default(){return[]},required:!0},selected_option:{type:Object,required:!0,default(){return{}}},disabled:{type:Boolean,required:!1,default:!1},idx:{type:Number,required:!1}},emits:{select:null},setup(e,t){const s=(0,Qe.iH)([]);(0,l.bv)((()=>{window.addEventListener("scroll",c),(0,l.Y3)((()=>{i()}))}));const i=()=>{s.value=[],e.options_props?.forEach((e=>s.value.push(e)))};(0,l.YP)((()=>e.options_props),(()=>{i()}),{deep:!0});const a=(0,Qe.iH)(!1);(0,l.YP)(a,(()=>t.emit("toggleShowOptions",a.value)));const o=()=>{a.value=!1},n=()=>{e.disabled||(c(),a.value=!a.value)},r=()=>{o()},d=s=>{"optgroup"!=s.value&&(t.emit("select",s,e.idx),o())};(0,l.Ah)((()=>window.removeEventListener("scroll",c)));const c=()=>{const e=u.value?.getBoundingClientRect();p.value=e.width-2+"px",h.value=e.x+"px",g.value=e.bottom+"px"},u=(0,Qe.iH)(null),p=(0,Qe.iH)(null),h=(0,Qe.iH)(null),g=(0,Qe.iH)(null);return{open_close_options:n,handleFocusOut:r,show_options:a,options:s,select_option:d,title:u,optionsWidth:p,optionsX:h,optionsY:g}}},Il=()=>{(0,i.sj)((e=>({"722cb76a":e.optionsWidth,c14607c8:e.optionsX,c14607c6:e.optionsY})))},Hl=Al.setup;Al.setup=Hl?(e,t)=>(Il(),Hl(e,t)):Il;var Tl=Al;const Yl=(0,at.Z)(Tl,[["render",Vl],["__scopeId","data-v-512ab79e"]]);var zl=Yl;const Zl={class:"grid"},$l={class:"current d"};function El(e,t,s,i,a,o){return(0,l.wg)(),(0,l.iD)("div",Zl,[s.page.current!=s.page.first&&null!=s.page.prev?((0,l.wg)(),(0,l.iD)("button",{key:0,onClick:t[0]||(t[0]=e=>i.prev()),class:"a"},(0,C.zw)("<"))):(0,l.kq)("",!0),s.page.current!=s.page.first&&s.page.prev!=s.page.first?((0,l.wg)(),(0,l.iD)("button",{key:1,onClick:t[1]||(t[1]=e=>i.first()),class:"b"},(0,C.zw)(s.page.first),1)):(0,l.kq)("",!0),s.page.current!=s.page.first&&null!=s.page.prev?((0,l.wg)(),(0,l.iD)("button",{key:2,onClick:t[2]||(t[2]=e=>i.prev()),class:"c"},(0,C.zw)(s.page.prev),1)):(0,l.kq)("",!0),(0,l._)("button",$l,(0,C.zw)(s.page.current),1),s.page.current!=s.page.last&&null!=s.page.next?((0,l.wg)(),(0,l.iD)("button",{key:3,onClick:t[3]||(t[3]=e=>i.next()),class:"e"},(0,C.zw)(s.page.next),1)):(0,l.kq)("",!0),s.page.current!=s.page.last&&s.page.next!=s.page.last?((0,l.wg)(),(0,l.iD)("button",{key:4,onClick:t[4]||(t[4]=e=>i.last()),class:"f"},(0,C.zw)(s.page.last),1)):(0,l.kq)("",!0),s.page.current!=s.page.last&&null!=s.page.next?((0,l.wg)(),(0,l.iD)("button",{key:5,onClick:t[5]||(t[5]=e=>i.next()),class:"g"},(0,C.zw)(">"))):(0,l.kq)("",!0)])}var Ol={props:{page:Object},emits:{changePage(e){return e>0&&"number"===typeof e}},setup(e,t){const s=()=>t.emit("changePage",e.page.first),l=()=>t.emit("changePage",e.page.current-1),i=()=>t.emit("changePage",e.page.current+1),a=()=>t.emit("changePage",e.page.last);return{prev:l,first:s,next:i,last:a}}};const Ul=(0,at.Z)(Ol,[["render",El],["__scopeId","data-v-67ebe89a"]]);var Bl=Ul,Ml={components:{ImportStuffSelector:zl,AppPaginator:Bl},props:{previous:{type:Boolean,required:!1},next:{type:Boolean,required:!1},page:{type:Object,required:!1,default(){return{first:1,prev:null,current:1,next:null,last:1}}},count:{type:Number,required:!0},blur:{type:Boolean,required:!1,default:!1},show:{type:Boolean,required:!1,default:!0},showBtns:{type:Boolean,required:!1,default:!0},showSelector:{type:Boolean,required:!1,default:!0}},emits:{changePage:null,changeCount:null},data(){return{count_values:[{name:"10",value:10},{name:"20",value:20},{name:"50",value:50}]}},mounted(){},computed:{},methods:{changePage(e){this.$emit("changePage",e)},change_count(e){this.$emit("changeCount",e.name)}}};const Nl=(0,at.Z)(Ml,[["render",Ll],["__scopeId","data-v-3e26f9b6"]]);var Kl=Nl,Rl={name:"MainGrid",components:{TableSettings:Xt,MainGridFilters:ll,MainGridBar:Dl,GridBottom:Kl,AppInputSelect:nt},props:{},emits:{accept:null},data(){return{isLoading:!1,inputValues:[],allWhsList:[],savedAllWhsList:[],showSpinner:!1}},computed:{page(){const e={first:this.getPageFromLink(this.meta?.links?.first),prev:this.getPageFromLink(this.meta?.links?.prev),current:this.meta?.meta?.current_page,next:this.getPageFromLink(this.meta?.links?.next),last:this.getPageFromLink(this.meta?.links?.last)};return e},count(){return this.productsParams?.per_page},meta(){return this.$store.state.widjetProducts.meta},products(){return this.$store.state.widjetProducts.allProducts},productsParams(){return this.$store.state.widjetProducts.productsParams},all_fields(){return this.$store.state.widjetFields.all_fields},tableConfig(){return this.$store.state.widjetFields.tableConfig},selectedWirePerLead(){return this.$store.state.widjetProducts.selectedWirePerLead},showTableSettings(){return this.$store.state.widjetFields.showTableSettings},sortedFields(){const e=Object.entries(this.tableConfig);return e.sort(((e,t)=>e[1].sort>t[1].sort?1:e[1].sort==t[1].sort?0:e[1].sort<t[1].sort?-1:void 0)).filter((e=>e[1]?.visible))},sortedFields2(){const e=Object.entries(this.tableConfig);return e.sort(((e,t)=>e[1].sort>t[1].sort?1:e[1].sort==t[1].sort?0:e[1].sort<t[1].sort?-1:void 0))},categories(){const e={};return this.$store.state.widjetCategories.fields_properties2.forEach((t=>e[t.id]=t.name)),e},savedAllWhsListIds(){const e=[];return this.savedAllWhsList.forEach((t=>e.push(t[0].product_id))),e}},async activated(){this.isLoading=!0,await Promise.all([this.$store.dispatch("getTableConfigW",{code:"widget"}),this.$store.dispatch("get_fields_properties2W"),this.$store.dispatch("getAllFieldsW"),this.get_products(this.productsParams)]),this.isLoading=!1},deactivated(){},watch:{products:{handler:function(){this.fillAllWhsList()},deep:!0},allWhsList:{handler:function(){this.saveAllWhsList(),this.saveSelectedWirePerLead()},deep:!0}},methods:{async accept(){const e=[];this.savedAllWhsList.forEach((t=>{t?.forEach((t=>{if(t.specialValue){const s={product_id:t.is_service?t.product_id:t.product_id+"%%%"+t.code,count:t.specialValue};e.push(this.$store.dispatch("addProduct3W",s))}}))})),await Promise.all(e),this.savedAllWhsList=[],this.allWhsList=[],this.$emit("changeSavedAllWhsList",this.savedAllWhsList),this.$emit("accept")},fillAllWhsList(){this.saveAllWhsList();const e=[];this.products.forEach((t=>{const s=this.savedAllWhsList.find((e=>e[0].product_id===t.id));if(s)e.push(s);else{const s=t.whs?.map((e=>({...e})));s.map((e=>{e.name=e.name+"   |   "+e.count,e.value=e.code,e.specialValue=null,e.product_id=t.id,e.is_service=t.is_service,e.product_name=t.fields?.name})),e.push(s)}})),this.allWhsList=e},saveAllWhsList(){const e=this.allWhsList.filter((e=>{const t=e.reduce(((e,t)=>e+Number(t.specialValue)),0);return t}));if(this.savedAllWhsList.length){const t={};this.savedAllWhsList.forEach(((s,l)=>{const i=s[0].product_id;e.forEach((e=>{e[0].product_id===i?this.savedAllWhsList[l]=e:this.savedAllWhsListIds.includes(e[0].product_id)||(t[e[0].product_id]=e)}))})),this.savedAllWhsList=[...this.savedAllWhsList,...Object.values(t)],this.savedAllWhsList=this.savedAllWhsList.filter((e=>e.reduce(((e,t)=>e+Number(t.specialValue)),0)))}else this.savedAllWhsList=[...this.savedAllWhsList,...e];this.$emit("changeSavedAllWhsList",this.savedAllWhsList)},deleteSavedAllWhsList(e){const t=this.savedAllWhsList[e]?.[0]?.product_id,s=this.allWhsList.find((e=>e[0]?.product_id===t));s&&s.map((e=>e.specialValue=null)),this.savedAllWhsList.splice(e,1),this.$emit("changeSavedAllWhsList",this.savedAllWhsList)},fillInputValues(){this.products.forEach((()=>this.inputValues.push("")))},getPageFromLink(e){return e?e.split("?page=")[1]:null},async clearFilters(){await(this.filters?.clearFilters()),this.filters?.confirmFilters()},confirmFilters(){this.filters?.confirmFilters()},async changeCount(e){this.$store.commit("updateProductsParams",{per_page:e}),this.drop_page()},changePage(e){const t={page:e};this.$store.commit("updateProductsParams",t),this.get_products(this.productsParams)},async get_products(e){this.showSpinner=!0,await this.$store.dispatch("getAllProductsW",{...e,leadId:29768593}),this.fillInputValues(),this.showSpinner=!1},drop_page(){this.changePage(1)},sort(e,t){const s={page:1,sort:{by:e,order:t}};this.$store.commit("updateProductsParams",s),this.get_products(this.productsParams)},async closeTableSettings(){this.isLoading=!0,await Promise.all([this.$store.dispatch("getTableConfigW",{code:"widget"}),this.$store.dispatch("getAllFieldsW"),this.get_products(this.productsParams)]),this.isLoading=!1},saveSelectedWirePerLead(){let e=null;this.products[0]?.one_wh_per_lead&&(e=this.savedAllWhsList[0]?.find((e=>e?.specialValue>0))?.code),e==this.selectedWirePerLead.value&&this.selectedWirePerLead.sources.includes("MG")||this.$store.commit("updateSelectedWirePerLead",{source:"MG",value:e})}}};const Gl=(0,at.Z)(Rl,[["render",Ht],["__scopeId","data-v-6763ba33"]]);var Xl=Gl,Jl={components:{MainGrid:Xl},emits:{close:null},setup(e,t){const s=()=>{t.emit("close")},i=()=>{a.value=[],t.emit("accept"),s()},a=(0,Qe.iH)([]),o=e=>{a.value=[...e]},n=(0,Qe.iH)(null),r=e=>{n.value&&(0,l.Y3)((()=>n.value?.deleteSavedAllWhsList(e)))},d=()=>{n.value&&(0,l.Y3)((()=>n.value?.accept()))};return{close:s,accept:i,accepMainGridRef:d,savedAllWhsList:a,changeSavedAllWhsList:o,mainGridRef:n,deleteSavedAllWhsList:r}}};const Ql=(0,at.Z)(Jl,[["render",ft],["__scopeId","data-v-3c025bb8"]]);var ei=Ql;const ti={class:"text-slate-900"},si=(0,l._)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24"},[(0,l._)("path",{fill:"#757575",d:"M15.125 21.1L6.7 12.7q-.15-.15-.213-.325T6.425 12q0-.2.062-.375T6.7 11.3l8.425-8.425q.35-.35.875-.35t.9.375q.375.375.375.875t-.375.875L9.55 12l7.35 7.35q.35.35.35.863t-.375.887q-.375.375-.875.375t-.875-.375Z"})],-1),li=[si],ii={class:"pcrow"},ai={class:"pcrow"},oi={class:"pcrow"},ni={class:"pcrow"},ri=(0,l._)("span",{class:"material-icons-outlined text-red-600"}," delete ",-1),di=(0,l._)("span",null,"Удалить позицию",-1),ci=[ri,di];function ui(e,t,s,a,o,n){const r=(0,l.up)("EditSelector"),d=(0,l.up)("EditFloat");return(0,l.wg)(),(0,l.iD)("div",{class:(0,C.C_)(["w-full p-5 my-2 flex flex-col gap-4 origin-top rounded-md bg-white shadow-lg ring-1 ring-gray-900 ring-opacity-5 transition-all",{pcsmall:!a.show}]),ref:"target"},[(0,l._)("div",{class:"cursor-pointer flex flex-row justify-between items-center gap-2",onClick:t[0]||(t[0]=e=>a.toggle())},[(0,l._)("span",ti,(0,C.zw)(s.copyItem?.name)+" | склад '"+(0,C.zw)(a.selectedWhName)+"': "+(0,C.zw)(s.copyItem?.count)+" "+(0,C.zw)(s.copyItem?.units?s.copyItem?.units:s.copyItem.fields?.units)+" | "+(0,C.zw)(s.copyItem?.price)+" "+(0,C.zw)(s.copyItem?.price_currency),1),(0,l._)("button",{class:(0,C.C_)(["p-2 h-fit w-fit rounded-xl outline-0 outline-slate-300 focus-visible:outline-1 transition-all",{"-rotate-90":a.show}])},li,2)]),a.show?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l._)("div",ii,[(0,l.Wm)(r,{item:{name:"Тип цены",data:a.PRICES},selected_option:s.copyItem?.price_field,idx:"price_field",onChange_value:t[1]||(t[1]=(e,t,s)=>a.change_value(s,t))},null,8,["item","selected_option"])]),(0,l._)("div",ai,[(0,l.Wm)(d,{item:"Цена",selected_option:s.copyItem?.price,idx:"price",onChange_value:a.change_value},null,8,["selected_option","onChange_value"])]),(0,l._)("div",oi,[(0,l.Wm)(r,{item:{name:"Склад",data:a.WHS},selected_option:s.copyItem?.wh_field,idx:"wh_field",onChange_value:t[2]||(t[2]=(e,t,s)=>a.change_value(s,t))},null,8,["item","selected_option"])]),(0,l._)("div",ni,[(0,l.Wm)(d,{item:"Количество",selected_option:s.copyItem?.count,idx:"count",max:s.copyItem?.["available-count"],onChange_value:a.change_value},null,8,["selected_option","max","onChange_value"])]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.fields,(e=>(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",{class:"pcrow",key:e.id},[((0,l.wg)(),(0,l.j4)((0,l.LL)(e.component),{item:5==e.type||6==e.type?e:e.name,selected_option:s.copyItem?.[e.code]?s.copyItem?.[e.code]:s.copyItem?.fields?.[e.code],idx:e.code,disabled:e.lead_config.editable<1,onChange_value:a.change_value},null,40,["item","selected_option","idx","disabled","onChange_value"]))])),[[i.F8,e.lead_config.visible>0&&e.component]]))),128)),(0,l._)("div",{class:"flex flex-row justify-end gap-2 cursor-pointer focus:ring-1 focus:ring-red-200",onClick:t[3]||(t[3]=e=>a.del())},ci)],64)):(0,l.kq)("",!0)],2)}var pi=s(2675),hi=s(9098),gi=s(8592),_i=s(293),mi=s(3078),vi=s(4254),wi=s(5226),fi=s(5389),yi=s(973),bi=s(6413);const ki=(0,Qe.qj)({selected:{name:"Товары",value:"products",code:"ProductsTab"},list:[{name:"Товары",value:"products",code:"ProductsTab"},{name:"Документы",value:"documents",code:"DocumentsTab"},{name:"Клиент",value:"client",code:"ClientTab"}],select:function(e){this.selected=e}});function Ci(){const e=(0,l.Fl)((()=>"products"===ki.selected.value));return{tabs:ki,isProductTab:e}}var xi={components:{EditInteger:pi.Z,EditFloat:hi.Z,EditString:gi.Z,EditText:_i.Z,EditSelector:mi.Z,EditMultiSelector:vi.Z,EditDate:wi.Z,EditDateTime:fi.Z,EditFlag:yi.Z},props:{fields:{type:Array,required:!0},copyItem:{type:Object,required:!0}},setup(e,t){const{isProductTab:s}=Ci(),i=(e,s)=>t.emit("change_value",e,s),a=(0,Qe.iH)(null),{y:o}=(0,et.rBN)(a);(0,et.i9H)(a,(()=>{c(),d(!1)}));const{y:n}=(0,et.baj)(),[r,d]=(0,bi.OT)(!1),c=()=>{s.value&&r.value&&window.scrollTo(0,n.value+o.value-204)},u=(0,l.Fl)((()=>{const t=[];return e.fields.forEach((e=>11===e.type?t.push({name:e.name,value:e.code}):null)),t})),p=(0,l.Fl)((()=>{const t=[];return e.fields.forEach((e=>13===e.type?t.push({name:e.name,value:e.code}):null)),t})),h=(0,l.Fl)((()=>p.value.find((t=>t.value===e.copyItem?.wh_field))?.name)),g=()=>t.emit("del");return{change_value:i,show:r,toggle:d,target:a,PRICES:u,WHS:p,selectedWhName:h,del:g}}};const Di=(0,at.Z)(xi,[["render",ui]]);var Li=Di,Pi={components:{AppInputSelect:nt,FiltersModal:ei,AppPaginator:Bl,ProductCard:Li},data(){return{show_cards:!1,show_filters:!1,selectedCategories:[],search:{value:"",list:[]},inputValues:[],allWhsList:[],showSpinner:!1,useSkeletonCard:!1,addedProducts:[],routeWatcher:null,flip:[]}},computed:{categories(){return this.$store.state.widjetCategories.categories},addedProductsId(){const e=[];return this.addedProducts.forEach((t=>e.push(t.id))),e},page(){const e={first:this.getPageFromLink(this.meta?.links?.first),prev:this.getPageFromLink(this.meta?.links?.prev),current:this.meta?.meta?.current_page,next:this.getPageFromLink(this.meta?.links?.next),last:this.getPageFromLink(this.meta?.links?.last)};return e},meta(){return this.$store.state.widjetProducts.meta2},productsParams(){return this.$store.state.widjetProducts.productsParams2},categoriesForCard(){const e={};return this.$store.state.widjetCategories.fields_properties2.forEach((t=>e[t.id]=t.name)),e},selectedWirePerLead(){return this.$store.state.widjetProducts.selectedWirePerLead},savedAllWhsList(){const e=this.allWhsList.filter((e=>{const t=e.reduce(((e,t)=>e+Number(t.specialValue)),0);return t}));return e||[]},products(){return this.$store.state.widjetProducts.products},fields(){return this.$store.state.widjetFields.fields},disableAddToDeal(){return this.$store.state.widjetProducts.disableAddToDeal},sortedFields(){return this.fields?.filter((e=>e.lead_config?.visible>0))},productsLength(){return this.products.length},isLastProductPerPage(){return this.meta.meta.from===this.meta.meta.to},total(){const e={cost_price:0,price:0,prib:0,user_name:"",price_currency:""};return this.addedProducts.forEach((t=>{e.cost_price+=t.cost_price*t.count,e.price+=t.price*t.count,e.prib+=t.price*t.count-t.cost_price*t.count,e.user_name=t.user_name,e.price_currency=t.price_currency})),e.cost_price+=" "+e.price_currency,e.price+=" "+e.price_currency,e.prib+=" "+e.price_currency,e}},async mounted(){this.routeWatcher=this.$router.beforeResolve(((e,t,s)=>{e.query?.order_id==t.query?.order_id&&e.path==t.path||!t.query?.order_id||this.checkSave(),s()})),await Promise.all([this.getCategoriesW(0),this.$store.dispatch("getAllFieldsW"),this.$store.dispatch("get_fields_properties2W")]),await this.selectCategories(this.categories[0]),setTimeout((()=>{this.updateAddedProducts()}),500)},watch:{async show_cards(){this.show_cards||(this.selectedCategories=[],await this.getCategoriesW(0),this.selectCategories(this.categories[0]))},allWhsList:{handler:function(){this.saveSelectedWirePerLead()},deep:!0}},methods:{getPageFromLink(e){return e?e.split("?page=")[1]:null},changePage(e){this.$store.commit("updateProductsParams2",{page:e}),this.getProducts(this.selectedCategories.at(-1)?.id),window.scrollTo(0,0)},dropPage(){this.changePage(1)},fillAllWhsList(){const e=[];this.products.forEach((t=>{const s=t.whs?.map((e=>({...e})));s.map((e=>{e.name=e.name+"   |   "+e.count,e.value=e.code,e.specialValue=null})),e.push(s)})),this.allWhsList=e},fillInputValues(){this.products.forEach((()=>this.inputValues.push("")))},async addToLeadAutocomplete(e){await this.$store.dispatch("addProductW",{product_id:e}),this.updateProductsList(),this.updateAddedProducts()},async addToLead(e){const t=this.products.find((t=>t.id===e)),s=this.products.indexOf(t);if(await t.is_service)await this.$store.dispatch("addProduct2W",{product_id:e,count:this.allWhsList[s][0].specialValue});else{const t=[];this.allWhsList[s].forEach((s=>{if(s.specialValue){const l={product_id:[e,s.code].join("%%%"),count:s.specialValue};t.push(this.$store.dispatch("addProduct3W",l))}})),await Promise.all(t)}this.updateProductsList(),this.updateAddedProducts()},updateProductsList(){this.show_cards&&(this.isLastProductPerPage&&this.page.current>1?this.changePage(this.page.current-1):this.getProducts(this.selectedCategories.at(-1)?.id))},async updateAddedProducts(){const e=await this.$store.dispatch("getOrder");e.positions?.forEach((e=>this.addedProductsId.includes(e.id)?null:this.addedProducts.push(e)))},async getProductsAutocomplete(e){this.search.value=e;const t=this.selectedCategories.at(-1)?.id,s={q:e};this.selectedWirePerLead.value&&(s.selected_wh=this.selectedWirePerLead.value),t&&(s.category_id=t),await this.$store.dispatch("getProductsAutocompleteW",s);const l=this.$store.state.widjetProducts.productsAutocomplete;l.map((e=>e.name=e.label)),this.search.list=l},async selectCategories(e){this.showSpinner=!0;const t=this.selectedCategories?.indexOf(e);-1!==t&&this.selectedCategories.splice(t,9999),this.selectedCategories.push(e),this.dropPage(),await Promise.all([this.getCategoriesW(e.id),this.getProducts(e.id)]),1===this.selectedCategories.length&&await this.getFields(e.id),this.showSpinner=!1},async getCategoriesW(e){await this.$store.dispatch("getCategoriesW",{parent_id:e})},async getProducts(e){this.useSkeletonCard=!0,await this.$store.dispatch("getProducts2W",{category_id:e,...this.productsParams}),this.fillInputValues(),this.fillAllWhsList(),this.useSkeletonCard=!1},async getFields(e){await this.$store.dispatch("getFieldsW",{category_id:e,with_parents:1})},close_filters(){this.show_filters=!1},accept_filters(){this.updateProductsList(),this.updateAddedProducts()},feel_available_data(){this.data.forEach(((e,t)=>{const s={name:this.short_value(e),data:e,value:t};this.available_data.push(s)}))},search_value(e,t){const s=this.search_idx(e);if(-2!=s)return t[s]},search_idx(e){const t=this.params.indexOf(e)-1;return t},toggleShowData(e){const t=this.show_data[e];this.show_data=[],this.show_data[e]=!t},openModal(){return this.show_filters=!0,!1},saveSelectedWirePerLead(){let e=null;this.products[0]?.one_wh_per_lead&&(e=this.savedAllWhsList[0]?.find((e=>e?.specialValue>0))?.code),e==this.selectedWirePerLead.value&&this.selectedWirePerLead.sources.includes("MP")||this.$store.commit("updateSelectedWirePerLead",{source:"MP",value:e})},change_value(e,t,s){this.addedProducts[e][s]=t},checkSave(){this.$store.dispatch("updateOrder",{positions:this.addedProducts})},deleteAddedProduct(e){this.addedProducts.splice(e,1)}}};const Si=(0,at.Z)(Pi,[["render",ze],["__scopeId","data-v-6c7c6853"]]);var Wi=Si;const qi=e=>((0,l.dD)("data-v-e64a98f8"),e=e(),(0,l.Cn)(),e),Fi={class:"flex flex-col gap-4 justify-center items-center sticky top-[142px] w-[90%] mx-auto"},ji={class:"max-w-md min-w-[40%] w-fit text-gray-900 divide-y divide-gray-200 dark:text-white dark:divide-gray-700"},Vi={class:"flex flex-col pb-3 items-start w-full"},Ai=qi((()=>(0,l._)("div",{class:"mb-1 text-gray-500 md:text-base dark:text-gray-400"}," Название ",-1))),Ii={class:"flex flex-col pb-3 items-start w-full"},Hi=qi((()=>(0,l._)("div",{class:"mb-1 text-gray-500 md:text-base dark:text-gray-400"}," Статус ",-1))),Ti={class:"mb-1 text-gray-500 md:text-base dark:text-gray-400"},Yi={key:1,class:"text-base font-medium"};function zi(e,t,s,a,o,n){const r=(0,l.up)("SelectorVue");return(0,l.wg)(),(0,l.iD)("div",Fi,[(0,l._)("div",ji,[(0,l._)("div",Vi,[Ai,(0,l.wy)((0,l._)("input",{type:"text",class:"input","onUpdate:modelValue":t[0]||(t[0]=e=>a.order.fields.name=e),onInput:t[1]||(t[1]=e=>a.toggleSomeChange(!0))},null,544),[[i.nr,a.order.fields.name]])]),(0,l._)("div",Ii,[Hi,(0,l.Wm)(r,{selected_option:a.selector.selected,options_props:a.selector.list,onSelect:t[2]||(t[2]=e=>a.selector.select(e))},null,8,["selected_option","options_props"])]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.list,(e=>((0,l.wg)(),(0,l.iD)("div",{class:"flex flex-col pb-3 items-start w-full",key:e.label},[(0,l._)("div",Ti,(0,C.zw)(e.label),1),e.component?((0,l.wg)(),(0,l.j4)((0,l.LL)(e.component),{key:0,selected_option:a.user_name.selected,options_props:a.user_name.list,onSelect:t[3]||(t[3]=e=>a.user_name.select(e))},null,40,["selected_option","options_props"])):((0,l.wg)(),(0,l.iD)("div",Yi,(0,C.zw)(s.total?.[e.value]),1))])))),128))])])}var Zi=s(7720),$i=s(1257),Ei=s(9299),Oi={components:{SelectorVue:Zi.Z},props:{total:Object},setup(e){const{order:t,toggleSomeChange:s,isOrederLoaded:i}=(0,$i.r)(),a=(0,Qe.qj)([{label:"Сумма заказа:",value:"price"},{label:"Себестоимость:",value:"cost_price"},{label:"Прибыль:",value:"prib"},{label:"Сотрудник:",value:"user_name",component:"SelectorVue"}]),o=(0,Qe.qj)({selected:(0,l.Fl)((()=>o.list.find((e=>e.value==t.status)))),list:[],getStatuses:async function(){const e=await Ei.Z.dispatch("ordersPipelinesList",{}),t=[];e.map((e=>{e.value="optgroup",t.push(e),e.statuses.map((e=>{e.value=e.id,e.optgroup=!0,t.push(e)}))})),this.list.length=0,this.list=t},setSelected:function(){const e=this.list.find((e=>e.is_system&&"optgroup"===e.value)),s=this.list.indexOf(e);t.status=this.list[s+1].id},checkSelStat:function(e){const t=[];return this.list.forEach((e=>t.push(e.value))),t.includes(e)},select:function(e){t.status=e.value,s(!0)}});(0,l.bv)((async()=>{const e=new Promise((e=>setInterval((()=>i.value?e():null),100)));await e,await o.getStatuses(),o.checkSelStat(t.status)||o.setSelected()}));const n=(0,Qe.qj)({selected:(0,l.Fl)((()=>n.list.find((s=>s.value==(t.fields.user_name?t.fields.user_name:e.total?.user_name))))),list:[],getList:async function(){const e=await Ei.Z.dispatch("getUsersList");this.list=[],e.forEach((e=>this.list.push({...e,value:e.name})))},select:function(e){t.fields.user_name=e.value,s(!0)}});return n.getList(),{list:a,selector:o,order:t,user_name:n,toggleSomeChange:s}}};const Ui=(0,at.Z)(Oi,[["render",zi],["__scopeId","data-v-e64a98f8"]]);var Bi=Ui;const Mi=e=>((0,l.dD)("data-v-1c896964"),e=e(),(0,l.Cn)(),e),Ni={class:"flex flex-col gap-4 justify-center items-center w-full"},Ki=Mi((()=>(0,l._)("h2",{class:"font-semibold text-gray-700 w-full text-start"},null,-1))),Ri={class:"max-w-md min-w-[40%] w-full text-gray-900"};function Gi(e,t,s,a,o,n){return(0,l.wg)(),(0,l.iD)("div",Ni,[Ki,(0,l._)("div",Ri,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.fields,(e=>(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",{class:"row",key:e.id},["name"!==e.code?((0,l.wg)(),(0,l.j4)((0,l.LL)(e.component),{key:0,item:5==e.type||6==e.type?e:e.name,selected_option:a.order?.fields?.[e.code],idx:e.code,onChange_value:a.change_value},null,40,["item","selected_option","idx","onChange_value"])):(0,l.kq)("",!0)])),[[i.F8,e.component]]))),128))])])}var Xi={components:{EditInteger:pi.Z,EditFloat:hi.Z,EditString:gi.Z,EditText:_i.Z,EditSelector:mi.Z,EditMultiSelector:vi.Z,EditDate:wi.Z,EditDateTime:fi.Z,EditFlag:yi.Z},setup(){const{order:e,toggleSomeChange:t}=(0,$i.r)();(0,l.bv)((async()=>{await Promise.all([Ei.Z.dispatch("getOrdersTypes"),Ei.Z.dispatch("getOrdersFields")])}));const s=(s,l)=>(e.fields[l]=s,t(!0)),i=(0,l.Fl)((()=>Ei.Z.state.orders.fields));return{fields:i,order:e,change_value:s}}};const Ji=(0,at.Z)(Xi,[["render",Gi],["__scopeId","data-v-1c896964"]]);var Qi=Ji,ea={components:{MainPage:Wi,ProductsTabFields:Bi,ProductsTabCastomFields:Qi},setup(){const e=(0,Qe.iH)(null),t=(0,l.Fl)((()=>e.value?.total));return{widjet:e,total:t}}};const ta=(0,at.Z)(ea,[["render",k],["__scopeId","data-v-14c8bdc7"]]);var sa=ta;const la=e=>((0,l.dD)("data-v-1ce7a618"),e=e(),(0,l.Cn)(),e),ia={class:"flex flex-row items-center justify-evenly"},aa={class:"flex flex-row gap-4 items-center"},oa=["disabled"],na=(0,l.Uk)(" Генерация "),ra=la((()=>(0,l._)("span",{class:"animate-pulse ml-1"},".",-1))),da=la((()=>(0,l._)("span",{class:"animate-pulse",style:{"animation-delay":"0.667s"}},".",-1))),ca=la((()=>(0,l._)("span",{class:"animate-pulse",style:{"animation-delay":"1.333s"}},".",-1))),ua=(0,l.Uk)(" Сгенерировать "),pa={for:"xlsx",class:"btn pointer-events-auto relative inline-flex rounded-md bg-white text-[0.8125rem] font-medium leading-5 text-slate-700 shadow-sm ring-1 ring-slate-700/10 hover:bg-slate-50 hover:text-slate-900 hover:disabled:bg-white disabled:opacity-30 disabled:cursor-not-allowed"},ha=(0,l.Uk)(" Загружаем "),ga=la((()=>(0,l._)("span",{class:"animate-pulse ml-1"},".",-1))),_a=la((()=>(0,l._)("span",{class:"animate-pulse",style:{"animation-delay":"0.667s"}},".",-1))),ma=la((()=>(0,l._)("span",{class:"animate-pulse",style:{"animation-delay":"1.333s"}},".",-1))),va=(0,l.Uk)(" Загрузить "),wa={class:"mt-10"},fa={class:"bg-white divide-y divide-gray-300 w-3/4 mx-auto"},ya={class:"cell main"},ba={class:"cell"},ka={class:"cell"},Ca={class:"cell"},xa=["href"],Da={class:"cell"},La=["href"],Pa={class:"cell"},Sa=["onClick"],Wa=la((()=>(0,l._)("span",{class:"material-icons-outlined text-red-600"}," delete ",-1))),qa=[Wa];function Fa(e,t,s,i,a,o){const n=(0,l.up)("AppInputSelect");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l._)("header",ia,[(0,l.Wm)(n,{class:"w-1/2",list:i.docs.list,selected:i.docs.selected,countLettersReq:0,requestDelay:0,SelectedInTitle:!0,placeholder:"Выбор шаблона",onChangeInputValue:t[0]||(t[0]=e=>i.docs.value=e),onSelect:t[1]||(t[1]=e=>i.docs.select(e))},null,8,["list","selected"]),(0,l._)("div",aa,[(0,l._)("button",{class:"btn pointer-events-auto relative inline-flex transition-all rounded-md bg-white text-[0.8125rem] font-medium leading-5 text-slate-700 shadow-sm ring-1 ring-slate-700/10 hover:bg-slate-50 hover:text-slate-900 hover:disabled:bg-white disabled:opacity-30 disabled:cursor-not-allowed",onClick:t[2]||(t[2]=e=>i.generate()),disabled:-1===i.docs.selected.value&&!1},[i.docs.isGeneration?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[na,ra,da,ca],64)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[ua],64))],8,oa),(0,l._)("label",pa,[i.isUpload?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[ha,ga,_a,ma],64)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[va],64))]),(0,l._)("input",{type:"file",id:"xlsx",onChange:t[3]||(t[3]=e=>i.uploadFiles(e)),class:"hidden"},null,32)])]),(0,l._)("div",wa,[(0,l._)("table",fa,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)([...i.docsList,...i.customDocList],(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id},[(0,l._)("td",ya,[(0,l._)("span",null,(0,C.zw)(e.name),1)]),(0,l._)("td",ba,[(0,l._)("span",null,(0,C.zw)(e.created_at),1)]),(0,l._)("td",ka,[(0,l._)("span",null,(0,C.zw)(e.user_name),1)]),(0,l._)("td",Ca,[e.open_url?((0,l.wg)(),(0,l.iD)("a",{key:0,class:"link",target:"blank",href:e.open_url}," открыть ",8,xa)):(0,l.kq)("",!0)]),(0,l._)("td",Da,[(0,l._)("a",{class:"link",target:"blank",href:e.download_url}," скачать ",8,La)]),(0,l._)("td",Pa,[(0,l._)("button",{class:"w-fit h-fit p-2 rounded-lg flex justify-center items-center focus:outline-2 focus:-outline-offset-4 focus:outline-slate-600 active:brightness-125",onClick:t=>e.isCustom?i.deleteCustomDoc(e.id):i.delDoc(e.id)},qa,8,Sa)])])))),128))])])])}var ja=s(5477);function Va(){const{newDealParams:e,toggleSomeChange:t}=(0,$i.r)(),s=(0,Qe.iH)(!1),l=async l=>{s.value=!0;const i=l.target.files[0],o=new FormData;o.append("files",i),o.append("order_id",e.id),await Ei.Z.dispatch("customDocUpload",o),t(!0),s.value=!1,a()},i=(0,Qe.qj)([]),a=async()=>{i.length=0,Object.assign(i,await Ei.Z.dispatch("customDocList",{order_id:e.id})),i.map((e=>e.isCustom=!0))},o=async t=>{await Ei.Z.dispatch("customDocDelete",{order_id:e.id,doc_id:t}),a()};return{uploadFiles:l,customDocList:i,getCustomDocList:a,deleteCustomDoc:o,isUpload:s}}var Aa={components:{AppInputSelect:ja.Z},setup(){const{newDealParams:e,toggleSomeChange:t}=(0,$i.r)(),{uploadFiles:s,customDocList:i,getCustomDocList:a,deleteCustomDoc:o,isUpload:n}=Va();(0,l.bv)((()=>{Ei.Z.dispatch("get_documents_v2"),d(),a()}));const r=(0,Qe.qj)([]),d=async()=>{r.length=0,Object.assign(r,await Ei.Z.dispatch("getOrderDocList",{order_id:Number(e.id)}))},c=(0,Qe.qj)({value:"",selected:{name:"",value:-1},isGeneration:!1,list:(0,l.Fl)((()=>{const e=Ei.Z.state.documents.templates;return e?.map((e=>{e.value=e.id})),e?.filter((e=>e.name?.toUpperCase()?.includes(c.value?.toUpperCase())))})),select:function(e){this.selected=e}}),u=async()=>{c.isGeneration=!0,t(!0);const s=await Ei.Z.dispatch("generateOrderDoc",{order_id:Number(e.id),doc_tpl_id:c.selected.id});c.isGeneration=!1,console.log(s),d()},p=async s=>{t(!0),await Ei.Z.dispatch("deleteOrderDoc",{order_id:e.id,doc_id:s}),d()};return{docs:c,generate:u,docsList:r,delDoc:p,uploadFiles:s,customDocList:i,getCustomDocList:a,deleteCustomDoc:o,isUpload:n}}};const Ia=(0,at.Z)(Aa,[["render",Fa],["__scopeId","data-v-1ce7a618"]]);var Ha=Ia;const Ta={class:"grid grid-cols-2 justify-items-center items-start w-4/5 mx-auto gap-10 mt-4"},Ya={class:"font-semibold text-gray-700 w-full text-center my-2"};function za(e,t,s,a,o,n){const r=(0,l.up)("AppInputSelect"),d=(0,l.up)("ClientTabItem");return(0,l.wg)(),(0,l.iD)("div",Ta,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.autocompleteList,(e=>((0,l.wg)(),(0,l.j4)(r,{class:"w-1/2 mx-auto",key:e.id,placeholder:e.placeholder,list:e.list,selected:e.selected,countLettersReq:3,onChangeInputValue:t=>e.changeInputValue(t),onSelect:t=>e.select(t)},null,8,["placeholder","list","selected","onChangeInputValue","onSelect"])))),128)),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(a.list,(e=>((0,l.wg)(),(0,l.iD)("div",{key:e,class:"w-full flex flex-col items-center"},[(0,l._)("h2",Ya,(0,C.zw)(e.name),1),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.items,(t=>(0,l.wy)(((0,l.wg)(),(0,l.j4)(d,{key:t?.id,item:t,fields:e.fields,placeholders:e.placeholders,alwaysShow:1===e.items.length,onUnLink:()=>a.unLink(t,e),onLink:()=>a.link(t)},null,8,["item","fields","placeholders","alwaysShow","onUnLink","onLink"])),[[i.F8,t]]))),128))])))),128))])}const Za={class:"min-w-0 flex-auto text-left"},$a={class:"text-lg font-semibold leading-6 text-gray-800"},Ea={class:"mt-1 truncate text-sm leading-5 text-gray-500"},Oa={class:"sm:flex sm:flex-col sm:items-end"},Ua={class:"text-base leading-6 text-gray-900"},Ba={class:"flex flex-row gap-2 items-center mt-1"},Ma={class:"text-sm leading-5 text-gray-500"},Na={key:1,class:"min-w-[40%] w-full text-gray-900 divide-y divide-gray-200 dark:text-white dark:divide-gray-700"},Ka={class:"mb-1 text-gray-500 md:text-base dark:text-gray-400"},Ra={class:"text-base font-medium"};function Ga(e,t,s,i,a,o){return(0,l.wg)(),(0,l.iD)("li",{class:(0,C.C_)(["flex justify-between max-w-xl px-6 py-5 rounded-xl w-full transition-all relative mt-1",{"bg-slate-100":i.show,"cursor-pointer, hover:bg-slate-50":!s.alwaysShow,"bg-slate-50":!s.alwaysShow&&!s.item?.isUnLink}]),onClick:t[1]||(t[1]=()=>s.alwaysShow?null:i.toggle())},[i.show||s.alwaysShow?((0,l.wg)(),(0,l.iD)("div",Na,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.fields,(e=>((0,l.wg)(),(0,l.iD)("div",{class:"flex flex-col pb-3 items-start w-full",key:e.code},[(0,l._)("div",Ka,(0,C.zw)(e.name),1),(0,l._)("div",Ra,(0,C.zw)(s.item?.fields?.[e.code]),1)])))),128))])):((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l._)("div",Za,[(0,l._)("p",$a,(0,C.zw)(s.item?.fields?.[s.placeholders.title]),1),(0,l._)("p",Ea,(0,C.zw)(s.item?.fields?.[s.placeholders.subTitle]),1)]),(0,l._)("div",Oa,[(0,l._)("p",Ua,(0,C.zw)(s.item?.fields?.[s.placeholders.descriton]),1),(0,l._)("div",Ba,[(0,l._)("div",{class:"w-4 h-4 rounded-full flex items-center justify-center",style:(0,C.j5)({"background-color":i.getColor(10*s.item?.fields?.[s.placeholders.subDescriton])+"50"})},[(0,l._)("div",{class:"w-2 h-2 rounded-full",style:(0,C.j5)({"background-color":i.getColor(10*s.item?.fields?.[s.placeholders.subDescriton])+"99"})},null,4)],4),(0,l._)("p",Ma,(0,C.zw)(s.item?.fields?.[s.placeholders.subDescriton]),1)])])],64)),s.alwaysShow||i.show?((0,l.wg)(),(0,l.iD)("button",{key:2,class:"btn absolute top-5 right-4 bg-transparent focus-visible:underline focus-visible:underline-offset-4 hover:underline hover:underline-offset-4",onClick:t[0]||(t[0]=e=>s.item?.isUnLink?i.link():i.unLink())},(0,C.zw)(s.item?.isUnLink?"Привязать":" Отвязать"),1)):(0,l.kq)("",!0)],2)}var Xa=s(8089),Ja={props:{item:Object,placeholders:Object,fields:Array,alwaysShow:Boolean},emits:["unLink","link"],setup(e,t){const{getColor:s}=(0,Xa.a)(),[l,i]=(0,bi.OT)(!1),a=()=>t.emit("unLink"),o=()=>t.emit("link");return{show:l,toggle:i,getColor:s,unLink:a,link:o}}};const Qa=(0,at.Z)(Ja,[["render",Ga],["__scopeId","data-v-c4872f00"]]);var eo=Qa;function to(e){const{order:t,getOrder:s,saveOrder:l,toggleSomeChange:i}=(0,$i.r)(),a=(0,Qe.qj)({code:e.code,placeholder:e.placeholder,selected:{},value:"",list:[],getList:async function(){this.list=await Ei.Z.dispatch(e.getUrl,{q:this.value,order_id:t.id}),this.list.map((e=>e.name=e.label))},changeInputValue:function(e){this.value=e,this.getList()},select:async function(a){i(!0),e.multi?(void 0===t[e.field]&&(t[e.field]=[]),t[e.field].push(a.id)):t[e.field]=a.id,await l(),s()}});return a}var so={components:{AppInputSelect:ja.Z,ClientTabItem:eo},setup(){const{order:e,getOrder:t,saveOrder:s,toggleSomeChange:i}=(0,$i.r)();(0,l.bv)((()=>{a.forEach((e=>e.fields.length?null:Ei.Z.dispatch(e.getFieldsUrl)))})),setTimeout((()=>console.log(e)),1e3);const a=(0,Qe.qj)([{name:"Компания",code:"Company",getFieldsUrl:"getClientsCompanyFields",getAutocompeteUrl:"getClientsCompanyAutocomplete",fields:(0,l.Fl)((()=>Ei.Z.state.clientsCompany.fields)),items:(0,l.Fl)((()=>[e?.company])),placeholderForSearch:"Поиск компаний",orderFieldForSave:"company_id",placeholders:{title:"name",subTitle:"signatory",descriton:"director",subDescriton:"rating"}},{name:"Контакт",code:"Contacts",getFieldsUrl:"getClientsContactsFields",getAutocompeteUrl:"getClientsContactsAutocomplete",fields:(0,l.Fl)((()=>Ei.Z.state.clientsContacts.fields)),items:(0,l.Fl)((()=>[...e?.company?.contacts.filter((e=>!a[1].linkedIds.includes(e.id))).map((e=>Object.assign(e,{isUnLink:!0})))||[],...e?.contacts||[]])),linkedIds:(0,l.Fl)((()=>e?.contacts.reduce(((e,t)=>(e.push(t.id),e)),[]))),placeholderForSearch:"Поиск контактов",orderFieldForSave:"contacts_id",isMultiSave:!0,placeholders:{title:"name",subTitle:"phone",descriton:"email",subDescriton:"rating"}}]),o=(0,Qe.qj)([]);a.forEach((e=>o.push(to({getUrl:e.getAutocompeteUrl,code:e.code,placeholder:e.placeholderForSearch,multi:Boolean(e.isMultiSave),field:e.orderFieldForSave}))));const n=async(l,a)=>{i(!0),a.isMultiSave?(void 0===e[a.field]&&(e[a.orderFieldForSave]=[]),e[a.orderFieldForSave]=e[a.orderFieldForSave].filter((e=>e!==l.id))):e[a.orderFieldForSave]=0,await s(),t()},r=e=>o.find((e=>"Contacts"===e.code)).select(e);return{list:a,autocompleteList:o,unLink:n,link:r}}};const lo=(0,at.Z)(so,[["render",za],["__scopeId","data-v-4e719d72"]]);var io=lo,ao=s(906),oo={components:{ProductsTab:sa,DocumentsTab:Ha,ClientTab:io,AppRadioBtnsGroupUnderlined:ao.Z},setup(){const{add:e,saveParams:t}=(0,$i.r)(),{tabs:s}=Ci(),i=()=>v.Z.push("/");return(0,l.bv)((async()=>{e()})),{tabs:s,back:i,saveParams:t}}};const no=(0,at.Z)(oo,[["render",m],["__scopeId","data-v-65eed9b3"]]);var ro=no}}]);
//# sourceMappingURL=804.ace7b18a.js.map