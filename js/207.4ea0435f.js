"use strict";(self["webpackChunkstorage"]=self["webpackChunkstorage"]||[]).push([[207],{7614:function(e,t,s){s.d(t,{M:function(){return o}});var i=s(6413);function o(e="timer",t=3e3,s=!1){const[o,l]=(0,i.OT)(s),a=async(s=e,i,o)=>{if(l(!0),"timer"===s)setTimeout((()=>l(!1)),i||t);else if("async"===s&&o)await o,l(!1);else if("asyncWithTimer"===s&&o)setTimeout((async()=>{await o,l(!1)}),i||t);else if("handle"===s)return},r=()=>l(!1);return{isLocked:o,lockBtn:a,handleUnLock:r}}},6515:function(e,t,s){s.d(t,{Z:function(){return u}});var i=s(3396),o=s(7139);function l(e,t,s,l,a,r){const n=(0,i.up)("AppPaginator"),d=(0,i.up)("selector-vue");return s.show?((0,i.wg)(),(0,i.iD)("div",{key:0,class:(0,o.C_)(["bottom",{blur:s.blur}])},[s.showBtns?((0,i.wg)(),(0,i.j4)(n,{key:0,page:s.page,disabled:s.disabled,onChangePage:r.changePage},null,8,["page","disabled","onChangePage"])):(0,i.kq)("",!0),s.showSelector?((0,i.wg)(),(0,i.j4)(d,{key:1,disabled:s.disabled,class:"count",options_props:a.count_values,selected_option:{name:s.count,value:-1},onSelect:r.change_count},null,8,["disabled","options_props","selected_option","onSelect"])):(0,i.kq)("",!0)],2)):(0,i.kq)("",!0)}var a=s(7720),r=s(7570),n={components:{SelectorVue:a.Z,AppPaginator:r.Z},props:{previous:{type:Boolean,required:!1},next:{type:Boolean,required:!1},page:{type:Object,required:!1,default(){return{first:1,prev:null,current:1,next:null,last:1}}},count:{type:Number,required:!0},blur:{type:Boolean,required:!1,default:!1},show:{type:Boolean,required:!1,default:!0},showBtns:{type:Boolean,required:!1,default:!0},showSelector:{type:Boolean,required:!1,default:!0},disabled:{type:Boolean,required:!1,default:!1}},emits:{changePage:null,changeCount:null},data(){return{count_values:[]}},async mounted(){await this.$store.dispatch("get_account"),this.$store.state.account.user.config.per_pages&&(this.count_values=[...this.$store.state.account.user.config.per_pages].map(((e,t)=>({name:e,value:t}))))},computed:{},methods:{changePage(e){this.$emit("changePage",e)},change_count(e){this.$emit("changeCount",e.name)}}},d=s(89);const c=(0,d.Z)(n,[["render",l],["__scopeId","data-v-4bee144d"]]);var u=c},5207:function(e,t,s){s.r(t),s.d(t,{default:function(){return Ai}});var i=s(3396),o=s(7139),l=s(9242);const a=e=>((0,i.dD)("data-v-a5c95a28"),e=e(),(0,i.Cn)(),e),r={class:"header_left"},n={class:"header_row"},d={class:"filters_left"},c={class:"date"},u={class:"flex flex-row gap-5 items-center min-h-[34px]"},p=["value"],_={class:"bot"},h={for:"grid"},g={key:0,class:"material-icons-round icon"},m={key:1,class:"material-icons-round icon"},f={key:0,class:"flex items-center"},v={for:"is_in_wh"},w={class:"filters_right"},b=["disabled","title"],y=a((()=>(0,i._)("span",{class:"material-icons-outlined"}," sync ",-1))),k=[y],C=["title"],P=a((()=>(0,i._)("span",{class:"material-icons"}," settings ",-1))),S=[P],F={class:"grid"};function $(e,t,s,a,y,P){const $=(0,i.up)("HomeModals"),x=(0,i.up)("NavBar"),I=(0,i.up)("HomeImportOldData"),D=(0,i.up)("HomeWhs"),E=(0,i.up)("HomeMenu"),W=(0,i.up)("HomeBtns"),q=(0,i.up)("HomeFilter"),j=(0,i.up)("main-grid"),H=(0,i.up)("card-grid");return(0,i.wg)(),(0,i.iD)("div",{class:(0,o.C_)(["app",{disabled:e.disabled_for_modals||P.account?.is_old_data_load_start&&!P.account?.is_old_data_loaded}])},[(0,i.Wm)($,{selectedWH:y.selectedWH,currentItems:y.currentItems,onUpdateProducts:P.updateProducts},null,8,["selectedWH","currentItems","onUpdateProducts"]),(0,i._)("div",{class:(0,o.C_)(["header",{blur:e.disabled_for_modals}])},[(0,i._)("div",r,[(0,i._)("div",n,[(0,i.Wm)(x),(0,i.Wm)(I,{ref:"oldData",onImportComplete:P.importComplete},null,8,["onImportComplete"])]),(0,i.Wm)(D,{ref:"homeWhs",selectedWH:y.selectedWH,"onUpdate:selectedWH":t[0]||(t[0]=e=>y.selectedWH=e),class:(0,o.C_)({"pointer-events-none":P.isLoadingProducts})},null,8,["selectedWH","class"])]),(0,i.Wm)(E)],2),(0,i._)("div",{class:(0,o.C_)(["wrapper",{blur:e.home_blur,"pointer-events-none":P.isLoadingProducts}])},[(0,i._)("div",{class:(0,o.C_)(["filters",{blur:e.show_edit_modal}])},[(0,i._)("div",d,[(0,i._)("div",c,[(0,i._)("div",u,[a.isTest?((0,i.wg)(),(0,i.iD)("input",{key:0,type:"date",id:"start",name:"trip-start",value:P.date,min:"2000-01-01",max:"2032-12-31","aria-required":"true","aria-invalid":"false"},null,8,p)):(0,i.kq)("",!0),(0,i.Wm)(W,{isServicePage:P.isServicePage,onArchive_data:P.archive_data,onSetCurrentItems:P.setCurrentItems},null,8,["isServicePage","onArchive_data","onSetCurrentItems"])]),(0,i._)("div",_,[(0,i._)("p",null,(0,o.zw)(a.t("Archive.count",{count:P.totalCountProducts})),1),(0,i.wy)((0,i._)("input",{type:"checkbox",class:"checkbox grid","onUpdate:modelValue":t[1]||(t[1]=e=>y.isGrid=e),id:"grid"},null,512),[[l.e8,y.isGrid]]),(0,i._)("label",h,[(0,i.Wm)(l.uT,{name:"modal",mode:"out-in"},{default:(0,i.w5)((()=>[y.isGrid?((0,i.wg)(),(0,i.iD)("span",g," format_list_bulleted ")):((0,i.wg)(),(0,i.iD)("span",m," grid_view "))])),_:1})]),P.isServicePage?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",f,[(0,i.wy)((0,i._)("input",{type:"checkbox",id:"is_in_wh",class:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>y.is_in_wh=e)},null,512),[[l.e8,y.is_in_wh]]),(0,i._)("label",v,(0,o.zw)(e.$t("ostatki.inWH")),1)])),y.isGrid?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(q,{key:1,onConfirmFilters:P.confirmFilters,onClearFilters:P.clearFilters},null,8,["onConfirmFilters","onClearFilters"]))])])]),(0,i._)("div",w,[P.oneC||!a.currentSetSettingsInFolder.editItem&&!a.editing_remains?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("button",{key:0,class:"button button_4 smallBtn",onClick:t[3]||(t[3]=e=>P.open_close_new_position(!0))},(0,o.zw)(e.$t("ostatki.newPoz")),1)),(0,i._)("button",{class:"sync_icon btn",disabled:y.isUpdateProducts,onClick:t[4]||(t[4]=e=>P.updateProducts()),title:a.t("ostatki.syncT")},k,8,b),y.isGrid?((0,i.wg)(),(0,i.iD)("button",{key:1,class:"table_settings_btn",onClick:t[5]||(t[5]=e=>P.openTableSettings()),title:a.t("ostatki.settingsT")},S,8,C)):(0,i.kq)("",!0)])],2),(0,i._)("div",F,[y.isGrid?((0,i.wg)(),(0,i.j4)(H,{key:1,ref:"card",selectedWH:y.selectedWH},null,8,["selectedWH"])):((0,i.wg)(),(0,i.j4)(j,{key:0,ref:"main",selectedWH:y.selectedWH},null,8,["selectedWH"]))])],2)],2)}const x=e=>((0,i.dD)("data-v-9de869de"),e=e(),(0,i.Cn)(),e),I=x((()=>(0,i._)("th",{class:"head_cell_table_preloader"},null,-1))),D=x((()=>(0,i._)("th",{class:"cell_table_preloader"},[(0,i._)("input",{type:"checkbox",class:"checkbox !cursor-default",id:1,disabled:""}),(0,i._)("label",{for:1})],-1))),E=x((()=>(0,i._)("td",{class:"head_cell_table_preloader"},null,-1))),W=x((()=>(0,i._)("td",{class:"cell_table_preloader"},[(0,i._)("div",{class:"edit_icon !cursor-default"})],-1))),q={key:0},j={key:0,class:"item"},H=["id","onUpdate:modelValue","onChange"],Z=["for"],T={key:0,class:"item"},z=["onClick"],L={key:1,class:"item"},O={key:2,class:"item"},B={key:0},A={key:1},G=["onClick","title"],Y={class:"item"},V=["onClick","title"],N={key:0,class:"text"};function U(e,t,s,a,r,n){const d=(0,i.up)("edit-item"),c=(0,i.up)("GridEditPrice"),u=(0,i.up)("AppTablePreloader"),p=(0,i.up)("main-grid-bar"),_=(0,i.up)("main-grid-filters"),h=(0,i.up)("AppImagesCarusel"),g=(0,i.up)("grid-bottom");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",{class:(0,o.C_)(["wrapper",{blur:n.isDataLoading&&!1}])},[((0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[e.show_edit_modal?((0,i.wg)(),(0,i.j4)(d,{key:0,edit_data:r.edit_data},null,8,["edit_data"])):(0,i.kq)("",!0)])),((0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[n.showEditPrice?((0,i.wg)(),(0,i.j4)(c,{key:0,editPrice:r.editPrice,onClose:t[0]||(t[0]=e=>n.get_products(n.productsParams))},null,8,["editPrice"])):(0,i.kq)("",!0)])),n.isDataLoading?((0,i.wg)(),(0,i.j4)(u,{key:0,titles:n.titlesForPreloader},{customCellHeadStart:(0,i.w5)((()=>[I])),customCellStart:(0,i.w5)((()=>[D])),customCellHeadEnd:(0,i.w5)((()=>[E])),customCellEnd:(0,i.w5)((()=>[W])),_:1},8,["titles"])):(0,i.kq)("",!0),(0,i._)("div",{class:(0,o.C_)(["main",{hidden:n.isDataLoading}])},[(0,i._)("table",{class:(0,o.C_)(["table",{blur:e.show_edit_modal}]),ref:"table"},[(0,i._)("thead",null,[(0,i.Wm)(p,{ref:"bar",fields:n.all_fields,onSort:n.sort,onChangeAllSelectedProducts:n.changeAllSelectedProducts,tableConfig:n.tableConfig,sortedFields:n.sortedFields,class:"main-grid-bar"},null,8,["fields","onSort","onChangeAllSelectedProducts","tableConfig","sortedFields"]),(0,i.Wm)(_,{ref:"filters",fields:n.all_fields,tableConfig:n.tableConfig,sortedFields:n.sortedFields},null,8,["fields","tableConfig","sortedFields"])]),n.products.length?((0,i.wg)(),(0,i.iD)("tbody",q,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.products,((t,s)=>((0,i.wg)(),(0,i.iD)("tr",{class:"row",key:t.id},[n.oneC||!a.currentSetSettingsInFolder.editItem&&!a.change_remains?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("td",j,[void 0!=r.selectedProducts[s]?(0,i.wy)(((0,i.wg)(),(0,i.iD)("input",{key:0,type:"checkbox",class:"checkbox",id:t.id,"onUpdate:modelValue":e=>r.selectedProducts[s].value=e,onChange:e=>r.selectedProducts[s].item=t},null,40,H)),[[l.e8,r.selectedProducts[s].value]]):(0,i.kq)("",!0),(0,i._)("label",{for:t.id},null,8,Z)])),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.sortedFields,(s=>((0,i.wg)(),(0,i.iD)(i.HY,{key:s},["reserve"===s[0].split(".")[1]?((0,i.wg)(),(0,i.iD)("td",T,[(0,i._)("a",{class:"link",onClick:e=>n.followOrdersList(t.id,s[0].split(".")[0])},(0,o.zw)(t.fields?.[s[0].split(".")[0]]?.[s[0].split(".")[1]]),9,z)])):15===s[1].type?((0,i.wg)(),(0,i.iD)("td",L,[(0,i.Wm)(h,{imagesList:t.fields[s[0]]},null,8,["imagesList"])])):((0,i.wg)(),(0,i.iD)("td",O,[s[0].split(".").length<2?((0,i.wg)(),(0,i.iD)("span",B,(0,o.zw)(6===s[1].type?t.fields[s[0]+"_string"]:"free_4_reserve"===s[0]&&-1==t.fields[s[0]]?"∞":"category"==s[0]?n.categories[t.fields[s[0]]]:9==s[1].type?t.fields[s[0]]?e.$t("global.yes"):e.$t("global.no"):"cost_price"==s[0]?t.fields[s[0]]?Math.round(100*t.fields[s[0]])/100:"0":t.fields[s[0]]),1)):((0,i.wg)(),(0,i.iD)("span",A,(0,o.zw)("cost"==s[0].split(".")[1]?a.checkIsNull(t.fields?.[s[0].split(".")[0]]?.[s[0].split(".")[1]])+" "+(t.fields?.[s[0].split(".")[0]]?.currency||""):9==s[1].type?Boolean(t.fields?.[s[0].split(".")[0]]?.[s[0].split(".")[1]])?e.$t("global.yes"):e.$t("global.no"):t.fields?.[s[0].split(".")[0]]?.[s[0].split(".")[1]]),1)),(0,i.Uk)("   "),"cost"==s[0].split(".")[1]?((0,i.wg)(),(0,i.iD)("button",{key:2,class:"edit_icon",style:{width:"16px",heigth:"16px"},onClick:e=>n.openGridEditPrice(t,s[0].split(".")[0]),title:a.t("ostatki.changePrice")},null,8,G)):(0,i.kq)("",!0)]))],64)))),128)),(0,i._)("td",Y,[a.currentSetSettingsInFolder.editItem||a.editing_remains?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"edit_icon",onClick:e=>n.open_edit_modal(t),title:a.t("ostatki.changePoz")},null,8,V)):(0,i.kq)("",!0)])])))),128))])):(0,i.kq)("",!0)],2),0==n.products.length?((0,i.wg)(),(0,i.iD)("label",N,(0,o.zw)(a.t("global.nothingFound")),1)):(0,i.kq)("",!0)],2),(0,i.Wm)(g,{page:n.page,blur:e.show_edit_modal,show:0!=n.products.length,count:n.count,showBtns:n.showGridBottom,disabled:n.isDataLoading,onChangePage:n.changePage,onChangeCount:n.changeCount},null,8,["page","blur","show","count","showBtns","disabled","onChangePage","onChangeCount"])],2),r.showArrow?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"arrow",onClick:t[1]||(t[1]=e=>n.scrollUp())})):(0,i.kq)("",!0)],64)}const M={class:"background_edit_modal"},K={class:"app_edit_modal"},R={class:"header"},X={class:"header_left"},J={class:"header_right"},Q=(0,i._)("div",{class:"hr"},null,-1),ee={class:"main"},te={class:"row"},se={class:"row"},ie=(0,i._)("div",{class:"hr"},null,-1),oe={class:"footer"};function le(e,t,s,a,r,n){const d=(0,i.up)("BtnsSaveClose"),c=(0,i.up)("SelectorVue"),u=(0,i.up)("edit-item-fields");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",{class:"backdrop_with_filter",onClick:t[0]||(t[0]=(0,l.iM)((e=>n.close()),["self"]))}),(0,i._)("div",M,[(0,i._)("div",K,[(0,i._)("div",R,[(0,i._)("div",X,(0,o.zw)(e.$t("ostatki.red",{name:s.edit_data.fields["name"]})),1),(0,i._)("div",J,[(0,i.Wm)(d,{onClose:n.close,onSave:n.save,disabledSave:a.isLocked},(0,i.Nv)({close:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(e.$t("global.сancel")),1)])),_:2},[n.oneC?void 0:{name:"other_btns",fn:(0,i.w5)((()=>[(0,i._)("button",{class:"btn btn3",onClick:t[1]||(t[1]=e=>n.archive())},(0,o.zw)(e.$t("ostatki.arch")),1)])),key:"0"}]),1032,["onClose","onSave","disabledSave"])])]),Q,(0,i._)("div",ee,[(0,i._)("div",te,[(0,i._)("label",null,(0,o.zw)(e.$t("ostatki.type")),1),(0,i.Wm)(c,{options_props:r.options_1,onSelect:n.option_select_1,selected_option:r.selected_option_1,disabled:n.oneC||!0},null,8,["options_props","onSelect","selected_option","disabled"])]),(0,i._)("div",se,[(0,i._)("label",null,(0,o.zw)(e.$t("ostatki.cat")),1),(0,i.Wm)(c,{options_props:r.categories_options,onSelect:n.option_select_cat,selected_option:r.selectedCategory},null,8,["options_props","onSelect","selected_option"])]),(0,i.Wm)(u,{new_edit_data:r.new_edit_data,onChange_value:n.change_value,onChangeEditPrices:n.changeEditPrices},null,8,["new_edit_data","onChange_value","onChangeEditPrices"])]),ie,(0,i._)("div",oe,[(0,i.Wm)(d,{onClose:n.close,onSave:n.save,disabledSave:a.isLocked},(0,i.Nv)({close:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(e.$t("global.сancel")),1)])),_:2},[n.oneC?void 0:{name:"other_btns",fn:(0,i.w5)((()=>[(0,i._)("button",{class:"btn btn3",onClick:t[2]||(t[2]=e=>n.archive())},(0,o.zw)(e.$t("ostatki.arch")),1)])),key:"0"}]),1032,["onClose","onSave","disabledSave"])])])])],64)}var ae=s(7720),re=s(8711);function ne(e,t,s,o,l,a){const r=(0,i.up)("edit-integer"),n=(0,i.up)("edit-float"),d=(0,i.up)("edit-string"),c=(0,i.up)("edit-text"),u=(0,i.up)("edit-selector"),p=(0,i.up)("edit-multi-selector"),_=(0,i.up)("edit-date"),h=(0,i.up)("edit-date-time"),g=(0,i.up)("edit-flag"),m=(0,i.up)("edit-price"),f=(0,i.up)("edit-wh"),v=(0,i.up)("edit-img-list");return(0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(l.copy_fields_with_parents,(e=>((0,i.wg)(),(0,i.iD)("div",{class:"row",key:e.id},[1==e.type?((0,i.wg)(),(0,i.j4)(r,{key:0,item:e.name,selected_option:s.new_edit_data.fields[e.code],idx:e.code,disabled:!e.is_editable,onChange_value:a.change_value},null,8,["item","selected_option","idx","disabled","onChange_value"])):(0,i.kq)("",!0),2==e.type?((0,i.wg)(),(0,i.j4)(n,{key:1,item:e.name,selected_option:s.new_edit_data.fields[e.code],idx:e.code,disabled:!e.is_editable,onChange_value:a.change_value},null,8,["item","selected_option","idx","disabled","onChange_value"])):(0,i.kq)("",!0),3==e.type?((0,i.wg)(),(0,i.j4)(d,{key:2,item:e.name,selected_option:s.new_edit_data.fields[e.code],idx:e.code,disabled:!e.is_editable,onChange_value:a.change_value},null,8,["item","selected_option","idx","disabled","onChange_value"])):(0,i.kq)("",!0),4==e.type?((0,i.wg)(),(0,i.j4)(c,{key:3,item:e.name,selected_option:s.new_edit_data.fields[e.code],idx:e.code,disabled:!e.is_editable,onChange_value:a.change_value},null,8,["item","selected_option","idx","disabled","onChange_value"])):(0,i.kq)("",!0),5==e.type?((0,i.wg)(),(0,i.j4)(u,{key:4,item:e,selected_option:s.new_edit_data.fields[e.code],idx:e.code,disabled:!e.is_editable,onChange_value:a.change_value},null,8,["item","selected_option","idx","disabled","onChange_value"])):(0,i.kq)("",!0),6==e.type?((0,i.wg)(),(0,i.j4)(p,{key:5,item:e,selected_option:s.new_edit_data.fields[e.code],idx:e.code,disabled:!e.is_editable,onChange_value:a.change_value},null,8,["item","selected_option","idx","disabled","onChange_value"])):(0,i.kq)("",!0),7==e.type?((0,i.wg)(),(0,i.j4)(_,{key:6,item:e.name,selected_option:s.new_edit_data.fields[e.code],idx:e.code,disabled:!e.is_editable,onChange_value:a.change_value},null,8,["item","selected_option","idx","disabled","onChange_value"])):(0,i.kq)("",!0),8==e.type?((0,i.wg)(),(0,i.j4)(h,{key:7,item:e.name,selected_option:s.new_edit_data.fields[e.code],idx:e.code,disabled:!e.is_editable,onChange_value:a.change_value},null,8,["item","selected_option","idx","disabled","onChange_value"])):(0,i.kq)("",!0),9==e.type?((0,i.wg)(),(0,i.j4)(g,{key:8,item:e.name,selected_option:s.new_edit_data.fields[e.code],idx:e.code,disabled:!e.is_editable,onChange_value:a.change_value},null,8,["item","selected_option","idx","disabled","onChange_value"])):(0,i.kq)("",!0),11==e.type?((0,i.wg)(),(0,i.j4)(m,{key:9,item:e.name,selected_option:s.new_edit_data.fields[e.code],idx:e.code,disabled:!e.is_editable,currencies:l.currencies,onChange_value:a.change_value,onChangeEditPrice:a.changeEditPrice},null,8,["item","selected_option","idx","disabled","currencies","onChange_value","onChangeEditPrice"])):(0,i.kq)("",!0),13==e.type?((0,i.wg)(),(0,i.j4)(f,{key:10,item:e.name,selected_option:s.new_edit_data.fields[e.code],idx:e.code,disabled:!e.is_editable,onChange_value:a.change_value},null,8,["item","selected_option","idx","disabled","onChange_value"])):(0,i.kq)("",!0),15==e.type?((0,i.wg)(),(0,i.j4)(v,{key:11,item:e.name,selected_option:s.new_edit_data.fields[e.code],idx:e.code,disabled:!e.is_editable,onChange_value:a.change_value},null,8,["item","selected_option","idx","disabled","onChange_value"])):(0,i.kq)("",!0)])))),128)}var de=s(1240),ce=s(4299),ue=s(4031),pe=s(267),_e=s(8727),he=s(8484),ge=s(962),me=s(4846),fe=s(1042);const ve={class:"row"},we={class:"right"},be={key:0,class:"qew"},ye={for:"0"};function ke(e,t,s,a,r,n){const d=(0,i.up)("edit-float"),c=(0,i.up)("edit-selector"),u=(0,i.up)("edit-flag");return(0,i.wg)(),(0,i.iD)("div",ve,[(0,i._)("label",null,(0,o.zw)(s.item)+":",1),(0,i._)("div",we,[(0,i.Wm)(d,{item:a.t("Edit.zn"),selected_option:r.copy_selected_option?.cost,idx:s.idx+"cost",disabled:s.disabled,onChange_value:t[0]||(t[0]=e=>n.option_select(e,"cost"))},null,8,["item","selected_option","idx","disabled"]),n.isNewPrice?((0,i.wg)(),(0,i.iD)("div",be,[(0,i.wy)((0,i._)("input",{type:"checkbox",id:"0",class:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>r.editPrice.is_update_leads=e)},null,512),[[l.e8,r.editPrice.is_update_leads]]),(0,i._)("label",ye,(0,o.zw)(e.$t("Edit.iz")),1)])):(0,i.kq)("",!0),(0,i.Wm)(c,{item:{name:a.t("Edit.val"),data:s.currencies},selected_option:r.copy_selected_option?.currency,idx:s.idx+"currency",disabled:s.disabled,onChange_value:t[2]||(t[2]=(e,t,s)=>n.option_select(e,"currency",s,t))},null,8,["item","selected_option","idx","disabled"]),(0,i.Wm)(u,{item:a.t("Edit.nds1"),selected_option:r.copy_selected_option?.is_nds,idx:s.idx+"is_nds",disabled:s.disabled,onChange_value:t[3]||(t[3]=e=>n.option_select(e,"is_nds"))},null,8,["item","selected_option","idx","disabled"]),(0,i.Wm)(l.W3,{name:"modal"},{default:(0,i.w5)((()=>[r.copy_selected_option?.is_nds?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[(0,i.kq)("",!0),(0,i.Wm)(u,{item:a.t("Edit.nds3"),selected_option:r.copy_selected_option?.is_price_include_nds,idx:s.idx+"is_price_include_nds",disabled:s.disabled,onChange_value:t[5]||(t[5]=e=>n.option_select(e,"is_price_include_nds"))},null,8,["item","selected_option","idx","disabled"]),(0,i.Wm)(d,{item:a.t("Edit.nds4"),selected_option:r.copy_selected_option?.nds,idx:s.idx+"nds",disabled:s.disabled,onChange_value:t[6]||(t[6]=e=>n.option_select(e,"nds"))},null,8,["item","selected_option","idx","disabled"])],64)):(0,i.kq)("",!0)])),_:1})])])}var Ce=s(2489);const{t:Pe}=(0,Ce.j)();var Se={components:{EditFloat:ce.Z,EditSelector:_e.Z,EditFlag:fe.Z},props:{item:{type:String,required:!0,default(){return""}},selected_option:{type:Object,required:!0},idx:{type:String,required:!0},disabled:{type:Boolean,required:!1,default(){return!1}},currencies:{type:Array}},setup(){return{t:Pe}},data(){return{copy_selected_option:{},oldPrice:null,editPrice:{isNew:!0,price:"",is_update_leads:!1}}},mounted(){this.change_value(),(0,i.Y3)((()=>{this.oldPrice=this.selected_option.cost,void 0==this.selected_option.cost&&(this.oldPrice="",this.copy_selected_option.cost=""),this.dropEditPrice()}))},computed:{isNewPrice(){return this.oldPrice!=this.copy_selected_option?.cost},isChangePrice(){return{is_update_leads:this.editPrice.is_update_leads,cost:this.copy_selected_option.cost}}},watch:{selected_option:{handler:function(){this.change_value()},deep:!0},isNewPrice(){(0,i.Y3)((()=>{this.isNewPrice||this.dropEditPrice()}))},isChangePrice(){this.changeEditPrice()}},methods:{change_value(){(0,i.Y3)((()=>{this.copy_selected_option={...this.selected_option}}))},option_select(e,t,s){this.copy_selected_option[t]="currency"==t?s:e,this.$emit("change_value",this.copy_selected_option,this.idx)},dropEditPrice(){this.editPrice={isNew:!0,price:"",is_update_leads:!1}},changeEditPrice(){this.editPrice.isNew=this.isNewPrice,this.editPrice.price=this.copy_selected_option.cost,this.$emit("changeEditPrice",this.editPrice,this.idx)}}},Fe=s(89);const $e=(0,Fe.Z)(Se,[["render",ke],["__scopeId","data-v-38bc4d5c"]]);var xe=$e;const Ie={class:"row"},De={class:"right"};function Ee(e,t,s,l,a,r){const n=(0,i.up)("edit-integer");return(0,i.wg)(),(0,i.iD)("div",Ie,[(0,i._)("label",null,(0,o.zw)(s.item)+":",1),(0,i._)("div",De,[(0,i.Wm)(n,{item:l.t("Edit.ns"),selected_option:a.copy_selected_option?.count,idx:s.idx,disabled:s.disabled,onChange_value:t[0]||(t[0]=e=>r.option_select(e,"count"))},null,8,["item","selected_option","idx","disabled"]),(0,i.Wm)(n,{item:l.t("Edit.vr"),selected_option:a.copy_selected_option?.reserve,idx:s.idx,disabled:s.disabled,onChange_value:t[1]||(t[1]=e=>r.option_select(e,"reserve"))},null,8,["item","selected_option","idx","disabled"])])])}const{t:We}=(0,Ce.j)();var qe={components:{EditInteger:de.Z},props:{item:{type:String,required:!0,default(){return""}},selected_option:{type:Object,required:!0,default(){return{count:0,reserve:0}}},idx:{type:Number,required:!0},disabled:{type:Boolean,required:!1,default(){return!1}}},setup(){return{t:We}},data(){return{copy_selected_option:{}}},mounted(){this.change_value()},watch:{selected_option:{handler:function(){this.change_value()},deep:!0}},methods:{change_value(){(0,i.Y3)((()=>{this.copy_selected_option={...this.selected_option}}))},option_select(e,t){this.copy_selected_option[t]=e,this.$emit("change_value",this.copy_selected_option,this.idx)}}};const je=(0,Fe.Z)(qe,[["render",Ee],["__scopeId","data-v-48aa175b"]]);var He=je;const Ze={class:"row"},Te={class:"flex flex-row items-center justify-between w-full"},ze={class:"text-lg font-semibold mb-2"},Le={class:"text-lg font-semibold mb-1"},Oe={class:"list-decimal pl-2 mb-2"},Be={class:"text-lg font-semibold mb-1"},Ae={class:"list-decimal pl-2 mb-2"},Ge={class:"type_selector_options"},Ye=["onUpdate:modelValue"],Ve=["onClick"];function Ne(e,t,s,a,r,n){const d=(0,i.up)("AppTip");return(0,i.wg)(),(0,i.iD)("div",Ze,[(0,i._)("div",Te,[(0,i._)("label",null,(0,o.zw)(s.item)+":",1),(0,i.Wm)(d,{float:"left",separateWindow:!0},{default:(0,i.w5)((()=>[(0,i._)("h1",ze,(0,o.zw)(e.$t("Tips.EditImg.header")),1),(0,i._)("h2",Le,(0,o.zw)(e.$t("Tips.EditImg.GDHeader")),1),(0,i._)("ol",Oe,[(0,i._)("li",null,(0,o.zw)(e.$t("Tips.EditImg.GDStep1")),1),(0,i._)("li",null,(0,o.zw)(e.$t("Tips.EditImg.GDStep2")),1),(0,i._)("li",null,(0,o.zw)(e.$t("Tips.EditImg.GDStep3")),1),(0,i._)("li",null,(0,o.zw)(e.$t("Tips.EditImg.GDStep4")),1),(0,i._)("li",null,(0,o.zw)(e.$t("Tips.EditImg.GDStep5")),1),(0,i._)("li",null,(0,o.zw)(e.$t("Tips.EditImg.GDStep6")),1),(0,i._)("li",null,(0,o.zw)(e.$t("Tips.EditImg.GDStep7")),1)]),(0,i._)("h2",Be,(0,o.zw)(e.$t("Tips.EditImg.EHeader")),1),(0,i._)("ol",Ae,[(0,i._)("li",null,(0,o.zw)(e.$t("Tips.EditImg.EStep1")),1),(0,i._)("li",null,(0,o.zw)(e.$t("Tips.EditImg.EStep2")),1),(0,i._)("li",null,(0,o.zw)(e.$t("Tips.EditImg.EStep3")),1)])])),_:1})]),(0,i._)("div",Ge,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(r.copy_selected_option,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:"type_selector_option gap-2",key:t},[(0,i.wy)((0,i._)("input",{type:"text",class:"input","onUpdate:modelValue":e=>r.copy_selected_option[t]=e},null,8,Ye),[[l.nr,r.copy_selected_option[t]]]),(0,i._)("button",{class:"del_button",style:(0,o.j5)({visibility:0===t?"hidden":"visible"}),onClick:e=>n.del(t)},null,12,Ve)])))),128)),(0,i._)("button",{onClick:t[0]||(t[0]=e=>n.add()),class:"add_button"})])])}function Ue(e,t,s,l,a,r){return(0,i.wg)(),(0,i.iD)("div",{class:(0,o.C_)(["group/help",{relative:!s.separateWindow}])},[(0,i._)("span",{class:(0,o.C_)(["material-icons-outlined text-slate-500 !text-xl",{"cursor-pointer":s.separateWindow}]),onClick:t[0]||(t[0]=e=>l.toggleFullTip())}," help_outline ",2),s.separateWindow&&l.showFullTip?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"backdrop z-[252]",onClick:t[1]||(t[1]=e=>l.toggleFullTip(!1))})):(0,i.kq)("",!0),(0,i._)("div",{class:(0,o.C_)(["h-fit w-fit hidden z-[252] px-4 py-6 ring-1 ring-slate-500/50 rounded-md bg-white",{"left-0":"right"===s.float&&!s.separateWindow,"right-0":"left"===s.float&&!s.separateWindow,"!top-5 mx-auto max-h-[90vh] overflow-y-auto !fixed left-1/2 -translate-x-1/2":s.separateWindow,"-translate-y-1/2 top-1/2 absolute group-hover/help:block":!s.separateWindow,"!block":s.separateWindow&&l.showFullTip}])},[(0,i.WI)(e.$slots,"default")],2)],2)}var Me=s(6413),Ke={props:{float:{type:String,default:()=>"right",validator(e){return["right","left"].includes(e)}},separateWindow:{type:Boolean,default:()=>!1}},setup(){const[e,t]=(0,Me.OT)(!1);return(0,i.YP)(e,(e=>document.body.style.overflowY=e?"hidden":"auto")),{showFullTip:e,toggleFullTip:t}}};const Re=(0,Fe.Z)(Ke,[["render",Ue]]);var Xe=Re,Je={components:{AppTip:Xe},props:{item:{type:String,required:!0,default(){return""}},selected_option:{type:String,required:!0,default(){return""}},idx:{type:Number,required:!0},disabled:{type:Boolean,required:!1,default(){return!1}}},data(){return{copy_selected_option:[],isInitialCopy:!1}},mounted(){this.change_value()},watch:{selected_option(){this.change_value()},copy_selected_option:{handler:function(){this.isInitialCopy||this.option_select()},deep:!0}},methods:{change_value(){(0,i.Y3)((()=>{this.isInitialCopy=!0,this.copy_selected_option=[...this.selected_option],(0,i.Y3)((()=>this.isInitialCopy=!1))}))},option_select(){this.$emit("change_value",this.copy_selected_option,this.idx)},add(){this.copy_selected_option.push("")},del(e){this.copy_selected_option.splice(e,1)}}};const Qe=(0,Fe.Z)(Je,[["render",Ne],["__scopeId","data-v-3d5130fb"]]);var et=Qe,tt={components:{EditInteger:de.Z,EditFloat:ce.Z,EditString:ue.Z,EditText:pe.Z,EditSelector:_e.Z,EditMultiSelector:he.Z,EditDate:ge.Z,EditDateTime:me.Z,EditFlag:fe.Z,EditPrice:xe,EditWh:He,EditImgList:et},props:{new_edit_data:{type:Object,required:!0}},emits:{change_value:null},data(){return{copy_fields_with_parents:[],currencies:[],editPrices:[]}},async mounted(){await this.$store.dispatch("get_currencies"),Object.entries(this.$store.state.account.currencies).forEach((e=>this.currencies.push(e[1]))),this.currencies.map((e=>e.value=e.code_name)),(0,i.Y3)((async()=>{const e=this.new_edit_data.fields.category;await this.$store.dispatch("get_fields_with_parents",e),this.copy_fields_with_parents=[...this.$store.state.fields.fields_with_parents],this.fillEditPrices()}))},wath:{editPrices:{handler:function(){},deep:!0}},methods:{change_value(e,t){this.$emit("change_value",e,t)},fillEditPrices(){const e=this.copy_fields_with_parents.filter((e=>11==e.type));e.forEach((e=>this.editPrices.push({isNew:!1,product_id:this.new_edit_data.id,price:"",is_update_leads:!1,price_field_code:e.code})))},changeEditPrice(e,t){this.editPrices.map((s=>{s.price_field_code===t&&Object.assign(s,e)})),this.$emit("changeEditPrices",this.editPrices)}}};const st=(0,Fe.Z)(tt,[["render",ne],["__scopeId","data-v-0ea16fba"]]);var it=st,ot=s(7614);const{t:lt}=(0,Ce.j)(),{isLocked:at,lockBtn:rt,handleUnLock:nt}=(0,ot.M)();var dt={components:{SelectorVue:ae.Z,BtnsSaveClose:re.Z,EditItemFields:it},props:{edit_data:{type:Object,required:!0}},inject:["isServicePage"],setup(){return{isLocked:at}},data(){return{options_1:[{name:lt("ostatki.tov"),value:1},{name:lt("ostatki.ysl"),value:2}],selected_option_1:{name:lt("ostatki.tov"),value:1},new_edit_data:{},editPrices:[],categories_options:[],selectedCategory:{}}},computed:{oneC(){return this.$store.state.account.account?.config?.g_enabled},productsParams(){return this.$store.state.products.productsParams}},async mounted(){this.new_edit_data=JSON.parse(JSON.stringify(this.edit_data)),this.isServicePage?this.selected_option_1={...this.options_1[1]}:this.selected_option_1={...this.options_1[0]},await this.$store.dispatch("get_fields_properties"),this.get_categories_options(),this.searchSelectedCategory()},methods:{change_value(e,t){this.new_edit_data.fields[t]=e},option_select_1(e){this.selected_option_1={...e}},changeEditPrices(e){this.editPrices=[...e]},archive(){this.new_edit_data.is_archive=1,this.save()},close(){this.$store.commit("close_edit_modal")},async save(){rt("handle"),this.dataPreparation(),await this.$store.dispatch("update_product",{products:[this.new_edit_data]}),this.editPrices.forEach((async e=>{if(e.isNew){const t={...e};t.is_update_leads=t.is_update_leads?1:0,await this.$store.dispatch("setPrice",t)}})),this.$store.dispatch("get_products",this.productsParams),nt(),this.close()},dataPreparation(){const e=[],t=Object.keys(this.new_edit_data?.fields),s=[];this.$store.state.fields.fields_with_parents.forEach((e=>s.push(e.code))),t.forEach((t=>{s.includes(t)||e.push(t)})),e.forEach((e=>delete this.new_edit_data?.fields[e]))},option_select_cat(e){this.selectedCategory=e,this.new_edit_data.fields.category=e.value},get_categories_options(){this.$store.state.categories.fields_properties.forEach((e=>{let t="";for(let s=1;s<e.level;s++)t+="    ";this.categories_options.push({name:t+e.name,value:e.id})}))},searchSelectedCategory(){const e=this.categories_options.find((e=>e.value==this.new_edit_data?.fields?.category));void 0!=e&&(this.selectedCategory=e)}}};const ct=(0,Fe.Z)(dt,[["render",le]]);var ut=ct,pt=s(6515);const _t=e=>((0,i.dD)("data-v-fb425a72"),e=e(),(0,i.Cn)(),e),ht={class:"filters"},gt={class:"item",key:"b1"},mt=_t((()=>(0,i._)("th",{class:"item",key:"2b"},null,-1)));function ft(e,t,s,o,a,r){const n=(0,i.up)("filter-number"),d=(0,i.up)("filter-text"),c=(0,i.up)("filter-list"),u=(0,i.up)("filter-date"),p=(0,i.up)("filter-flag");return(0,i.wg)(),(0,i.j4)(l.uT,{name:"mdl1"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i._)("tr",ht,[(0,i.Wm)(l.W3,{name:"mdl"},{default:(0,i.w5)((()=>[r.oneC||!o.currentSetSettingsInFolder.editItem&&!o.change_remains?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("th",gt)),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.filtersValue,((t,s)=>(0,i.wy)(((0,i.wg)(),(0,i.iD)("th",{key:s,class:"item"},[t.table_config?.filtered?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[1==t.type||2==t.type?((0,i.wg)(),(0,i.j4)(n,{key:0,item:t,idx:s,onChange_filter_value:r.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,i.kq)("",!0),3==t.type||4==t.type?((0,i.wg)(),(0,i.j4)(d,{key:1,item:t,idx:s,onChange_filter_value:r.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,i.kq)("",!0),5==t.type||6==t.type?((0,i.wg)(),(0,i.j4)(c,{key:2,item:t,idx:s,selector_options:t.selector_options,onChange_filter_value:r.change_filter_value},null,8,["item","idx","selector_options","onChange_filter_value"])):(0,i.kq)("",!0),12==t.type?((0,i.wg)(),(0,i.j4)(c,{key:3,item:t,idx:s,selector_options:a.categories_options,onChange_filter_value:r.change_filter_value},null,8,["item","idx","selector_options","onChange_filter_value"])):(0,i.kq)("",!0),7==t.type||8==t.type?((0,i.wg)(),(0,i.j4)(u,{key:4,item:t,idx:s,onChange_filter_value:r.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,i.kq)("",!0),9==t.type?((0,i.wg)(),(0,i.j4)(p,{key:5,item:t,idx:s,onChange_filter_value:r.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,i.kq)("",!0)],64)):(0,i.kq)("",!0)],512)),[[l.F8,e.show_filter]]))),128)),mt])),_:1})],512),[[l.F8,e.show_filter]])])),_:1})}var vt=s(8701),wt=s(4197),bt=s(7438),yt=s(6323),kt=s(602),Ct=s(3276),Pt=s(65),St=s(8216),Ft=s(4581),$t={props:{fields:{type:Array,required:!0,default(){return[]}},sortedFields:{type:Array,required:!0,default(){return[]}},tableConfig:{type:Object}},components:{FilterNumber:vt.Z,FilterText:wt.Z,FilterList:bt.Z,FilterDate:yt.Z,FilterFlag:kt.Z},setup(){const{currentSetSettingsInFolder:e}=(0,St.h)("products"),t=(0,i.Fl)((()=>Ft.Z.state.account.user)),s=(0,i.Fl)((()=>t.value.config.change_remains));return{currentSetSettingsInFolder:e,change_remains:s}},data(){return{filtersValue:[],categories_options:[],isConfirmFilters:!1,filter:{}}},computed:{...(0,Pt.Se)(["show_filter"]),oneC(){return this.$store.state.account.account?.config?.g_enabled},productsParams(){return this.$store.state.products.productsParams}},async mounted(){await this.$store.dispatch("get_fields_properties"),this.get_categories_options(),await(0,Ct.L)((0,i.Fl)((()=>this.fields.length))),this.feelFilters()},watch:{sortedFields:{handler:function(){this.feelFilters()},deep:!0}},methods:{clearFilters(){this.feelFilters()},confirmFilters(){this.isConfirmFilters=!0;const e={};this.filtersValue.filter((e=>null!=e.value&&""!==e.value)).forEach((t=>{if(1!=t.type&&2!=t.type||(e[t.code]={compare:t.option,query:t.value}),3!=t.type&&4!=t.type||(e[t.code]={compare:t.option,query:t.value}),5!=t.type&&6!=t.type&&12!=t.type||t.value?.length&&(e[t.code]={compare:"in",query:t.value}),7==t.type){const s=t.value.split("~");s.forEach(((e,t)=>s[t]=e.split("-").join("."))),e[t.code]={from:s[0],to:s[1]}}if(8==t.type){const s=t.value.split("~");s.forEach(((e,t)=>{const i=e.split("T");i[0]=i[0].split("-").join("."),s[t]=i.join(" ")})),e[t.code]={from:s[0],to:s[1]}}})),this.filter=e,this.$store.commit("updateProductsParams",{filter:e,page:1}),this.$store.dispatch("get_products",this.productsParams)},change_filter_value(e,t){Object.assign(this.filtersValue[t],e)},setFalseIsConfirmFilters(){this.isConfirmFilters=!1},setTrueIsConfirmFilters(){this.isConfirmFilters=!0},feelFilters(){this.filtersValue=[];const e=[];this.sortedFields.forEach((t=>{let s={};s={...this.fields.filter((e=>e.code.split(".")[0]==t[0].split(".")[0]))[0]},s.type=t[1].type,s.code=t[0],e.push(s)})),e.forEach((e=>{const t=e=>{const t=[];return null!=e&&e.forEach(((e,s)=>t.push({name:e,value:s}))),t};let s=null;5!=e.type&&6!=e.type||(s=[]),9==e.type&&(s=1),12==e.type&&(s=[]);const i={type:e.type,code:e.code,option:"=",selector_options:t(e.data),value:s,table_config:e.table_config};this.filtersValue.push(i)}))},get_categories_options(){this.$store.state.categories.fields_properties.forEach((e=>{let t="";for(let s=1;s<e.level;s++)t+="-    ";this.categories_options.push({name:t+e.name,value:e.id})}))}}};const xt=(0,Fe.Z)($t,[["render",ft],["__scopeId","data-v-fb425a72"]]);var It=xt;const Dt=e=>((0,i.dD)("data-v-58be9cdf"),e=e(),(0,i.Cn)(),e),Et={class:"bar_row"},Wt={key:0,class:"bar_item item"},qt=Dt((()=>(0,i._)("label",{for:"all"},null,-1))),jt=["onClick"],Ht={class:"bar_item_group"},Zt={class:"bar_item item",style:{"min-width":"80px"}},Tt={key:0},zt=["title"],Lt=Dt((()=>(0,i._)("span",{class:"material-icons"}," settings ",-1))),Ot=[Lt],Bt=["title","disabled"],At=Dt((()=>(0,i._)("span",{class:"material-icons-outlined"}," upload_file ",-1))),Gt=[At];function Yt(e,t,s,a,r,n){return(0,i.wg)(),(0,i.iD)("tr",Et,[a.oneC||!a.currentSetSettingsInFolder.editItem&&!a.change_remains?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("th",Wt,[(0,i.wy)((0,i._)("input",{type:"checkbox",class:"checkbox",id:"all","onUpdate:modelValue":t[0]||(t[0]=e=>a.allSelectedProducts=e),onChange:t[1]||(t[1]=e=>a.changeAllSelectedProducts())},null,544),[[l.e8,a.allSelectedProducts]]),qt])),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.sortedFields,((e,t)=>((0,i.wg)(),(0,i.iD)("th",{class:"bar_item item",style:(0,o.j5)({minWidth:0!=a.width[t]?a.width[t]+"px":(a.collsCount>=8?100:a.collsCount>3?90:80)/a.collsCount+"%"}),onClick:t=>e[1].sortable&&9!=e[1].type?a.sort(e[0]):null,key:e},[(0,i._)("div",Ht,[(0,i._)("label",null,(0,o.zw)(e[1].name),1),e[1].sortable&&9!=e[1].type?((0,i.wg)(),(0,i.iD)("button",{key:0,class:(0,o.C_)(["bar_item_icon",{bar_item_icon_up:a.order.code===e[0]&&"desc"===a.order.prev_order,bar_item_icon_down:a.order.code===e[0]&&"asc"===a.order.prev_order}])},null,2)):(0,i.kq)("",!0)])],12,jt)))),128)),(0,i._)("th",Zt,[!a.isTest2||a.currentSetSettingsInFolder.tableSettingsBtn?((0,i.wg)(),(0,i.iD)("div",Tt,[(e.isMain||a.isTest2,(0,i.wg)(),(0,i.iD)("button",{key:0,class:"settings_btn",onClick:t[2]||(t[2]=e=>a.openTableSettings()),title:a.t("ostatki.nt")},Ot,8,zt)),(0,i._)("button",{class:"test_btn",title:a.t("ostatki.ex"),disabled:a.disableExportXlsx,onClick:t[3]||(t[3]=e=>a.exportXlsx())},Gt,8,Bt)])):(0,i.kq)("",!0)])])}var Vt=s(2524),Nt=s(4870),Ut=s(3704),Mt={props:{fields:{type:Array,required:!0,default(){return[]}},sortedFields:{type:Array,required:!0,default(){return[]}},tableConfig:{type:Object}},setup(e,t){const{currentSetSettingsInFolder:s}=(0,St.h)("products"),{t:i}=(0,Ce.j)(),o=(0,Nt.qj)({code:"",prev_order:""}),l=()=>{Object.assign(o,{code:"",prev_order:""})},a=e=>{const s=["asc","desc"];let i="";i=o.code===e&&o.prev_order==s[0]?s[1]:s[0],Object.assign(o,{code:e,prev_order:i}),e.split(".").length>1&&(e=e.split(".").join("->")),t.emit("sort",e,i)},r=(0,Nt.Fl)((()=>e.tableConfig.length)),n=(0,Nt.Fl)((()=>Ft.Z.state.account.account?.config?.g_enabled)),d=(0,Nt.Fl)((()=>{let t=[];return e.fields.forEach((e=>{let s=0;9==e.type&&(s=90),7!=e.type&&8!=e.type||(s=150),t.push(s)})),t})),{addNotification:c}=(0,Vt.l)(),u=(0,Nt.Fl)((()=>Ft.Z.state.products.productsParams)),p=(0,Nt.iH)(!1),_=async()=>{p.value=!0;const{sort:t,filter:s,warehouse:o="",is_service:l=0}=u.value,a=[];Object.entries(e.tableConfig).filter((e=>e[1].visible)).sort(((e,t)=>e[1].sort>t[1].sort?1:e[1].sort==t[1].sort?0:e[1].sort<t[1].sort?-1:void 0)).forEach((e=>a.push(e[0])));const r={sort:t,filter:s,config:a,warehouse:o,is_service:l};Ft.Z.dispatch("exportXlsx",r),c(0,i("ostatki.taskH"),i("ostatki.taskT")),p.value=!1},h=(0,Nt.iH)(!1),g=()=>{t.emit("changeAllSelectedProducts",h.value)},m=()=>{h.value=!1},f=()=>{Ft.Z.commit("open_table_settings")},v=(0,Nt.Fl)((()=>Ft.Z.state.account.user)),w=(0,Nt.Fl)((()=>v.value.config.change_remains));return{order:o,sort:a,collsCount:r,oneC:n,isTest2:Ut.h,width:d,productsParams:u,disableExportXlsx:p,exportXlsx:_,allSelectedProducts:h,changeAllSelectedProducts:g,dropAllSelectedProducts:m,openTableSettings:f,dropOrder:l,currentSetSettingsInFolder:s,change_remains:w,t:i}}};const Kt=(0,Fe.Z)(Mt,[["render",Yt],["__scopeId","data-v-58be9cdf"]]);var Rt=Kt;const Xt={class:"wrapper"},Jt={key:0,class:"container"},Qt={class:"header"},es={class:"content"},ts={class:"footer"},ss={key:1,class:"container"},is={class:"header"},os={class:"footer"};function ls(e,t,s,a,r,n){const d=(0,i.up)("btns-save-close");return(0,i.wg)(),(0,i.iD)("div",Xt,[(0,i._)("div",{class:"backdrop_with_filter",onClick:t[0]||(t[0]=e=>n.close())}),r.isAccept?((0,i.wg)(),(0,i.iD)("div",ss,[(0,i._)("div",is,[(0,i._)("label",null,(0,o.zw)(e.$t("ostatki.price2")),1),(0,i._)("button",{class:"btn cross",onClick:t[4]||(t[4]=e=>n.closeAccept())})]),(0,i._)("div",os,[(0,i.Wm)(d,{onClose:n.dismiss,show_save:!1},{close:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(e.$t("global.no")),1)])),other_btns:(0,i.w5)((()=>[(0,i._)("button",{class:"btn btn_dark_blue",onClick:t[5]||(t[5]=e=>n.confirm())},(0,o.zw)(e.$t("global.yes")),1)])),_:1},8,["onClose"])])])):((0,i.wg)(),(0,i.iD)("div",Jt,[(0,i._)("div",Qt,[(0,i._)("label",null,(0,o.zw)(e.$t("ostatki.pn",{name:r.copyEditPrice?.name})),1),(0,i._)("button",{class:"btn cross",onClick:t[1]||(t[1]=e=>n.close())})]),(0,i._)("div",es,[(0,i._)("label",null,(0,o.zw)(e.$t("ostatki.price")),1),(0,i.wy)((0,i._)("input",{type:"number",class:"input","onUpdate:modelValue":t[2]||(t[2]=e=>r.copyEditPrice.price=e)},null,512),[[l.nr,r.copyEditPrice.price]])]),(0,i._)("div",ts,[(0,i.Wm)(d,{onClose:n.close,show_save:!1},{close:(0,i.w5)((()=>[(0,i.Uk)((0,o.zw)(e.$t("global.back")),1)])),other_btns:(0,i.w5)((()=>[(0,i._)("button",{class:"btn btn_dark_blue",onClick:t[3]||(t[3]=e=>n.accept())},(0,o.zw)(e.$t("global.save")),1)])),_:1},8,["onClose"])])]))])}var as={components:{BtnsSaveClose:re.Z},props:{editPrice:{type:Object}},data(){return{isAccept:!1,copyEditPrice:{name:"",price:0,product_id:null,is_update_leads:!1,price_field_code:null}}},mounted(){Object.assign(this.copyEditPrice,this.editPrice)},methods:{accept(){this.isAccept=!0},close(){this.$store.commit("openCloseEditPrice",!1)},closeAccept(){this.isAccept=!1},dismiss(){this.copyEditPrice.is_update_leads=!1,this.save()},confirm(){this.copyEditPrice.is_update_leads=!0,this.save()},async save(){const e={...this.copyEditPrice};e.is_update_leads=e.is_update_leads?1:0,delete e.name,await this.$store.dispatch("setPrice",e),this.close(),this.$emit("close")}}};const rs=(0,Fe.Z)(as,[["render",ls],["__scopeId","data-v-ed5df418"]]);var ns=rs,ds=s(4547),cs=s(8755),us=s(5970),ps={name:"Main_grid",setup(){const{t:e}=(0,Ce.j)(),{checkIsNull:t}=(0,us._)(),{currentSetSettingsInFolder:s}=(0,St.h)("products"),o=(0,i.Fl)((()=>Ft.Z.state.account.user)),l=(0,i.Fl)((()=>o.value.config.editing_remains)),a=(0,i.Fl)((()=>o.value.config.change_remains));return{t:e,checkIsNull:t,currentSetSettingsInFolder:s,editing_remains:l,change_remains:a}},components:{EditItem:ut,GridBottom:pt.Z,MainGridFilters:It,MainGridBar:Rt,GridEditPrice:ns,AppTablePreloader:ds.Z,AppImagesCarusel:cs.Z},props:{selectedWH:{type:Object}},inject:["isServicePage"],data(){return{updateKey:0,selectedProducts:[],edit_data:{},showArrow:!1,editPrice:{}}},created(){window.addEventListener("scroll",this.handleScroll),this.$store.commit("updateIsLoadingProducts",!0)},unmounted(){window.removeEventListener("scroll",this.handleScroll),this.$store.commit("open_close_buttons",!1)},async mounted(){this.$store.commit("toggleIsNavBarDisabled",!0),await Promise.all([this.$store.dispatch("getTableConfig","whs"!=this.selectedWH.value?this.selectedWH.value:""),this.$store.dispatch("get_all_fields"),this.get_products(this.productsParams)]),this.setSelectedProducts(),this.bar?.dropAllSelectedProducts(),this.$store.commit("toggleIsNavBarDisabled",!1)},computed:{sortedFields(){const e=Object.entries(this.tableConfig);return e.sort(((e,t)=>e[1].sort>t[1].sort?1:e[1].sort==t[1].sort?0:e[1].sort<t[1].sort?-1:void 0)).filter((e=>e[1].visible))},tableConfig(){return this.$store.state.account.tableConfig},categories(){const e={};return this.$store.state.categories.fields_properties.forEach((t=>e[t.id]=t.name)),e},oneC(){return this.$store.state.account.account?.config?.g_enabled},count(){return this.$store.state.account.user.config?.per_page},meta(){return this.$store.state.products.meta},all_fields(){return this.$store.state.fields.all_fields},filters(){return this.$refs.filters},show_buttons(){const e=this.selectedProducts.filter((e=>e.value)).length>0;return e},showEditPrice(){return this.$store.state.shows.showEditPrice},products(){return this.$store.state.products.products},bar(){return this.$refs.bar},page(){const e={first:this.getPageFromLink(this.meta?.links?.first),prev:this.getPageFromLink(this.meta?.links?.prev),current:this.meta?.meta?.current_page,next:this.getPageFromLink(this.meta?.links?.next),last:this.getPageFromLink(this.meta?.links?.last)};return e},showGridBottom(){return this.meta.meta.total>=this.meta.meta.per_page},table(){return this.$refs.table},productsParams(){return this.$store.state.products.productsParams},isDataLoading(){return this.$store.state.products.isLoading},titlesForPreloader(){return Object.values(this.tableConfig).reduce(((e,t)=>(t.visible&&e.push(t.name),e)),[])},...(0,Pt.Se)(["show_edit_modal"])},watch:{isServicePage(){this.$store.commit("updateProductsParams",{is_service:this.isServicePage?1:0})},products:{handler:function(){this.updateKey+=1,(0,i.Y3)((()=>{!this.filters?.isConfirmFilters&&this.updateKey>1&&this.filters?.clearFilters(),this.filters?.setFalseIsConfirmFilters()}))},deep:!0},show_buttons(){this.$store.commit("open_close_buttons",this.show_buttons)},async selectedWH(){await this.$store.dispatch("getTableConfig","whs"!=this.selectedWH.value?this.selectedWH.value:""),this.bar?.dropOrder(),this.get_products(this.productsParams)}},methods:{getPageFromLink(e){return e?e.split("?page=")[1]:null},scrollUp(){window.scrollTo(0,0)},handleScroll(){const e=Math.round(this.bar?.$el?.getBoundingClientRect()?.y)-Math.round(this.table?.getBoundingClientRect()?.y)>10;this.showArrow=!!e},async clearFilters(){await(this.filters?.clearFilters()),this.filters?.confirmFilters()},confirmFilters(){this.filters?.confirmFilters()},isShow(e){const t={value:!1,second:""};return Object.entries(this.tableConfig).forEach((s=>{s[0].split(".")[0]==e&&s[1]?.visible&&(t.value=!0,t.second=s[0].split(".")[1])})),t},async changeCount(e){this.setTrueIsConfirmFilters(),await this.$store.dispatch("update_user",{per_page:e}),this.drop_page()},changePage(e){this.setTrueIsConfirmFilters();const t={page:e};this.$store.commit("updateProductsParams",t),this.get_products(this.productsParams)},setSelectedProducts(){this.selectedProducts=[];for(let e=0;e<this.count;e++)this.selectedProducts.push({value:!1,item:{}})},changeAllSelectedProducts(e){this.selectedProducts.map(((t,s)=>{t.value=e,t.item=e?this.products[s]:{}}))},async get_products(e){this.isServicePage.value&&(e={...e,is_service:1}),await this.$store.dispatch("get_products",e),this.setSelectedProducts(),this.bar?.dropAllSelectedProducts()},drop_page(){this.changePage(1)},open_edit_modal(e){this.setTrueIsConfirmFilters(),this.edit_data={...e},this.$store.commit("open_edit_modal",e.fields.category)},openGridEditPrice(e,t){this.editPrice={name:e.fields.name,price:void 0==e.fields?.[t]?.cost?0:e.fields[t].cost,product_id:e.id,price_field_code:t},this.$store.commit("openCloseEditPrice",!0)},setTrueIsConfirmFilters(){(0,i.Y3)((()=>this.filters?.setTrueIsConfirmFilters()))},sort(e,t){this.setTrueIsConfirmFilters();const s={page:1,sort:{by:e,order:t}};this.$store.commit("updateProductsParams",s),this.get_products(this.productsParams)},followOrdersList(e,t){this.$store.commit("updateOrdersFilters",{filter:{product:{wh:{compare:"=",query:t},product_id:{compare:"=",query:e}}}}),this.$router.push("orders")}}};const _s=(0,Fe.Z)(ps,[["render",U],["__scopeId","data-v-9de869de"]]);var hs=_s;const gs=e=>((0,i.dD)("data-v-12ce4374"),e=e(),(0,i.Cn)(),e),ms={class:"header"},fs={class:"sort"},vs={class:"grid",ref:"grid"},ws={key:0,class:"text"},bs={key:0,class:"row"},ys={class:"name"},ks=gs((()=>(0,i._)("span",null," :",-1))),Cs={key:0,class:"value"},Ps={key:1,class:"value"},Ss={key:0},Fs={key:1},$s=["onClick","title"],xs={class:"card_footer"},Is=["id","onUpdate:modelValue","onChange"],Ds=["for"],Es=["onClick","title"];function Ws(e,t,s,a,r,n){const d=(0,i.up)("edit-item"),c=(0,i.up)("GridEditPrice"),u=((0,i.up)("card-grid-filters"),(0,i.up)("SelectorVue")),p=(0,i.up)("CardGridCategories"),_=(0,i.up)("AppImagesCarusel"),h=(0,i.up)("grid-bottom");return(0,i.wg)(),(0,i.iD)(i.HY,null,[((0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[e.show_edit_modal?((0,i.wg)(),(0,i.j4)(d,{key:0,edit_data:r.edit_data},null,8,["edit_data"])):(0,i.kq)("",!0)])),((0,i.wg)(),(0,i.j4)(i.lR,{to:"body"},[n.showEditPrice?((0,i.wg)(),(0,i.j4)(c,{key:0,editPrice:e.editPrice,onClose:t[0]||(t[0]=e=>n.get_products(n.productsParams))},null,8,["editPrice"])):(0,i.kq)("",!0)])),(0,i._)("div",{class:(0,o.C_)(["wrapper",{blur:e.show_edit_modal||n.isDataLoading}])},[(0,i._)("div",ms,[(0,i.Wm)(l.uT,{name:"mdl"},{default:(0,i.w5)((()=>[(0,i.kq)("",!0)])),_:1}),(0,i._)("div",fs,[(0,i._)("span",null,(0,o.zw)(e.$t("ostatki.sortBy")),1),(0,i.Wm)(u,{options_props:n.sortedFieldsForSort,selected_option:r.selectedSort.value,onSelect:n.selectSort},null,8,["options_props","selected_option","onSelect"]),(0,i._)("button",{class:(0,o.C_)(["bar_item_icon",{bar_item_icon_up:0===r.selectedSort?.order,bar_item_icon_down:1===r.selectedSort?.order}]),onClick:t[1]||(t[1]=e=>n.selectOrder())},null,2),(0,i._)("button",{class:"btn btn_blue",onClick:t[2]||(t[2]=e=>n.sort())},(0,o.zw)(e.$t("global.apply2")),1)])]),(0,i.Wm)(p,{onSelectCat:n.selectCat},null,8,["onSelectCat"]),(0,i._)("div",vs,[0==n.products.length?((0,i.wg)(),(0,i.iD)("label",ws,(0,o.zw)(e.$t("global.nothingFound")),1)):(0,i.kq)("",!0),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.products,((t,s)=>((0,i.wg)(),(0,i.iD)("div",{class:"card shadow-lg",key:t.id},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.sortedFields,(s=>((0,i.wg)(),(0,i.iD)(i.HY,{key:s},[e.getAllFieldsInSubCat(r.selectedCatId).includes(s[1].id)?((0,i.wg)(),(0,i.iD)("div",bs,[(0,i._)("div",ys,[(0,i.Uk)((0,o.zw)(s[1].name),1),ks]),15===s[1].type?((0,i.wg)(),(0,i.iD)("div",Cs,[(0,i.Wm)(_,{imagesList:t.fields[s[0]],float:"right"},null,8,["imagesList"])])):((0,i.wg)(),(0,i.iD)("div",Ps,[s[0].split(".").length<2?((0,i.wg)(),(0,i.iD)("span",Ss,(0,o.zw)(6===s[1].type?t.fields[s[0]+"_string"]:"free_4_reserve"===s[0]&&-1==t.fields[s[0]]?"∞":"category"==s[0]?n.categories[t.fields[s[0]]]:9==s[1].type?t.fields[s[0]]?e.$t("global.yes"):e.$t("global.no"):"cost_price"==s[0]?t.fields[s[0]]?Math.round(100*t.fields[s[0]])/100:"0":t.fields[s[0]]),1)):((0,i.wg)(),(0,i.iD)("span",Fs,(0,o.zw)("cost"==s[0].split(".")[1]?a.checkIsNull(t.fields?.[s[0].split(".")[0]]?.[s[0].split(".")[1]])+" "+(t.fields?.[s[0].split(".")[0]]?.currency||""):9==s[1].type?Boolean(t.fields?.[s[0].split(".")[0]]?.[s[0].split(".")[1]])?e.$t("global.yes"):e.$t("global.no"):t.fields?.[s[0].split(".")[0]]?.[s[0].split(".")[1]]),1)),(0,i.Uk)("   "),"cost"==s[0].split(".")[1]?((0,i.wg)(),(0,i.iD)("button",{key:2,class:"edit_icon",style:{width:"16px",heigth:"16px"},onClick:(0,l.iM)((e=>n.openGridEditPrice(t,s[0].split(".")[0])),["stop"]),title:a.t("ostatki.changePrice")},null,8,$s)):(0,i.kq)("",!0)]))])):(0,i.kq)("",!0)],64)))),128)),(0,i._)("div",xs,[n.oneC?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[void 0!=r.selectedProducts[s]?(0,i.wy)(((0,i.wg)(),(0,i.iD)("input",{key:0,type:"checkbox",class:"checkbox",id:t.id,"onUpdate:modelValue":e=>r.selectedProducts[s].value=e,onChange:e=>r.selectedProducts[s].item=t},null,40,Is)),[[l.e8,r.selectedProducts[s].value]]):(0,i.kq)("",!0),(0,i._)("label",{for:t.id},null,8,Ds)],64)),(0,i._)("div",{class:"edit_icon",onClick:(0,l.iM)((e=>n.open_edit_modal(t)),["stop"]),title:a.t("ostatki.changePoz")},null,8,Es)])])))),128))],512),(0,i.Wm)(h,{page:n.page,blur:e.show_edit_modal,show:0!=n.products.length,count:n.count,showBtns:n.showGridBottom,onChangePage:n.changePage,onChangeCount:n.changeCount},null,8,["page","blur","show","count","showBtns","onChangePage","onChangeCount"])],2),r.showArrow?((0,i.wg)(),(0,i.iD)("button",{key:0,class:"arrow",onClick:t[3]||(t[3]=e=>n.scrollUp())})):(0,i.kq)("",!0)],64)}const qs={key:0,class:"filters"},js={class:"title"};function Hs(e,t,s,a,r,n){const d=(0,i.up)("filter-number"),c=(0,i.up)("filter-text"),u=(0,i.up)("filter-list"),p=(0,i.up)("filter-date"),_=(0,i.up)("filter-flag");return e.show_filter?((0,i.wg)(),(0,i.iD)("div",qs,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(r.filtersValue,((e,t)=>(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",{class:"item",key:t},[(0,i._)("div",js,(0,o.zw)(e.name),1),1==e.type||2==e.type?((0,i.wg)(),(0,i.j4)(d,{key:0,item:e,idx:t,onChange_filter_value:n.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,i.kq)("",!0),3==e.type||4==e.type?((0,i.wg)(),(0,i.j4)(c,{key:1,item:e,idx:t,onChange_filter_value:n.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,i.kq)("",!0),5==e.type||6==e.type?((0,i.wg)(),(0,i.j4)(u,{key:2,item:e,idx:t,selector_options:e.selector_options,onChange_filter_value:n.change_filter_value},null,8,["item","idx","selector_options","onChange_filter_value"])):(0,i.kq)("",!0),12==e.type?((0,i.wg)(),(0,i.j4)(u,{key:3,item:e,idx:t,selector_options:r.categories_options,onChange_filter_value:n.change_filter_value},null,8,["item","idx","selector_options","onChange_filter_value"])):(0,i.kq)("",!0),7==e.type||8==e.type?((0,i.wg)(),(0,i.j4)(p,{key:4,item:e,idx:t,onChange_filter_value:n.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,i.kq)("",!0),9==e.type?((0,i.wg)(),(0,i.j4)(_,{key:5,item:e,idx:t,onChange_filter_value:n.change_filter_value},null,8,["item","idx","onChange_filter_value"])):(0,i.kq)("",!0)])),[[l.F8,e.table_config?.filtered]]))),128))])):(0,i.kq)("",!0)}var Zs={props:{fields:{type:Array,required:!0,default(){return[]}},sortedFields:{type:Array,required:!0,default(){return[]}},tableConfig:{type:Object}},components:{FilterNumber:vt.Z,FilterText:wt.Z,FilterList:bt.Z,FilterDate:yt.Z,FilterFlag:kt.Z},data(){return{filtersValue:[],categories_options:[],isConfirmFilters:!1,filter:{}}},computed:{...(0,Pt.Se)(["show_filter"]),oneC(){return this.$store.state.account.account?.config?.g_enabled},productsParams(){return this.$store.state.products.productsParams}},async mounted(){await this.$store.dispatch("get_fields_properties"),this.get_categories_options(),this.feelFilters()},methods:{clearFilters(){this.feelFilters()},confirmFilters(){this.isConfirmFilters=!0;const e={};this.filtersValue.filter((e=>null!=e.value)).forEach((t=>{if(1!=t.type&&2!=t.type||(e[t.code]={compare:t.option,query:t.value}),3!=t.type&&4!=t.type||(e[t.code]={compare:t.option,query:t.value}),5!=t.type&&6!=t.type&&12!=t.type||t.value?.length&&(e[t.code]={compare:"in",query:t.value}),7==t.type){const s=t.value.split("~");s.forEach(((e,t)=>s[t]=e.split("-").join("."))),e[t.code]={from:s[0],to:s[1]}}if(8==t.type){const s=t.value.split("~");s.forEach(((e,t)=>{const i=e.split("T");i[0]=i[0].split("-").join("."),s[t]=i.join(" ")})),e[t.code]={from:s[0],to:s[1]}}})),this.filter=e,this.$store.commit("updateProductsParams",{filter:e,page:1}),this.$store.dispatch("get_products",this.productsParams)},change_filter_value(e,t){Object.assign(this.filtersValue[t],e)},setFalseIsConfirmFilters(){this.isConfirmFilters=!1},setTrueIsConfirmFilters(){this.isConfirmFilters=!0},feelFilters(){this.filtersValue=[];const e=[];this.sortedFields.forEach((t=>{let s={};s={...this.fields.filter((e=>e.code.split(".")[0]==t[0].split(".")[0]))[0]},s.type=t[1].type,s.name=t[1].name,s.code=t[0],e.push(s)})),e.forEach((e=>{const t=e=>{const t=[];return null!=e&&e.forEach(((e,s)=>t.push({name:e,value:s}))),t};let s=null;5!=e.type&&6!=e.type||(s=[]),9==e.type&&(s=1),12==e.type&&(s=[]);const i={type:e.type,code:e.code,name:e.name,option:"=",selector_options:t(e.data),value:s,table_config:e.table_config};this.filtersValue.push(i)}))},get_categories_options(){this.$store.state.categories.fields_properties.forEach((e=>{let t="";for(let s=1;s<e.level;s++)t+="    ";this.categories_options.push({name:e.name,value:e.id})}))}}};const Ts=(0,Fe.Z)(Zs,[["render",Hs],["__scopeId","data-v-073c3f04"]]);var zs=Ts;const Ls=e=>((0,i.dD)("data-v-cc03344a"),e=e(),(0,i.Cn)(),e),Os={class:"mb-6"},Bs={class:"links"},As=["disabled","onClick"],Gs={class:"path"},Ys={class:"categories sls_grid"},Vs=["onClick"],Ns=Ls((()=>(0,i._)("div",{class:"name"},null,-1))),Us={key:0,class:"sls_row"},Ms={key:1,class:"w-full h-full bg-black/30 absolute left-0 top-0 z-10"},Ks=["src"],Rs=["src"],Xs=["src"];function Js(e,t,s,l,a,r){return(0,i.wg)(),(0,i.iD)("div",Os,[(0,i._)("div",Bs,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(l.categories.selected,((e,t)=>((0,i.wg)(),(0,i.iD)("button",{class:(0,o.C_)(["triangle",{triangle_last:!l.categories.filteredList.length&&l.categories.selected.length-1==t}]),disabled:l.categories.selected.length-1==t,key:e,onClick:t=>l.categories.select(e)},(0,o.zw)(e?.name),11,As)))),128))]),(0,i._)("div",Gs,[(0,i._)("div",Ys,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(l.categories.filteredList,(e=>((0,i.wg)(),(0,i.iD)("div",{class:(0,o.C_)(["card group/card relative !border-slate-300",{"!overflow-hidden":!l.newImagesShow}]),key:e,onClick:t=>l.categories.select(e)},[(0,i._)("div",{class:(0,o.C_)(["sls_row title relative z-20",{"text-white":e.img_url&&!l.newImagesShow,"!justify-end":e.img_url&&l.newImagesShow}])},[Ns,(0,i._)("div",{class:(0,o.C_)(["value transition-all",{"group-hover/card:max-w-[50%] max-w-[70%]":e.img_url&&l.newImagesShow}])},(0,o.zw)(e.name),3)],2),l.newImagesShow?((0,i.wg)(),(0,i.iD)(i.HY,{key:1},[e.img_url?((0,i.wg)(),(0,i.iD)("img",{key:0,src:e.img_url,class:"aspect-auto h-4/5 ring-2 rounded-md ring-slate-500/50 z-[3] absolute top-0 translate-y-[10%] left-0 -translate-x-5 transition-all duration-300 group-hover/card:h-[100%] group-hover/card:translate-y-0 group-hover/card:translate-x-0"},null,8,Xs)):(0,i.kq)("",!0)],64)):((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[e.img_url?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",Us)),e.img_url?((0,i.wg)(),(0,i.iD)("div",Ms)):(0,i.kq)("",!0),e.img_url?((0,i.wg)(),(0,i.iD)("img",{key:2,src:e.img_url,class:"aspect-auto w-3/4 z-[3] absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 transition-all duration-300 group-hover/card:scale-[0.6]"},null,8,Ks)):(0,i.kq)("",!0),e.img_url?((0,i.wg)(),(0,i.iD)("img",{key:3,src:e.img_url,class:"aspect-auto w-3/4 z-[2] blur2 absolute top-1/2 -translate-y-1/2 left-1/2 -translate-x-1/2 transition-all duration-300 group-hover/card:scale-[0.6]"},null,8,Rs)):(0,i.kq)("",!0)],64))],10,Vs)))),128))])])])}var Qs={emits:{selectCat:null},setup(e,t){const s=(0,Nt.qj)({selected:[],list:[],filteredList:(0,i.Fl)((()=>s.list.filter((e=>e.parent_id===s.selected.at(-1).id)))),select:function(e){const s=this.selected.indexOf(e);-1==s?this.selected.push(e):this.selected.splice(s+1),t.emit("selectCat",this.selected.at(-1))},getList:async function(){this.list=await Ft.Z.dispatch("get_fields_properties");const e=this.list.find((e=>0===e.parent_id));this.selected.push(e)}});(0,i.bv)((()=>{s.getList()}));const o=!0;return{categories:s,newImagesShow:o}}};const ei=(0,Fe.Z)(Qs,[["render",Js],["__scopeId","data-v-cc03344a"]]);var ti=ei,si=s(3441);const{t:ii}=(0,Ce.j)();var oi={name:"CardGrid",components:{EditItem:ut,GridBottom:pt.Z,CardGridFilters:zs,GridEditPrice:ns,SelectorVue:ae.Z,CardGridCategories:ti,AppImagesCarusel:cs.Z},props:{selectedWH:{type:Object}},inject:["isServicePage"],emits:{},setup(){const{checkIsNull:e}=(0,us._)();return{t:ii,...(0,si.D)(),checkIsNull:e}},data(){return{selectedCatId:null,edit_data:{},selectedProducts:[],showArrow:!1,orderList:["desc","asc"],selectedSort:{value:{name:ii("global.notSelected"),value:-1},order:1}}},created(){window.addEventListener("scroll",this.handleScroll),this.$store.commit("updateIsLoadingProducts",!0)},unmounted(){window.removeEventListener("scroll",this.handleScroll),this.$store.commit("open_close_buttons",!1)},async mounted(){await this.$store.dispatch("get_fields_properties"),this.setSelectedCatId(),await Promise.all([this.$store.dispatch("getTableConfig","whs"!=this.selectedWH.value?this.selectedWH.value:""),this.$store.dispatch("get_all_fields"),this.get_products(this.productsParams)]),this.setSelectedProducts()},computed:{sortedFields(){return this.sortedFieldsRow.filter((e=>e[1].visible))},sortedFieldsRow(){const e={};this.all_fields.forEach((t=>e[t.code]=t));const t=Object.entries(this.tableConfig);return t.map((([t,s])=>s.id=e[t.split(".")[0]]?.id)),t.sort(((e,t)=>e[1].sort>t[1].sort?1:e[1].sort==t[1].sort?0:e[1].sort<t[1].sort?-1:void 0))},sortedFieldsForSort(){const e=[{name:ii("global.notSelected"),value:-1}];return this.sortedFieldsRow.filter((e=>e[1].sortable&&9!=e[1].type)).forEach((t=>e.push({name:t[1].name,value:t[0]}))),e},tableConfig(){return this.$store.state.account.tableConfig},categories(){const e={};return this.$store.state.categories.fields_properties.forEach((t=>e[t.id]=t.name)),e},oneC(){return this.$store.state.account.account?.config?.g_enabled},count(){return this.$store.state.account.user.config?.per_page},meta(){return this.$store.state.products.meta},page(){const e={first:this.getPageFromLink(this.meta?.links?.first),prev:this.getPageFromLink(this.meta?.links?.prev),current:this.meta?.meta?.current_page,next:this.getPageFromLink(this.meta?.links?.next),last:this.getPageFromLink(this.meta?.links?.last)};return e},all_fields(){return this.$store.state.fields.all_fields},filters(){return this.$refs.filters},show_buttons(){const e=this.selectedProducts.filter((e=>e.value)).length>0;return e},showEditPrice(){return this.$store.state.shows.showEditPrice},products(){return this.$store.state.products.products},bar(){return this.$refs.bar},showGridBottom(){return this.meta.meta.total>=this.meta.meta.per_page},grid(){return this.$refs.grid},productsParams(){return this.$store.state.products.productsParams},isDataLoading(){return this.$store.state.products.isLoading},...(0,Pt.Se)(["show_edit_modal"]),ref_links(){return this.$refs.links}},watch:{products:{handler:function(){this.updateKey+=1,(0,i.Y3)((()=>{this.filters?.isConfirmFilters||this.filters?.clearFilters(),this.filters?.setFalseIsConfirmFilters()}))},deep:!0},show_buttons(){this.$store.commit("open_close_buttons",this.show_buttons)},async selectedWH(){await this.$store.dispatch("getTableConfig","whs"!=this.selectedWH.value?this.selectedWH.value:""),this.bar?.dropOrder(),this.get_products(this.productsParams)}},methods:{getPageFromLink(e){return e?e.split("?page=")[1]:null},scrollUp(){window.scrollTo(0,0)},handleScroll(){const e=Math.round(this.grid?.getBoundingClientRect()?.y)<0;this.showArrow=!!e},async clearFilters(){await(this.filters?.clearFilters()),this.filters?.confirmFilters()},confirmFilters(){this.filters?.confirmFilters()},isShow(e){const t={value:!1,second:""};return Object.entries(this.tableConfig).forEach((s=>{s[0].split(".")[0]==e&&s[1]?.visible&&(t.value=!0,t.second=s[0].split(".")[1])})),t},async changeCount(e){this.setTrueIsConfirmFilters(),await this.$store.dispatch("update_user",{per_page:e}),this.drop_page()},changePage(e){this.setTrueIsConfirmFilters();const t={page:e};this.$store.commit("updateProductsParams",t),this.get_products(this.productsParams)},setSelectedProducts(){this.selectedProducts=[];for(let e=0;e<this.count;e++)this.selectedProducts.push({value:!1,item:{}})},async get_products(e){this.isServicePage&&(e={...e,is_service:1}),await this.$store.dispatch("get_products",e),this.setSelectedProducts()},drop_page(){this.changePage(1)},open_edit_modal(e){this.setTrueIsConfirmFilters(),this.edit_data={...e},this.$store.commit("open_edit_modal",e.fields.category)},openGridEditPrice(e,t){this.editPrice={name:e.fields.name,price:void 0==e.fields?.[t]?.cost?0:e.fields[t].cost,product_id:e.id,price_field_code:t},this.$store.commit("openCloseEditPrice",!0)},setTrueIsConfirmFilters(){(0,i.Y3)((()=>this.filters?.setTrueIsConfirmFilters()))},selectSort(e){this.selectedSort.value=e},selectOrder(){this.selectedSort.order?this.selectedSort.order=0:this.selectedSort.order=1},sort(){let e,t;-1!=this.selectedSort.value.value?(e=this.selectedSort.value.value,t=this.orderList[this.selectedSort.order]):(e="",t=""),this.setTrueIsConfirmFilters();const s={page:1,sort:{by:e,order:t}};this.$store.commit("updateProductsParams",s),this.get_products(this.productsParams)},emit_link(e){Object.assign(this.link,e)},selectCat(e){this.selectedCatId=e.id;const t={filter:{category:{compare:"in",query:[e.id]}}};this.$store.commit("updateProductsParams",t),this.get_products(this.productsParams)},setSelectedCatId(){this.selectedCatId=this.$store.state.categories.fields_properties.find((e=>0===e.parent_id))?.id}}};const li=(0,Fe.Z)(oi,[["render",Ws],["__scopeId","data-v-12ce4374"]]);var ai=li,ri=s(1621),ni=s(3768);const di={key:0,class:"old"},ci={key:0};function ui(e,t,s,l,a,r){return l.account?.is_exist_old_data&&!l.account?.is_old_data_loaded?((0,i.wg)(),(0,i.iD)("div",di,[l.account?.is_old_data_load_start?((0,i.wg)(),(0,i.iD)("p",ci,(0,o.zw)(e.$t("ostatki.att")),1)):((0,i.wg)(),(0,i.iD)(i.HY,{key:1},[(0,i._)("p",null,(0,o.zw)(e.$t("ostatki.att2")),1),(0,i._)("button",{class:"btn btn_yellow",onClick:t[0]||(t[0]=e=>l.importOldData("click"))},(0,o.zw)(e.$t("ostatki.d")),1)],64))])):(0,i.kq)("",!0)}var pi={emits:["importComplete"],setup(e,t){const s=(0,i.Fl)((()=>Ft.Z.state.account.account)),o=async e=>{if(s.value?.is_exist_old_data&&!s.value?.is_old_data_loaded&&(s.value?.is_old_data_load_start||"click"!=e||await Ft.Z.dispatch("importOldData"),s.value?.is_old_data_load_start||"click"==e)){Ft.Z.dispatch("get_account");const e=setInterval((async()=>{await Ft.Z.dispatch("get_account"),(s.value?.is_old_data_loaded??!s.value?.is_old_data_load_start)&&(clearInterval(e),t.emit("importComplete"))}),5e3)}};return{account:s,importOldData:o}}};const _i=(0,Fe.Z)(pi,[["render",ui],["__scopeId","data-v-007487ba"]]);var hi=_i;const gi={class:"whs"},mi={class:"radio_btns"},fi=["value","id","checked","onChange"],vi=["for"];function wi(e,t,s,l,a,r){const n=(0,i.up)("AppInputSelect");return(0,i.wg)(),(0,i.iD)("div",gi,[(0,i._)("div",mi,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(l.systemWhs,(e=>((0,i.wg)(),(0,i.iD)("div",{class:"radio_btn",key:e},[(0,i._)("input",{type:"radio",value:e.value,id:e.name,name:"selected_storage",checked:s.selectedWH.value==e.value,onChange:t=>l.selectWH(e)},null,40,fi),(0,i._)("label",{for:e.name},(0,o.zw)(e.name),9,vi)])))),128)),l.customWhs.length?((0,i.wg)(),(0,i.j4)(n,{key:0,list:l.sortedCustomWhs,selected:s.selectedWH,requestDelay:0,placeholder:l.customWhs.includes(s.selectedWH)?s.selectedWH.name:l.t("ostatki.selWh"),input_uderline:!0,onChangeInputValue:l.changeInputValueWhs,onSelect:l.selectWH},null,8,["list","selected","placeholder","onChangeInputValue","onSelect"])):(0,i.kq)("",!0)])])}var bi=s(8890),yi=s(5310),ki={components:{AppInputSelect:bi.Z},props:{selectedWH:Object},setup(e,t){const{t:s}=(0,Ce.j)(),o=(0,Nt.iH)([]),l=(0,Nt.iH)([]),a=(0,Nt.iH)([]),r=(0,i.Fl)((()=>Ft.Z.state.account.account.whs));(0,i.YP)(r,(()=>n()));const n=()=>d(),d=()=>{o.value=[],l.value=[],a.value=[];const{system:e,custom:t}=Ft.Z.state.account.account.whs2;e.forEach((e=>{(!yi.b.value?.remnants?.hideMainWhs||"wh"!==e.code&&"whs"!==e.code)&&("wh"===e.code&&yi.b.value?.names?.mainWhs_allObjects&&(e.name=s("ostatki.allObj")),yi.b.value?.remnants?.hideAllWhs&&"whs"===e.code?a.value.push({name:e.name,value:e.code}):l.value.push({name:e.name,value:e.code}),o.value.push({name:e.name,value:e.code}))}));const i={name:yi.b.value?.names?.service_menu?s("ostatki.menu"):s("ostatki.ysls"),value:"services"};yi.b.value?.remnants?.hideService?a.value.push(i):l.value.push(i),o.value.push(i),t.forEach((e=>{a.value.push({name:e.name,value:e.code}),o.value.push({name:e.name,value:e.code})}))},c=e=>t.emit("update:selectedWH",e),u=(0,Nt.iH)(""),p=e=>u.value=e,_=(0,i.Fl)((()=>a.value.filter((e=>e?.name?.toLowerCase()?.includes(u.value?.toLowerCase())))));return{whs:o,changeStoreWhs:n,selectWH:c,systemWhs:l,customWhs:a,changeInputValueWhs:p,sortedCustomWhs:_,t:s}}};const Ci=(0,Fe.Z)(ki,[["render",wi],["__scopeId","data-v-4bae25f0"]]);var Pi=Ci,Si=s(2692);const Fi={key:0,class:"buttons"},$i=["disabled"];function xi(e,t,s,a,r,n){return(0,i.wg)(),(0,i.j4)(l.uT,{name:"btns"},{default:(0,i.w5)((()=>[a.show_buttons&&!a.oneC?((0,i.wg)(),(0,i.iD)("div",Fi,[s.isServicePage?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[(0,i._)("button",{class:"btn btn_tempest smallBtn",onClick:t[0]||(t[0]=e=>a.addCurrentProducts()),disabled:a.oneC},(0,o.zw)(e.$t("ostatki.btn1")),9,$i),(0,i._)("button",{class:"btn btn_pink smallBtn",onClick:t[1]||(t[1]=e=>a.openCancelPosition())},(0,o.zw)(e.$t("ostatki.btn2")),1),(0,i._)("button",{class:"btn btn_light_yellow smallBtn",onClick:t[2]||(t[2]=e=>a.openMoveProductsBetweenWhs())},(0,o.zw)(e.$t("ostatki.btn3")),1)],64)),(0,i._)("button",{class:"btn btn_grey smallBtn",onClick:t[3]||(t[3]=e=>a.archive_data())},(0,o.zw)(e.$t("ostatki.btn4")),1)])):(0,i.kq)("",!0)])),_:1})}var Ii={props:{isServicePage:Boolean},emits:["setCurrentItems","archive_data"],setup(e,t){const s=(0,i.Fl)((()=>Ft.Z.state.shows.show_buttons)),o=(0,i.Fl)((()=>Ft.Z.state.account.account?.config?.g_enabled)),l=()=>{n(),Ft.Z.commit("open_close_new_position",!0)},a=()=>{n(),Ft.Z.commit("open_close_cancel_position",!0)},r=()=>{n(),Ft.Z.commit("openCloseMoveProductsBetweenWhs",!0)},n=()=>t.emit("setCurrentItems"),d=()=>t.emit("archive_data");return{show_buttons:s,oneC:o,addCurrentProducts:l,openCancelPosition:a,openMoveProductsBetweenWhs:r,archive_data:d}}};const Di=(0,Fe.Z)(Ii,[["render",xi],["__scopeId","data-v-9d3fe814"]]);var Ei=Di;const Wi={class:"filter_group"},qi={for:"filter"},ji={key:0,class:"btns"};function Hi(e,t,s,a,r,n){return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",Wi,[(0,i.wy)((0,i._)("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>a.filterValue=e),name:"filter",id:"filter",class:"checkbox"},null,512),[[l.e8,a.filterValue]]),(0,i._)("label",qi,(0,o.zw)(e.$t("ostatki.f")),1)]),a.filterValue?((0,i.wg)(),(0,i.iD)("div",ji,[(0,i._)("button",{class:"btn btn_tempest",onClick:t[1]||(t[1]=e=>a.confirmFilters())},(0,o.zw)(e.$t("global.apply2")),1),(0,i._)("button",{class:"btn btn_rusty_red",onClick:t[2]||(t[2]=e=>a.clearFilters())},(0,o.zw)(e.$t("global.clear")),1)])):(0,i.kq)("",!0)],64)}var Zi={emits:["confirmFilters","clearFilters"],setup(e,t){const s=(0,Nt.iH)(!1);(0,i.YP)(s,(()=>Ft.Z.commit("open_close_filter",s.value)));const o=()=>t.emit("confirmFilters"),l=()=>t.emit("clearFilters");return{filterValue:s,confirmFilters:o,clearFilters:l}}};const Ti=(0,Fe.Z)(Zi,[["render",Hi],["__scopeId","data-v-caadf7da"]]);var zi=Ti;const{t:Li}=(0,Ce.j)();var Oi={components:{MainGrid:hs,CardGrid:ai,HomeModals:ri.Z,NavBar:ni.Z,HomeImportOldData:hi,HomeWhs:Pi,HomeMenu:Si.Z,HomeBtns:Ei,HomeFilter:zi},provide(){return{isServicePage:(0,i.Fl)((()=>this.isServicePage))}},setup(){const{currentSetSettingsInFolder:e}=(0,St.h)("products"),t=(0,i.Fl)((()=>Ft.Z.state.account.user)),s=(0,i.Fl)((()=>t.value.config.editing_remains));return{t:Li,isTest:Ut.Y,currentSetSettingsInFolder:e,editing_remains:s}},data(){return{is_in_wh:!0,paginatedData:[],paginatedParams:[],selectedWH:yi.b.value?.remnants?.mainWhSelected?{name:yi.b.value?.names?.mainWhs_allObjects?Li("ostatki.allObj"):Li("ostatki.osn"),value:"wh"}:{name:Li("ostatki.allwhs"),value:"whs"},isGrid:!1,currentItems:[],isUpdateProducts:!1,disableWatchIsInWh:!1}},computed:{date(){const e=new Date;let t=e.getDate(),s=e.getMonth()+1;const i=e.getFullYear();s<10&&(s="0"+s),t<10&&(t="0"+t);const o=i+"-"+s+"-"+t;return o},isServicePage(){return"services"===this.selectedWH.value},...(0,Pt.Se)(["home_blur","show_modals","disabled_for_modals","show_edit_modal"]),totalCountProducts(){return this.$store.state.products.meta.meta.total},oneC(){return this.$store.state.account.account?.config?.g_enabled},account(){return this.$store.state.account.account},user(){return this.$store.state.account.user},ref_main(){return this.$refs.main},ref_card(){return this.$refs.card},ref_homeWhs(){return this.$refs.homeWhs},filteredSelectedProducts(){let e=[];return e=this.isGrid?[...this.$refs.card?.selectedProducts.filter((e=>e.value&&e.item))]:[...this.$refs.main?.selectedProducts.filter((e=>e.value&&e.item))],e},isLoadingProducts(){return this.$store.state.products.isLoading}},async mounted(){await this.$store.dispatch("get_account"),this.ref_homeWhs?.changeStoreWhs(),this.$refs?.oldData?.importOldData("start"),this.disableWatchIsInWh=!0,this.is_in_wh=this.user?.config?.is_in_wh,this.$nextTick((()=>this.disableWatchIsInWh=!1))},watch:{show_modals(){this.show_modals?(window.scrollTo(0,0),document.body.style.overflowX="hidden"):document.body.style.overflowX="auto"},selected_storage(){this.$store.commit("updateIsLoadingProducts",!0),this.isGrid?this.ref_card.drop_page():this.ref_main.drop_page()},async is_in_wh(){this.disableWatchIsInWh||(await this.$store.dispatch("update_user",{is_in_wh:this.is_in_wh}),this.updateProducts())},selectedWH(){this.$store.commit("updateProductsParams",{warehouse:"whs"===this.selectedWH.value||this.isServicePage?"":this.selectedWH.value})},isGrid(){this.$store.commit("updateProductsParams",{page:1,filter:{},sort:{}})}},methods:{confirmFilters(){this.isGrid?this.ref_card?.confirmFilters():this.ref_main?.confirmFilters()},clearFilters(){this.isGrid?this.ref_card?.clearFilters():this.ref_main?.clearFilters()},importComplete(){this.ref_homeWhs?.changeStoreWhs(),this.clearFilters(),this.updateProducts()},async archive_data(){const e={products:[]};this.filteredSelectedProducts?.forEach((t=>{t.item.is_archive=1,e.products.push(t.item)})),await this.$store.dispatch("update_product",e);const t=this.$store.state.products.meta.meta.current_page;this.isGrid?this.ref_card?.changePage(t):this.ref_main?.changePage(t)},setCurrentItems(){let e=JSON.parse(JSON.stringify(this.filteredSelectedProducts));e=e.filter((e=>void 0!==e.item)),this.currentItems=[...e.map((e=>e.item))]},dropCurrentItems(){this.currentItems=[]},open_close_new_position(e){this.$store.commit("open_close_new_position",e)},openTableSettings(){this.$store.commit("open_table_settings")},updateProducts(){this.isUpdateProducts=!0,setTimeout((()=>{this.isUpdateProducts=!1}),2250),this.isGrid?(this.ref_card?.changePage(this.$store.state.products.meta.meta.current_page),this.ref_card?.setSelectedProducts()):(this.ref_main?.changePage(this.$store.state.products.meta.meta.current_page),this.ref_main?.setSelectedProducts()),this.dropCurrentItems()}}};const Bi=(0,Fe.Z)(Oi,[["render",$],["__scopeId","data-v-a5c95a28"]]);var Ai=Bi}}]);
//# sourceMappingURL=207.4ea0435f.js.map