"use strict";(self["webpackChunkstorage"]=self["webpackChunkstorage"]||[]).push([[641],{8513:function(e,t,s){s.d(t,{Z:function(){return p}});var l=s(6252);const o={class:"btns"},a=(0,l.Uk)("Отмена"),i=(0,l.Uk)("Сохранить");function n(e,t,s,n,c,d){return(0,l.wg)(),(0,l.iD)("div",o,[s.show_close?((0,l.wg)(),(0,l.iD)("button",{key:0,class:"btn btn1",onClick:t[0]||(t[0]=e=>d.close())},[(0,l.WI)(e.$slots,"close",{},(()=>[a]),!0)])):(0,l.kq)("",!0),(0,l.WI)(e.$slots,"other_btns",{},void 0,!0),s.show_save?((0,l.wg)(),(0,l.iD)("button",{key:1,class:"btn btn2",onClick:t[1]||(t[1]=e=>d.save())},[(0,l.WI)(e.$slots,"save",{},(()=>[i]),!0)])):(0,l.kq)("",!0)])}var c={props:{show_close:{type:Boolean,required:!1,default(){return!0}},show_save:{type:Boolean,required:!1,default(){return!0}}},emits:{close:null,save:null},methods:{close(){this.$emit("close")},save(){this.$emit("save")}}},d=s(3744);const r=(0,d.Z)(c,[["render",n],["__scopeId","data-v-fcfb56ae"]]);var p=r},4469:function(e,t,s){s.d(t,{Z:function(){return m}});var l=s(6252),o=s(3577),a=s(9963);const i={class:"v-select"},n={class:"options",key:"a1"},c=["onClick"];function d(e,t,s,d,r,p){return(0,l.wg)(),(0,l.iD)("div",i,[(0,l._)("div",{class:(0,o.C_)(["title",{title_checked:d.show_options,disabled:s.disabled}]),onClick:t[0]||(t[0]=e=>d.open_close_options()),onFocusout:t[1]||(t[1]=(...e)=>d.handleFocusOut&&d.handleFocusOut(...e)),tabindex:"0"},[(0,l._)("p",null,(0,o.zw)(s.selected_option.name),1),s.disabled?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",{key:0,class:(0,o.C_)(["arrow",{rotate_arrow:d.show_options}])},null,2))],34),(0,l.Wm)(a.uT,{name:"list"},{default:(0,l.w5)((()=>[d.show_options?((0,l.wg)(),(0,l.iD)("div",n,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(d.options,(e=>((0,l.wg)(),(0,l.iD)("p",{key:e.value,class:(0,o.C_)({optgroup:"optgroup"===e.value}),onClick:t=>d.select_option(e)},[e.optgroup?((0,l.wg)(),(0,l.iD)(l.HY,{key:0},[(0,l.Uk)("     "+(0,o.zw)(e.name),1)],64)):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[(0,l.Uk)((0,o.zw)(e.name),1)],64))],10,c)))),128))])):(0,l.kq)("",!0)])),_:1})])}var r=s(2262),p={props:{options_props:{type:Array,default(){return[]},required:!0},selected_option:{type:Object,required:!0,default(){return{}}},disabled:{type:Boolean,required:!1,default:!1},idx:{type:Number,required:!1}},emits:{select:null},setup(e,{emit:t}){const s=(0,r.iH)([]);(0,l.bv)((()=>{(0,l.Y3)((()=>{o()}))}));const o=()=>{s.value=[],e.options_props?.forEach((e=>s.value.push(e)))};(0,l.YP)((()=>e.options_props),(()=>{o()}),{deep:!0});const a=(0,r.iH)(!1),i=()=>{a.value=!1},n=()=>{e.disabled||(a.value=!a.value)},c=()=>{i()},d=s=>{"optgroup"!=s.value&&(t("select",s,e.idx),i())};return{open_close_options:n,handleFocusOut:c,show_options:a,options:s,select_option:d}}},u=s(3744);const h=(0,u.Z)(p,[["render",d],["__scopeId","data-v-a0cfd498"]]);var m=h},9881:function(e,t,s){s.r(t),s.d(t,{default:function(){return ue}});var l=s(6252),o=s(3577);const a={class:"header"},i={class:"btns"},n=["onClick"],c={class:"content"},d={class:"btns"};function r(e,t,s,r,p,u){const h=(0,l.up)("RepotFIlters"),m=(0,l.up)("ReportGrid"),_=(0,l.up)("grid-bottom");return(0,l.wg)(),(0,l.iD)("div",{class:(0,o.C_)(["app",{blur:p.openSelectedReportModal}])},[(0,l._)("div",a,[(0,l._)("div",i,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.catalog,(t=>((0,l.wg)(),(0,l.iD)("button",{class:(0,o.C_)(["btns_btn",{selected_catalog:e.$route.name===t.value}]),onClick:e=>u.route(t.value),key:t},(0,o.zw)(t.name),11,n)))),128))])]),(0,l._)("div",c,[(0,l._)("div",d,[(0,l._)("button",{onClick:t[0]||(t[0]=e=>u.clients()),class:(0,o.C_)(["btn",{selected_report:p.isClient}])}," Отчет по клиентам ",2),(0,l._)("button",{onClick:t[1]||(t[1]=e=>u.sales()),class:(0,o.C_)(["btn",{selected_report:!p.isClient}])}," Отчет по продажам ",2)]),(0,l.Wm)(h,{isClient:p.isClient,ref:"filters",onGetFilter:u.getFilter},null,8,["isClient","onGetFilter"]),(0,l.Wm)(m,{title:p.title,reportsData:p.reports,isClient:p.isClient,isLoading:p.isLoading,salesTotal:p.salesTotal,onUpdateOpenSelectedReportModal:u.updateOpenSelectedReportModal,onUpdateOpenedRows:u.updateOpenedRows,onUpdateSelectedReport:u.updateSelectedReport},null,8,["title","reportsData","isClient","isLoading","salesTotal","onUpdateOpenSelectedReportModal","onUpdateOpenedRows","onUpdateSelectedReport"]),(0,l.Wm)(_,{previous:null!=p.reports.prev_page_url,next:null!=p.reports.next_page_url,page:p.reports.current_page,show:0!=p.reports.data?.length,count:15,onChangePage:u.changePage,onChangeCount:e.changeCount},null,8,["previous","next","page","show","onChangePage","onChangeCount"])])],2)}s(6699);var p=s(3907),u=s(9963);const h=e=>((0,l.dD)("data-v-8dd25e60"),e=e(),(0,l.Cn)(),e),m={class:"count"},_={class:"row title"},g={key:0},w={key:1},y=["href"],v=["onClick"],f={key:0},b={key:0,class:"space"},k=h((()=>(0,l._)("tr",{class:"space"},null,-1))),C={key:0,class:"row title"};function D(e,t,s,a,i,n){const c=(0,l.up)("ReportGridModal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("p",m,"Найдено: "+(0,o.zw)(s.reportsData.total),1),(0,l._)("table",{class:(0,o.C_)(["table",{blur:n.openSelectedReportModal||s.isLoading}])},[(0,l._)("thead",null,[(0,l._)("tr",_,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.title,(e=>((0,l.wg)(),(0,l.iD)("td",{class:"item",key:e},(0,o.zw)(e.name),1)))),128))])]),(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(i.copyReports,((e,t)=>((0,l.wg)(),(0,l.iD)(l.HY,{key:e},[(0,l._)("tr",{class:(0,o.C_)(["row",{row_odd:t%2==0}])},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.title,(t=>((0,l.wg)(),(0,l.iD)("td",{class:(0,o.C_)(["item",{center:t.type}]),key:t},[t.type||!s.isClient&&"leads"==t.code?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("span",g,(0,o.zw)(e[t.code]),1)),t.type||"leads"!=t.code||s.isClient?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",w,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e[t.code],(e=>((0,l.wg)(),(0,l.iD)("a",{key:e,target:"black",href:"https://"+n.accountSubdomain+".amocrm.ru/leads/detail/"+e},(0,o.zw)(e)+", ",9,y)))),128))])),t.type?(0,l.wy)(((0,l.wg)(),(0,l.iD)("button",{key:2,class:"btn",onClick:s=>e[t.code].value=!e[t.code]?.value},(0,o.zw)(e[t.code]?.value?"Скрыть":"Показать"),9,v)),[[u.F8,e[t.code]]]):(0,l.kq)("",!0)],2)))),128))],2),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e[n.buttonInTitle.code]?.list,(t=>(0,l.wy)(((0,l.wg)(),(0,l.iD)("tr",{class:"hiden",key:t.id},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.title,(e=>((0,l.wg)(),(0,l.iD)("td",{class:"item",key:e},[t[e.code]?((0,l.wg)(),(0,l.iD)("span",f,(0,o.zw)(t[e.code]),1)):(0,l.kq)("",!0)])))),128))])),[[u.F8,e[n.buttonInTitle.code]?.value]]))),128)),e[n.buttonInTitle.code]?.value?((0,l.wg)(),(0,l.iD)("tr",b)):(0,l.kq)("",!0)],64)))),128)),k,s.isClient?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("tr",C,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.title,(e=>((0,l.wg)(),(0,l.iD)("td",{class:"item",key:e},(0,o.zw)(s.salesTotal[e.code]),1)))),128))]))])],2),((0,l.wg)(),(0,l.j4)(l.lR,{to:"body"},[n.selectedReport?.value?((0,l.wg)(),(0,l.j4)(c,{key:0,title:n.selectedReport?.title,list:n.selectedReport?.list,company:n.selectedReport?.company,onClose:n.closeReportGridModal},null,8,["title","list","company","onClose"])):(0,l.kq)("",!0)]))],64)}const R=e=>((0,l.dD)("data-v-5a4d4109"),e=e(),(0,l.Cn)(),e),S={class:"bgc"},T={class:"container"},F={class:"header"},q=R((()=>(0,l._)("div",{class:"icon"},null,-1))),z=[q],L=R((()=>(0,l._)("div",{class:"hr"},null,-1))),$={class:"content"},I={key:0,class:"text"},M={key:1,class:"table"},Y={class:"row title"},H=R((()=>(0,l._)("div",{class:"hr"},null,-1))),O={class:"footer"};function K(e,t,s,a,i,n){const c=(0,l.up)("BtnsSaveClose");return(0,l.wg)(),(0,l.iD)("div",S,[(0,l._)("div",T,[(0,l._)("div",F,[(0,l._)("h5",null,'Позиции компании "'+(0,o.zw)(s.company)+'"',1),(0,l._)("button",{class:"btn_del",onClick:t[0]||(t[0]=e=>n.close())},z)]),L,(0,l._)("div",$,[0==s.list.length?((0,l.wg)(),(0,l.iD)("label",I," Ничего не найдено ")):((0,l.wg)(),(0,l.iD)("table",M,[(0,l._)("thead",null,[(0,l._)("tr",Y,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.title,(e=>((0,l.wg)(),(0,l.iD)("td",{class:"item",key:e},(0,o.zw)(e.name),1)))),128))])]),(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.list,((e,t)=>((0,l.wg)(),(0,l.iD)("tr",{class:(0,o.C_)(["row",{row_odd:t%2==0}]),key:e.id},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.title,(t=>((0,l.wg)(),(0,l.iD)("td",{class:"item",key:t},(0,o.zw)(e[t.code]),1)))),128))],2)))),128))])]))]),H,(0,l._)("div",O,[(0,l.Wm)(c,{show_save:!1,onClose:n.close},null,8,["onClose"])])])])}var U=s(8513),A={components:{BtnsSaveClose:U.Z},props:{title:{type:Array,required:!0},list:{type:Array,required:!0},company:{type:String,required:!0}},methods:{close(){this.$emit("close")}}},E=s(3744);const P=(0,E.Z)(A,[["render",K],["__scopeId","data-v-5a4d4109"]]);var Z=P,x={components:{ReportGridModal:Z},props:{title:{type:Array,required:!0},reportsData:{type:Object,required:!0},salesTotal:{type:Object,required:!1},isClient:{type:Boolean,required:!0},isLoading:{type:Boolean,required:!0}},data(){return{copyReports:[],count:421}},mounted(){this.copy()},computed:{accountSubdomain(){return this.$store.state.account.account.subdomain},buttonInTitle(){return this.title?.filter((e=>1==e?.type))[0]},modalInTitle(){return this.title?.filter((e=>2==e?.type))[0]},openedRows(){return this.copyReports.filter((e=>e[this.buttonInTitle.code]?.value))},selectedReport(){const e=this.copyReports.filter((e=>{if(e[this.modalInTitle?.code])return e[this.modalInTitle?.code].value}))[0];let t={value:!1};return e&&(t={company:e.company,value:e[this.modalInTitle?.code].value,list:e[this.modalInTitle?.code].list,title:e[this.modalInTitle?.code].title}),t},openSelectedReportModal(){return this.selectedReport.value}},watch:{openSelectedReportModal(){this.$emit("updateOpenSelectedReportModal",this.openSelectedReportModal)},reportsData:{handler:function(){this.copy()},deep:!0},openedRows:{handler:function(e,t){let s=!1;e.forEach((e=>{let l=!1;t.forEach((t=>{t.company==e.company&&(l=!0)})),s=s||l})),s||this.$emit("updateOpenedRows",this.openedRows)},deep:!0},selectedReport:{handler:function(e,t){e.company==t.company&&e.value==t.value||this.$emit("updateSelectedReport",this.selectedReport)},deep:!0}},methods:{copy(){this.reportsData.data&&(this.copyReports=JSON.parse(JSON.stringify(this.reportsData.data)))},closeReportGridModal(){this.copyReports.map((e=>e[this.modalInTitle?.code].value=!1))}}};const B=(0,E.Z)(x,[["render",D],["__scopeId","data-v-8dd25e60"]]);var G=B;const W=e=>((0,l.dD)("data-v-960e49a8"),e=e(),(0,l.Cn)(),e),j={class:"row"},V={class:"left"},N={class:"date_range"},J=["onUpdate:modelValue","placeholder","onFocusin","onFocusout","onInput"],Q={class:"btns"},X={class:"row selected_row"},ee=["onClick"],te=W((()=>(0,l._)("div",{class:"icon"},null,-1))),se={key:0,class:"autocomplete_teleport"},le=["onClick"],oe={key:1,class:"autocomplete_teleport"};function ae(e,t,s,a,i,n){return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",j,[(0,l._)("div",V,[(0,l._)("div",N,[(0,l.wy)((0,l._)("input",{type:"date","onUpdate:modelValue":t[0]||(t[0]=e=>i.dateStart=e)},null,512),[[u.nr,i.dateStart]]),(0,l.wy)((0,l._)("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=e=>i.dateEnd=e)},null,512),[[u.nr,i.dateEnd]])]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(i.fields,(t=>(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",{key:t.id,class:"field"},[s.isClient&&t?.clientShow||!s.isClient&&t?.salesShow?((0,l.wg)(),(0,l.iD)("div",{key:0,ref_for:!0,ref:s=>i.selected_field_autocomplete.field==t.name?e.targetAutocomplete=s:null,class:"ref"},[(0,l.wy)((0,l._)("input",{type:"text",class:"input","onUpdate:modelValue":e=>t.value=e,placeholder:t.placeholder,onFocusin:e=>n.set_selected_field_autocomplete(t.name,t.value,t.minLength),onFocusout:e=>n.set_selected_field_autocomplete("","",t.minLength),onInput:e=>n.set_selected_field_autocomplete(t.name,t.value,t.minLength)},null,40,J),[[u.nr,t.value]])],512)):(0,l.kq)("",!0)])),[[u.F8,s.isClient&&t.clientShow||!s.isClient&&t.salesShow]]))),128))]),(0,l._)("div",Q,[(0,l._)("button",{class:"btn",onClick:t[2]||(t[2]=e=>n.apply())},"Применить"),(0,l._)("button",{class:"btn",onClick:t[3]||(t[3]=e=>n.clearAllFields())},"Очистить")])]),(0,l._)("div",X,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(i.fields,((e,t)=>(0,l.wy)(((0,l.wg)(),(0,l.iD)("div",{class:"selected",key:e.id},[(0,l._)("span",null,(0,o.zw)(e.placeholder)+": ",1),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.selected,((e,s)=>((0,l.wg)(),(0,l.iD)("div",{key:e,class:"item",onClick:e=>n.deleteField(t,s)},[(0,l.Uk)((0,o.zw)(e.value)+" ",1),te],8,ee)))),128))])),[[u.F8,e.selected.length]]))),128))]),i.selected_field_autocomplete_list.length||i.isLoading?((0,l.wg)(),(0,l.j4)(l.lR,{key:0,to:e.targetAutocomplete},[i.isLoading?((0,l.wg)(),(0,l.iD)("ul",oe,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(i.autocompletePlaceholderList,(e=>((0,l.wg)(),(0,l.iD)("li",{key:e,class:"placeholder"},(0,o.zw)(e),1)))),128))])):((0,l.wg)(),(0,l.iD)("ul",se,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(i.selected_field_autocomplete_list,(e=>((0,l.wg)(),(0,l.iD)("li",{key:e,onClick:t=>n.selectField(e,i.selected_field_autocomplete.field),class:"item"},(0,o.zw)(e.value),9,le)))),128))]))],8,["to"])):(0,l.kq)("",!0)],64)}s(7686),s(4506);var ie={props:{isClient:{type:Boolean,required:!0}},data(){return{isLoading:!1,selected_field_autocomplete:{idx:null,field:"",value:"",minLength:0},selected_field_autocomplete_list:[],autocompletePlaceholderList:["...","...","...","..."],dateStart:"",dateEnd:"",fields:[{id:0,name:"product",value:"",minLength:3,placeholder:"Артикулы/Названия",clientShow:!1,salesShow:!0,selected:[]},{id:4,name:"responsible",value:"",minLength:0,placeholder:"Ответственные",clientShow:!0,salesShow:!0,selected:[]},{id:1,name:"pipeline",value:"",minLength:0,placeholder:"Воронки",clientShow:!0,salesShow:!1,selected:[]},{id:2,name:"company",value:"",minLength:3,placeholder:"Компании",clientShow:!0,salesShow:!1,selected:[]},{id:3,name:"contact",value:"",minLength:3,placeholder:"Контакты",clientShow:!0,salesShow:!1,selected:[]}]}},watch:{selected_field_autocomplete:{async handler(){clearTimeout(this.timer);const e=()=>{const e=this.selected_field_autocomplete;return""!==e.field&&e.value.length>=e.minLength&&" "!=e.value.split("").at(-1)&&" "!=e.value.split("")[0]};(0,l.Y3)((()=>{e()&&(this.isLoading=!0)})),this.timer=setTimeout((async()=>{if(this.selected_field_autocomplete_list=[],e()){const e=this.selected_field_autocomplete;await this.$store.dispatch("getAutocompleteAnalytics",{field:e.field,value:{query:e.value}});const t=this.$store.state.analytics.autocomplete;void 0!=t&&(this.selected_field_autocomplete_list=[...t])}this.isLoading=!1}),500)},deep:!0}},methods:{set_selected_field_autocomplete(e,t,s){setTimeout((()=>{this.selected_field_autocomplete={field:e,value:t,minLength:s}}),200)},selectField(e,t){this.fields.forEach((s=>{s.name!==t||s.selected.filter((t=>t.value==e.value)).length||s.selected.push(e)}))},deleteField(e,t){this.fields[e].selected.splice(t,1)},clearAllFields(){this.fields.map((e=>e.selected=[]))},apply(){const e=e=>{const t=e.split("-"),s=t[0];return t.splice(0,1),t.push(s),t.join("/")},t={date:e(this.dateStart)+"-"+e(this.dateEnd)};this.fields.forEach((e=>{const s=[];e.selected.forEach((e=>s.push(e.value))),(this.isClient&&e.clientShow||!this.isClient&&e.salesShow)&&(t[e.name]=s)})),this.$emit("getFilter",t)}}};const ne=(0,E.Z)(ie,[["render",ae],["__scopeId","data-v-960e49a8"]]);var ce=ne,de=s(3026),re={name:"AnalyticsView",components:{ReportGrid:G,RepotFIlters:ce,GridBottom:de.Z},data(){return{openSelectedReportModal:!1,isLoading:!1,title:[],reports:[],isClient:!0,openedRows:[],selectedReport:{},filter:{},salesTotal:{},page:1}},computed:{...(0,p.Se)(["catalog"]),refFilters(){return this.$refs.filters}},mounted(){this.clients(),this.$store.dispatch("get_account")},methods:{route(e){this.$router.push("/"+e)},updateOpenSelectedReportModal(e){this.openSelectedReportModal=e},async updateOpenedRows(e){e.length||this.reports.data.map((e=>e.otv?e.otv.value=!1:null)),await(e?.forEach((async e=>{!this.openedRows.includes(e)&&e.company&&(this.openedRows.push(e),await this.$store.dispatch("getCustomersResponsible",{filter:{},company:e.company}),this.reports.data.map((t=>{t.company==e.company&&t.otv&&(t.otv.value=e.otv.value,t.otv.list=this.$store.state.analytics.customersResponsible,t.otv.list.map((e=>{e["prib"]=e.sum-e.cost_sum,e.otv=e.user})))})))}))),this.openedRows=[...e]},async updateSelectedReport(e){e.value||this.reports.data.map((e=>e.poz.value=!1)),e.company&&(this.reports.data.filter((t=>t.company==e.company))[0]?.poz.list.length||await this.$store.dispatch("getCustomersProducts",{filter:{},company:e.company}),this.reports.data.map((t=>{t.company==e.company&&t.poz&&(t.poz.value=e.value,t.poz.list=this.$store.state.analytics.customersProducts,t.poz.list.map((e=>e["prib"]=e.sum-e.cost_sum)))}))),this.selectedReport={...e}},async getReports(){this.isClient?(await this.$store.dispatch("getCustomers",{filter:this.filter,page:this.page}),this.reports=this.$store.state.analytics.customers,this.reports.data.map((e=>{e["otv"]={value:!1,list:[]},e["poz"]={value:!1,list:[],title:[{name:"Название",code:"name"},{name:"Кол-во",code:"count"},{name:"Оборот",code:"sum"},{name:"Прибыль",code:"prib"}]},e["prib"]=e.sum-e.cost_sum,e.sum=Math.round(100*e.sum)/100+" р.",e.cost_sum=Math.round(100*e.cost_sum)/100+" р.",e.prib=Math.round(100*e.prib)/100+" р."}))):(await this.$store.dispatch("getSales",{params:this.filter,page:this.page}),await this.$store.dispatch("getSalesTotal",{params:this.filter,page:this.page}),this.reports=this.$store.state.analytics.sales,this.salesTotal=this.$store.state.analytics.salesTotal,this.salesTotal["prib"]=this.salesTotal.sum-this.salesTotal.cost_sum,this.salesTotal.sum=Math.round(100*this.salesTotal.sum)/100+" р.",this.salesTotal.cost_sum=Math.round(100*this.salesTotal.cost_sum)/100+" р.",this.salesTotal.prib=Math.round(100*this.salesTotal.prib)/100+" р.",this.salesTotal.leads=this.salesTotal.leads.split(",").length,this.salesTotal["name"]="Общее",this.salesTotal["poz"]="",this.reports.data.map((e=>{e["poz"]={value:!1,list:[]},e["prib"]=e.sum-e.cost_sum,e.leads=e.leads.split(","),e.sum=Math.round(100*e.sum)/100+" р.",e.cost_sum=Math.round(100*e.cost_sum)/100+" р.",e.prib=Math.round(100*e.prib)/100+" р."})))},async clients(){this.isLoading=!0,this.isClient||(this.refFilters?.clearAllFields(),1!=this.page&&this.changePage(1)),this.isClient=!0,this.title=[{name:"Компания",code:"company",type:0},{name:"Контакт",code:"contact",type:0},{name:"Сделки",code:"leads",type:0},{name:"Оборот",code:"sum",type:0},{name:"Прибыль",code:"prib",type:0},{name:"Ответственные",code:"otv",type:1},{name:"Позиции",code:"poz",type:2}],await this.getReports(),this.isLoading=!1},async sales(){this.isLoading=!0,this.isClient&&(this.refFilters?.clearAllFields(),1!=this.page&&this.changePage(1)),this.isClient=!1,this.title=[{name:"Название",code:"name",type:0},{name:"Кол-во",code:"count",type:0},{name:"Оборот",code:"sum",type:0},{name:"Себестоимость",code:"cost_sum",type:0},{name:"Прибыль",code:"prib",type:0},{name:"Сделки",code:"leads",type:0},{name:"Позиции",code:"poz",type:1}],await this.getReports(),this.isLoading=!1},changePage(e){this.page=e,this.isClient?this.clients():this.sales()},getFilter(e){this.filter=e,this.isClient?this.clients():this.sales()}}};const pe=(0,E.Z)(re,[["render",r],["__scopeId","data-v-418f1cb1"]]);var ue=pe}}]);
//# sourceMappingURL=641.0efc2cf0.js.map